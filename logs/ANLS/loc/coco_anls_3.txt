DEVICE: cpu
coco an_ls, location 3 , linear_fixed_features
coco an_ls, location 3 , linear_fixed_features
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 82081 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.28 min, loss: 0.425, map_clean: 3.67, map_observed: 1.27
[val] time: 0.27 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
*** new best weights ***
[test] time: 0.65 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 1/24
[train] time: 1.30 min, loss: 0.448, map_clean: 3.66, map_observed: 1.33
[val] time: 0.27 min, loss: -999.000, map_clean: 4.48, map_observed: 4.48
*** new best weights ***
[test] time: 0.65 min, loss: -999.000, map_clean: 4.47, map_observed: 4.47
Epoch 2/24
[train] time: 1.32 min, loss: 0.460, map_clean: 3.67, map_observed: 1.37
[val] time: 0.27 min, loss: -999.000, map_clean: 4.19, map_observed: 4.19
[test] time: 0.67 min, loss: -999.000, map_clean: 4.17, map_observed: 4.17
Epoch 3/24
[train] time: 1.31 min, loss: 0.502, map_clean: 3.65, map_observed: 1.38
[val] time: 0.27 min, loss: -999.000, map_clean: 5.00, map_observed: 5.00
*** new best weights ***
[test] time: 0.65 min, loss: -999.000, map_clean: 4.86, map_observed: 4.86
Epoch 4/24
[train] time: 1.31 min, loss: 0.529, map_clean: 3.64, map_observed: 1.39
[val] time: 0.28 min, loss: -999.000, map_clean: 4.07, map_observed: 4.07
[test] time: 0.66 min, loss: -999.000, map_clean: 4.01, map_observed: 4.01
Epoch 5/24
[train] time: 1.31 min, loss: 0.553, map_clean: 3.64, map_observed: 1.39
[val] time: 0.27 min, loss: -999.000, map_clean: 4.11, map_observed: 4.11
[test] time: 0.66 min, loss: -999.000, map_clean: 4.07, map_observed: 4.07
Epoch 6/24
[train] time: 1.31 min, loss: 0.582, map_clean: 3.66, map_observed: 1.38
[val] time: 0.27 min, loss: -999.000, map_clean: 4.12, map_observed: 4.12
[test] time: 0.65 min, loss: -999.000, map_clean: 4.07, map_observed: 4.07
Epoch 7/24
[train] time: 1.33 min, loss: 0.586, map_clean: 3.66, map_observed: 1.39
[val] time: 0.27 min, loss: -999.000, map_clean: 4.07, map_observed: 4.07
[test] time: 0.66 min, loss: -999.000, map_clean: 3.98, map_observed: 3.98
Epoch 8/24
[train] time: 1.31 min, loss: 0.603, map_clean: 3.67, map_observed: 1.41
[val] time: 0.27 min, loss: -999.000, map_clean: 4.08, map_observed: 4.08
[test] time: 0.66 min, loss: -999.000, map_clean: 4.06, map_observed: 4.06
Epoch 9/24
[train] time: 1.31 min, loss: 0.603, map_clean: 3.68, map_observed: 1.39
[val] time: 0.27 min, loss: -999.000, map_clean: 4.40, map_observed: 4.40
[test] time: 0.65 min, loss: -999.000, map_clean: 4.41, map_observed: 4.41
Epoch 10/24
[train] time: 1.35 min, loss: 0.603, map_clean: 3.66, map_observed: 1.41
[val] time: 0.27 min, loss: -999.000, map_clean: 3.68, map_observed: 3.68
[test] time: 0.66 min, loss: -999.000, map_clean: 3.67, map_observed: 3.67
Epoch 11/24
[train] time: 1.36 min, loss: 0.609, map_clean: 3.65, map_observed: 1.41
[val] time: 0.27 min, loss: -999.000, map_clean: 3.84, map_observed: 3.84
[test] time: 0.65 min, loss: -999.000, map_clean: 3.77, map_observed: 3.77
Epoch 12/24
[train] time: 1.37 min, loss: 0.624, map_clean: 3.66, map_observed: 1.40
[val] time: 0.28 min, loss: -999.000, map_clean: 3.98, map_observed: 3.98
[test] time: 0.65 min, loss: -999.000, map_clean: 3.90, map_observed: 3.90
Epoch 13/24
[train] time: 1.41 min, loss: 0.644, map_clean: 3.66, map_observed: 1.40
[val] time: 0.27 min, loss: -999.000, map_clean: 3.83, map_observed: 3.83
[test] time: 0.64 min, loss: -999.000, map_clean: 3.78, map_observed: 3.78
Epoch 14/24
[train] time: 1.44 min, loss: 0.644, map_clean: 3.66, map_observed: 1.40
[val] time: 0.27 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80
[test] time: 0.66 min, loss: -999.000, map_clean: 3.79, map_observed: 3.79
Epoch 15/24
[train] time: 1.42 min, loss: 0.652, map_clean: 3.65, map_observed: 1.39
[val] time: 0.27 min, loss: -999.000, map_clean: 3.82, map_observed: 3.82
[test] time: 0.64 min, loss: -999.000, map_clean: 3.83, map_observed: 3.83
Epoch 16/24
[train] time: 1.43 min, loss: 0.666, map_clean: 3.65, map_observed: 1.40
[val] time: 0.28 min, loss: -999.000, map_clean: 4.12, map_observed: 4.12
[test] time: 0.72 min, loss: -999.000, map_clean: 4.04, map_observed: 4.04
Epoch 17/24
[train] time: 1.50 min, loss: 0.670, map_clean: 3.65, map_observed: 1.40
[val] time: 0.28 min, loss: -999.000, map_clean: 4.26, map_observed: 4.26
[test] time: 0.70 min, loss: -999.000, map_clean: 4.26, map_observed: 4.26
Epoch 18/24
[train] time: 1.49 min, loss: 0.712, map_clean: 3.62, map_observed: 1.39
[val] time: 0.26 min, loss: -999.000, map_clean: 3.88, map_observed: 3.88
[test] time: 0.70 min, loss: -999.000, map_clean: 3.88, map_observed: 3.88
Epoch 19/24
[train] time: 1.52 min, loss: 0.718, map_clean: 3.63, map_observed: 1.39
[val] time: 0.29 min, loss: -999.000, map_clean: 3.87, map_observed: 3.87
[test] time: 0.69 min, loss: -999.000, map_clean: 3.84, map_observed: 3.84
Epoch 20/24
[train] time: 1.53 min, loss: 0.719, map_clean: 3.65, map_observed: 1.40
[val] time: 0.29 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80
[test] time: 0.71 min, loss: -999.000, map_clean: 3.74, map_observed: 3.74
Epoch 21/24
[train] time: 1.55 min, loss: 0.726, map_clean: 3.65, map_observed: 1.39
[val] time: 0.29 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
[test] time: 0.70 min, loss: -999.000, map_clean: 3.62, map_observed: 3.62
Epoch 22/24
[train] time: 1.57 min, loss: 0.728, map_clean: 3.65, map_observed: 1.38
[val] time: 0.29 min, loss: -999.000, map_clean: 4.00, map_observed: 4.00
[test] time: 0.71 min, loss: -999.000, map_clean: 3.92, map_observed: 3.92
Epoch 23/24
[train] time: 1.53 min, loss: 0.740, map_clean: 3.66, map_observed: 1.38
[val] time: 0.26 min, loss: -999.000, map_clean: 3.85, map_observed: 3.85
[test] time: 0.66 min, loss: -999.000, map_clean: 3.84, map_observed: 3.84
Epoch 24/24
[train] time: 1.47 min, loss: 0.759, map_clean: 3.69, map_observed: 1.38
[val] time: 0.27 min, loss: -999.000, map_clean: 3.86, map_observed: 3.86
[test] time: 0.66 min, loss: -999.000, map_clean: 3.81, map_observed: 3.81

*** TRAINING COMPLETE ***
Best epoch: 3
Best epoch validation score: 5.00
Best epoch test score:       4.86

Saving best weights for f to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_01-40-23_coco/best_model_state_f.pt

Saving best weights for g to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_01-40-23_coco/best_model_state_g.pt

Saving session data to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_01-40-23_coco/logs.json

Saving session data to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_01-40-23_coco/params.json

Reverting model to best weights.
DEVICE: cpu
coco an_ls, location 3 , linear_fixed_features
coco an_ls, location 3 , linear_fixed_features
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 82081 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.32 min, loss: 0.350, map_clean: 3.66, map_observed: 1.26
[val] time: 0.27 min, loss: -999.000, map_clean: 4.08, map_observed: 4.08
*** new best weights ***
[test] time: 0.66 min, loss: -999.000, map_clean: 3.97, map_observed: 3.97
Epoch 1/24
[train] time: 1.31 min, loss: 0.349, map_clean: 3.68, map_observed: 1.38
[val] time: 0.27 min, loss: -999.000, map_clean: 4.61, map_observed: 4.61
*** new best weights ***
[test] time: 0.65 min, loss: -999.000, map_clean: 4.55, map_observed: 4.55
Epoch 2/24
[train] time: 1.30 min, loss: 0.349, map_clean: 3.69, map_observed: 1.46
[val] time: 0.27 min, loss: -999.000, map_clean: 3.83, map_observed: 3.83
[test] time: 0.67 min, loss: -999.000, map_clean: 3.79, map_observed: 3.79
Epoch 3/24
[train] time: 1.31 min, loss: 0.349, map_clean: 3.68, map_observed: 1.52
[val] time: 0.27 min, loss: -999.000, map_clean: 4.81, map_observed: 4.81
*** new best weights ***
[test] time: 0.65 min, loss: -999.000, map_clean: 4.66, map_observed: 4.66
Epoch 4/24
[train] time: 1.32 min, loss: 0.349, map_clean: 3.69, map_observed: 1.59
[val] time: 0.28 min, loss: -999.000, map_clean: 4.13, map_observed: 4.13
[test] time: 0.66 min, loss: -999.000, map_clean: 4.07, map_observed: 4.07
Epoch 5/24
[train] time: 1.31 min, loss: 0.349, map_clean: 3.69, map_observed: 1.66
[val] time: 0.27 min, loss: -999.000, map_clean: 4.16, map_observed: 4.16
[test] time: 0.67 min, loss: -999.000, map_clean: 4.15, map_observed: 4.15
Epoch 6/24
[train] time: 1.34 min, loss: 0.349, map_clean: 3.69, map_observed: 1.70
[val] time: 0.27 min, loss: -999.000, map_clean: 4.44, map_observed: 4.44
[test] time: 0.67 min, loss: -999.000, map_clean: 4.37, map_observed: 4.37
Epoch 7/24
[train] time: 1.32 min, loss: 0.349, map_clean: 3.67, map_observed: 1.72
[val] time: 0.28 min, loss: -999.000, map_clean: 4.19, map_observed: 4.19
[test] time: 0.66 min, loss: -999.000, map_clean: 4.08, map_observed: 4.08
Epoch 8/24
[train] time: 1.31 min, loss: 0.349, map_clean: 3.70, map_observed: 1.78
[val] time: 0.27 min, loss: -999.000, map_clean: 3.76, map_observed: 3.76
[test] time: 0.66 min, loss: -999.000, map_clean: 3.77, map_observed: 3.77
Epoch 9/24
[train] time: 1.31 min, loss: 0.349, map_clean: 3.70, map_observed: 1.82
[val] time: 0.28 min, loss: -999.000, map_clean: 3.94, map_observed: 3.94
[test] time: 0.67 min, loss: -999.000, map_clean: 3.92, map_observed: 3.92
Epoch 10/24
[train] time: 1.31 min, loss: 0.349, map_clean: 3.68, map_observed: 1.87
[val] time: 0.27 min, loss: -999.000, map_clean: 3.99, map_observed: 3.99
[test] time: 0.66 min, loss: -999.000, map_clean: 3.93, map_observed: 3.93
Epoch 11/24
[train] time: 1.32 min, loss: 0.349, map_clean: 3.69, map_observed: 1.89
[val] time: 0.28 min, loss: -999.000, map_clean: 3.88, map_observed: 3.88
[test] time: 0.66 min, loss: -999.000, map_clean: 3.86, map_observed: 3.86
Epoch 12/24
[train] time: 1.32 min, loss: 0.349, map_clean: 3.68, map_observed: 1.91
[val] time: 0.28 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
[test] time: 0.67 min, loss: -999.000, map_clean: 3.58, map_observed: 3.58
Epoch 13/24
[train] time: 1.32 min, loss: 0.349, map_clean: 3.69, map_observed: 1.96
[val] time: 0.27 min, loss: -999.000, map_clean: 4.52, map_observed: 4.52
[test] time: 0.67 min, loss: -999.000, map_clean: 4.45, map_observed: 4.45
Epoch 14/24
[train] time: 1.32 min, loss: 0.349, map_clean: 3.69, map_observed: 1.95
[val] time: 0.27 min, loss: -999.000, map_clean: 4.79, map_observed: 4.79
[test] time: 0.67 min, loss: -999.000, map_clean: 4.66, map_observed: 4.66
Epoch 15/24
[train] time: 1.31 min, loss: 0.349, map_clean: 3.68, map_observed: 1.98
[val] time: 0.28 min, loss: -999.000, map_clean: 3.74, map_observed: 3.74
[test] time: 0.63 min, loss: -999.000, map_clean: 3.70, map_observed: 3.70
Epoch 16/24
[train] time: 1.35 min, loss: 0.349, map_clean: 3.69, map_observed: 2.03
[val] time: 0.29 min, loss: -999.000, map_clean: 4.19, map_observed: 4.19
[test] time: 0.69 min, loss: -999.000, map_clean: 4.14, map_observed: 4.14
Epoch 17/24
[train] time: 1.39 min, loss: 0.349, map_clean: 3.69, map_observed: 2.02
[val] time: 0.30 min, loss: -999.000, map_clean: 3.86, map_observed: 3.86
[test] time: 0.69 min, loss: -999.000, map_clean: 3.79, map_observed: 3.79
Epoch 18/24
[train] time: 1.38 min, loss: 0.349, map_clean: 3.68, map_observed: 2.07
[val] time: 0.28 min, loss: -999.000, map_clean: 4.18, map_observed: 4.18
[test] time: 0.67 min, loss: -999.000, map_clean: 4.15, map_observed: 4.15
Epoch 19/24
[train] time: 1.41 min, loss: 0.349, map_clean: 3.69, map_observed: 2.04
[val] time: 0.29 min, loss: -999.000, map_clean: 3.64, map_observed: 3.64
[test] time: 0.71 min, loss: -999.000, map_clean: 3.62, map_observed: 3.62
Epoch 20/24
[train] time: 1.41 min, loss: 0.349, map_clean: 3.68, map_observed: 2.08
[val] time: 0.29 min, loss: -999.000, map_clean: 3.91, map_observed: 3.91
[test] time: 0.72 min, loss: -999.000, map_clean: 3.87, map_observed: 3.87
Epoch 21/24
[train] time: 1.43 min, loss: 0.349, map_clean: 3.68, map_observed: 2.11
[val] time: 0.30 min, loss: -999.000, map_clean: 3.96, map_observed: 3.96
[test] time: 0.71 min, loss: -999.000, map_clean: 3.91, map_observed: 3.91
Epoch 22/24
[train] time: 1.43 min, loss: 0.349, map_clean: 3.69, map_observed: 2.13
[val] time: 0.29 min, loss: -999.000, map_clean: 3.72, map_observed: 3.72
[test] time: 0.72 min, loss: -999.000, map_clean: 3.70, map_observed: 3.70
Epoch 23/24
[train] time: 1.45 min, loss: 0.349, map_clean: 3.69, map_observed: 2.13
[val] time: 0.30 min, loss: -999.000, map_clean: 4.07, map_observed: 4.07
[test] time: 0.63 min, loss: -999.000, map_clean: 4.03, map_observed: 4.03
Epoch 24/24
[train] time: 1.34 min, loss: 0.349, map_clean: 3.69, map_observed: 2.12
[val] time: 0.27 min, loss: -999.000, map_clean: 4.10, map_observed: 4.10
[test] time: 0.67 min, loss: -999.000, map_clean: 4.05, map_observed: 4.05

*** TRAINING COMPLETE ***
Best epoch: 3
Best epoch validation score: 4.81
Best epoch test score:       4.66

Saving best weights for f to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_02-42-23_coco/best_model_state_f.pt

Saving best weights for g to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_02-42-23_coco/best_model_state_g.pt

Saving session data to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_02-42-23_coco/logs.json

Saving session data to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_02-42-23_coco/params.json

Reverting model to best weights.
DEVICE: cpu
coco an_ls, location 3 , linear_fixed_features
coco an_ls, location 3 , linear_fixed_features
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 82081 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.33 min, loss: 0.346, map_clean: 3.58, map_observed: 1.26
[val] time: 0.28 min, loss: -999.000, map_clean: 3.70, map_observed: 3.70
*** new best weights ***
[test] time: 0.66 min, loss: -999.000, map_clean: 3.64, map_observed: 3.64
Epoch 1/24
[train] time: 1.32 min, loss: 0.345, map_clean: 3.62, map_observed: 1.37
[val] time: 0.28 min, loss: -999.000, map_clean: 3.93, map_observed: 3.93
*** new best weights ***
[test] time: 0.66 min, loss: -999.000, map_clean: 3.91, map_observed: 3.91
Epoch 2/24
[train] time: 1.32 min, loss: 0.345, map_clean: 3.63, map_observed: 1.46
[val] time: 0.27 min, loss: -999.000, map_clean: 4.01, map_observed: 4.01
*** new best weights ***
[test] time: 0.66 min, loss: -999.000, map_clean: 3.92, map_observed: 3.92
Epoch 3/24
[train] time: 1.34 min, loss: 0.345, map_clean: 3.66, map_observed: 1.52
[val] time: 0.28 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80
[test] time: 0.67 min, loss: -999.000, map_clean: 3.76, map_observed: 3.76
Epoch 4/24
[train] time: 1.32 min, loss: 0.345, map_clean: 3.65, map_observed: 1.60
[val] time: 0.28 min, loss: -999.000, map_clean: 3.70, map_observed: 3.70
[test] time: 0.66 min, loss: -999.000, map_clean: 3.71, map_observed: 3.71
Epoch 5/24
[train] time: 1.33 min, loss: 0.345, map_clean: 3.64, map_observed: 1.67
[val] time: 0.27 min, loss: -999.000, map_clean: 3.90, map_observed: 3.90
[test] time: 0.66 min, loss: -999.000, map_clean: 3.85, map_observed: 3.85
Epoch 6/24
[train] time: 1.33 min, loss: 0.345, map_clean: 3.67, map_observed: 1.73
[val] time: 0.27 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80
[test] time: 0.67 min, loss: -999.000, map_clean: 3.75, map_observed: 3.75
Epoch 7/24
[train] time: 1.33 min, loss: 0.345, map_clean: 3.65, map_observed: 1.78
[val] time: 0.27 min, loss: -999.000, map_clean: 3.81, map_observed: 3.81
[test] time: 0.67 min, loss: -999.000, map_clean: 3.77, map_observed: 3.77
Epoch 8/24
[train] time: 1.33 min, loss: 0.345, map_clean: 3.66, map_observed: 1.87
[val] time: 0.27 min, loss: -999.000, map_clean: 3.78, map_observed: 3.78
[test] time: 0.66 min, loss: -999.000, map_clean: 3.73, map_observed: 3.73
Epoch 9/24
[train] time: 1.32 min, loss: 0.345, map_clean: 3.67, map_observed: 1.93
[val] time: 0.29 min, loss: -999.000, map_clean: 3.75, map_observed: 3.75
[test] time: 0.66 min, loss: -999.000, map_clean: 3.67, map_observed: 3.67
Epoch 10/24
[train] time: 1.33 min, loss: 0.345, map_clean: 3.65, map_observed: 1.98
[val] time: 0.27 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
[test] time: 0.67 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
Epoch 11/24
[train] time: 1.34 min, loss: 0.345, map_clean: 3.66, map_observed: 2.03
[val] time: 0.27 min, loss: -999.000, map_clean: 3.86, map_observed: 3.86
[test] time: 0.67 min, loss: -999.000, map_clean: 3.86, map_observed: 3.86
Epoch 12/24
[train] time: 1.34 min, loss: 0.345, map_clean: 3.65, map_observed: 2.10
[val] time: 0.28 min, loss: -999.000, map_clean: 3.69, map_observed: 3.69
[test] time: 0.67 min, loss: -999.000, map_clean: 3.64, map_observed: 3.64
Epoch 13/24
[train] time: 1.34 min, loss: 0.345, map_clean: 3.65, map_observed: 2.13
[val] time: 0.27 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80
[test] time: 0.67 min, loss: -999.000, map_clean: 3.76, map_observed: 3.76
Epoch 14/24
[train] time: 1.33 min, loss: 0.345, map_clean: 3.66, map_observed: 2.23
[val] time: 0.28 min, loss: -999.000, map_clean: 3.92, map_observed: 3.92
[test] time: 0.67 min, loss: -999.000, map_clean: 3.86, map_observed: 3.86
Epoch 15/24
[train] time: 1.33 min, loss: 0.345, map_clean: 3.65, map_observed: 2.28
[val] time: 0.28 min, loss: -999.000, map_clean: 3.83, map_observed: 3.83
[test] time: 0.67 min, loss: -999.000, map_clean: 3.77, map_observed: 3.77
Epoch 16/24
[train] time: 1.28 min, loss: 0.345, map_clean: 3.67, map_observed: 2.37
[val] time: 0.29 min, loss: -999.000, map_clean: 3.85, map_observed: 3.85
[test] time: 0.70 min, loss: -999.000, map_clean: 3.79, map_observed: 3.79
Epoch 17/24
[train] time: 1.40 min, loss: 0.345, map_clean: 3.67, map_observed: 2.41
[val] time: 0.29 min, loss: -999.000, map_clean: 3.68, map_observed: 3.68
[test] time: 0.70 min, loss: -999.000, map_clean: 3.65, map_observed: 3.65
Epoch 18/24
[train] time: 1.39 min, loss: 0.345, map_clean: 3.66, map_observed: 2.44
[val] time: 0.29 min, loss: -999.000, map_clean: 3.60, map_observed: 3.60
[test] time: 0.69 min, loss: -999.000, map_clean: 3.57, map_observed: 3.57
Epoch 19/24
[train] time: 1.39 min, loss: 0.345, map_clean: 3.66, map_observed: 2.57
[val] time: 0.29 min, loss: -999.000, map_clean: 3.95, map_observed: 3.95
[test] time: 0.72 min, loss: -999.000, map_clean: 3.91, map_observed: 3.91
Epoch 20/24
[train] time: 1.38 min, loss: 0.345, map_clean: 3.67, map_observed: 2.58
[val] time: 0.29 min, loss: -999.000, map_clean: 3.76, map_observed: 3.76
[test] time: 0.71 min, loss: -999.000, map_clean: 3.69, map_observed: 3.69
Epoch 21/24
[train] time: 1.43 min, loss: 0.345, map_clean: 3.67, map_observed: 2.66
[val] time: 0.30 min, loss: -999.000, map_clean: 3.62, map_observed: 3.62
[test] time: 0.71 min, loss: -999.000, map_clean: 3.58, map_observed: 3.58
Epoch 22/24
[train] time: 1.43 min, loss: 0.345, map_clean: 3.65, map_observed: 2.69
[val] time: 0.30 min, loss: -999.000, map_clean: 3.76, map_observed: 3.76
[test] time: 0.72 min, loss: -999.000, map_clean: 3.70, map_observed: 3.70
Epoch 23/24
[train] time: 1.44 min, loss: 0.345, map_clean: 3.66, map_observed: 2.77
[val] time: 0.29 min, loss: -999.000, map_clean: 3.72, map_observed: 3.72
[test] time: 0.73 min, loss: -999.000, map_clean: 3.68, map_observed: 3.68
Epoch 24/24
[train] time: 1.31 min, loss: 0.345, map_clean: 3.66, map_observed: 2.83
[val] time: 0.28 min, loss: -999.000, map_clean: 3.70, map_observed: 3.70
[test] time: 0.67 min, loss: -999.000, map_clean: 3.68, map_observed: 3.68

*** TRAINING COMPLETE ***
Best epoch: 2
Best epoch validation score: 4.01
Best epoch test score:       3.92

Saving best weights for f to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_03-43-10_coco/best_model_state_f.pt

Saving best weights for g to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_03-43-10_coco/best_model_state_g.pt

Saving session data to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_03-43-10_coco/logs.json

Saving session data to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_03-43-10_coco/params.json

Reverting model to best weights.
DEVICE: cpu
coco an_ls, location 3 , linear_fixed_features
coco an_ls, location 3 , linear_fixed_features
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 82081 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.31 min, loss: 0.353, map_clean: 3.52, map_observed: 1.27
[val] time: 0.28 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
*** new best weights ***
[test] time: 0.66 min, loss: -999.000, map_clean: 3.48, map_observed: 3.48
Epoch 1/24
[train] time: 1.31 min, loss: 0.346, map_clean: 3.50, map_observed: 1.29
[val] time: 0.27 min, loss: -999.000, map_clean: 3.48, map_observed: 3.48
[test] time: 0.66 min, loss: -999.000, map_clean: 3.43, map_observed: 3.43
Epoch 2/24
[train] time: 1.32 min, loss: 0.345, map_clean: 3.47, map_observed: 1.31
[val] time: 0.28 min, loss: -999.000, map_clean: 3.47, map_observed: 3.47
[test] time: 0.67 min, loss: -999.000, map_clean: 3.44, map_observed: 3.44
Epoch 3/24
[train] time: 1.32 min, loss: 0.345, map_clean: 3.48, map_observed: 1.34
[val] time: 0.28 min, loss: -999.000, map_clean: 3.45, map_observed: 3.45
[test] time: 0.67 min, loss: -999.000, map_clean: 3.41, map_observed: 3.41
Epoch 4/24
[train] time: 1.33 min, loss: 0.345, map_clean: 3.46, map_observed: 1.38
[val] time: 0.27 min, loss: -999.000, map_clean: 3.48, map_observed: 3.48
[test] time: 0.66 min, loss: -999.000, map_clean: 3.44, map_observed: 3.44
Epoch 5/24
[train] time: 1.34 min, loss: 0.345, map_clean: 3.48, map_observed: 1.41
[val] time: 0.28 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
[test] time: 0.67 min, loss: -999.000, map_clean: 3.47, map_observed: 3.47
Epoch 6/24
[train] time: 1.32 min, loss: 0.345, map_clean: 3.51, map_observed: 1.44
[val] time: 0.27 min, loss: -999.000, map_clean: 3.45, map_observed: 3.45
[test] time: 0.67 min, loss: -999.000, map_clean: 3.41, map_observed: 3.41
Epoch 7/24
[train] time: 1.33 min, loss: 0.345, map_clean: 3.48, map_observed: 1.47
[val] time: 0.28 min, loss: -999.000, map_clean: 3.48, map_observed: 3.48
[test] time: 0.66 min, loss: -999.000, map_clean: 3.44, map_observed: 3.44
Epoch 8/24
[train] time: 1.32 min, loss: 0.345, map_clean: 3.49, map_observed: 1.49
[val] time: 0.28 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
[test] time: 0.66 min, loss: -999.000, map_clean: 3.46, map_observed: 3.46
Epoch 9/24
[train] time: 1.32 min, loss: 0.345, map_clean: 3.50, map_observed: 1.52
[val] time: 0.27 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
[test] time: 0.68 min, loss: -999.000, map_clean: 3.48, map_observed: 3.48
Epoch 10/24
[train] time: 1.33 min, loss: 0.345, map_clean: 3.53, map_observed: 1.54
[val] time: 0.28 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
[test] time: 0.66 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 11/24
[train] time: 1.33 min, loss: 0.345, map_clean: 3.53, map_observed: 1.56
[val] time: 0.27 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
[test] time: 0.66 min, loss: -999.000, map_clean: 3.46, map_observed: 3.46
Epoch 12/24
[train] time: 1.32 min, loss: 0.345, map_clean: 3.53, map_observed: 1.59
[val] time: 0.28 min, loss: -999.000, map_clean: 3.55, map_observed: 3.55
*** new best weights ***
[test] time: 0.66 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
Epoch 13/24
[train] time: 1.32 min, loss: 0.345, map_clean: 3.53, map_observed: 1.62
[val] time: 0.27 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
[test] time: 0.67 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 14/24
[train] time: 1.33 min, loss: 0.345, map_clean: 3.53, map_observed: 1.64
[val] time: 0.27 min, loss: -999.000, map_clean: 3.56, map_observed: 3.56
*** new best weights ***
[test] time: 0.66 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
Epoch 15/24
[train] time: 1.33 min, loss: 0.345, map_clean: 3.55, map_observed: 1.67
[val] time: 0.28 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
[test] time: 0.66 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 16/24
[train] time: 1.31 min, loss: 0.345, map_clean: 3.54, map_observed: 1.69
[val] time: 0.27 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
[test] time: 0.70 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 17/24
[train] time: 1.39 min, loss: 0.345, map_clean: 3.54, map_observed: 1.72
[val] time: 0.30 min, loss: -999.000, map_clean: 3.57, map_observed: 3.57
*** new best weights ***
[test] time: 0.70 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
Epoch 18/24
[train] time: 1.38 min, loss: 0.345, map_clean: 3.57, map_observed: 1.74
[val] time: 0.29 min, loss: -999.000, map_clean: 3.56, map_observed: 3.56
[test] time: 0.69 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
Epoch 19/24
[train] time: 1.37 min, loss: 0.345, map_clean: 3.55, map_observed: 1.76
[val] time: 0.29 min, loss: -999.000, map_clean: 3.55, map_observed: 3.55
[test] time: 0.71 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
Epoch 20/24
[train] time: 1.41 min, loss: 0.345, map_clean: 3.54, map_observed: 1.80
[val] time: 0.30 min, loss: -999.000, map_clean: 3.60, map_observed: 3.60
*** new best weights ***
[test] time: 0.70 min, loss: -999.000, map_clean: 3.57, map_observed: 3.57
Epoch 21/24
[train] time: 1.42 min, loss: 0.345, map_clean: 3.57, map_observed: 1.83
[val] time: 0.29 min, loss: -999.000, map_clean: 3.58, map_observed: 3.58
[test] time: 0.71 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
Epoch 22/24
[train] time: 1.44 min, loss: 0.345, map_clean: 3.56, map_observed: 1.84
[val] time: 0.30 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
[test] time: 0.71 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 23/24
[train] time: 1.44 min, loss: 0.345, map_clean: 3.57, map_observed: 1.87
[val] time: 0.30 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
[test] time: 0.73 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
Epoch 24/24
[train] time: 1.36 min, loss: 0.345, map_clean: 3.55, map_observed: 1.89
[val] time: 0.28 min, loss: -999.000, map_clean: 3.59, map_observed: 3.59
[test] time: 0.67 min, loss: -999.000, map_clean: 3.55, map_observed: 3.55

*** TRAINING COMPLETE ***
Best epoch: 20
Best epoch validation score: 3.60
Best epoch test score:       3.57

Saving best weights for f to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_04-44-32_coco/best_model_state_f.pt

Saving best weights for g to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_04-44-32_coco/best_model_state_g.pt

Saving session data to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_04-44-32_coco/logs.json

Saving session data to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_04-44-32_coco/params.json

Reverting model to best weights.
DEVICE: cpu
coco an_ls, location 3 , linear_fixed_features
coco an_ls, location 3 , linear_fixed_features
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 82081 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.11 min, loss: 0.384, map_clean: 3.69, map_observed: 1.26
[val] time: 0.26 min, loss: -999.000, map_clean: 4.36, map_observed: 4.36
*** new best weights ***
[test] time: 0.60 min, loss: -999.000, map_clean: 4.32, map_observed: 4.32
Epoch 1/24
[train] time: 1.10 min, loss: 0.397, map_clean: 3.69, map_observed: 1.35
[val] time: 0.24 min, loss: -999.000, map_clean: 3.86, map_observed: 3.86
[test] time: 0.61 min, loss: -999.000, map_clean: 3.89, map_observed: 3.89
Epoch 2/24
[train] time: 1.09 min, loss: 0.395, map_clean: 3.68, map_observed: 1.40
[val] time: 0.25 min, loss: -999.000, map_clean: 3.68, map_observed: 3.68
[test] time: 0.60 min, loss: -999.000, map_clean: 3.65, map_observed: 3.65
Epoch 3/24
[train] time: 1.08 min, loss: 0.395, map_clean: 3.69, map_observed: 1.42
[val] time: 0.24 min, loss: -999.000, map_clean: 4.11, map_observed: 4.11
[test] time: 0.60 min, loss: -999.000, map_clean: 4.10, map_observed: 4.10
Epoch 4/24
[train] time: 1.10 min, loss: 0.394, map_clean: 3.69, map_observed: 1.46
[val] time: 0.25 min, loss: -999.000, map_clean: 4.09, map_observed: 4.09
[test] time: 0.59 min, loss: -999.000, map_clean: 4.05, map_observed: 4.05
Epoch 5/24
[train] time: 1.11 min, loss: 0.395, map_clean: 3.69, map_observed: 1.46
[val] time: 0.25 min, loss: -999.000, map_clean: 4.08, map_observed: 4.08
[test] time: 0.59 min, loss: -999.000, map_clean: 4.02, map_observed: 4.02
Epoch 6/24
[train] time: 1.09 min, loss: 0.395, map_clean: 3.70, map_observed: 1.49
[val] time: 0.24 min, loss: -999.000, map_clean: 4.51, map_observed: 4.51
*** new best weights ***
[test] time: 0.60 min, loss: -999.000, map_clean: 4.42, map_observed: 4.42
Epoch 7/24
[train] time: 1.11 min, loss: 0.394, map_clean: 3.69, map_observed: 1.50
[val] time: 0.25 min, loss: -999.000, map_clean: 4.12, map_observed: 4.12
[test] time: 0.60 min, loss: -999.000, map_clean: 4.09, map_observed: 4.09
Epoch 8/24
[train] time: 1.10 min, loss: 0.394, map_clean: 3.68, map_observed: 1.50
[val] time: 0.24 min, loss: -999.000, map_clean: 4.05, map_observed: 4.05
[test] time: 0.59 min, loss: -999.000, map_clean: 3.94, map_observed: 3.94
Epoch 9/24
[train] time: 1.10 min, loss: 0.395, map_clean: 3.70, map_observed: 1.51
[val] time: 0.25 min, loss: -999.000, map_clean: 4.31, map_observed: 4.31
[test] time: 0.59 min, loss: -999.000, map_clean: 4.24, map_observed: 4.24
Epoch 10/24
[train] time: 1.09 min, loss: 0.394, map_clean: 3.67, map_observed: 1.52
[val] time: 0.25 min, loss: -999.000, map_clean: 4.00, map_observed: 4.00
[test] time: 0.59 min, loss: -999.000, map_clean: 3.92, map_observed: 3.92
Epoch 11/24
[train] time: 1.10 min, loss: 0.394, map_clean: 3.67, map_observed: 1.53
[val] time: 0.24 min, loss: -999.000, map_clean: 4.21, map_observed: 4.21
[test] time: 0.59 min, loss: -999.000, map_clean: 4.18, map_observed: 4.18
Epoch 12/24
[train] time: 1.10 min, loss: 0.394, map_clean: 3.70, map_observed: 1.53
[val] time: 0.24 min, loss: -999.000, map_clean: 4.16, map_observed: 4.16
[test] time: 0.60 min, loss: -999.000, map_clean: 4.15, map_observed: 4.15
Epoch 13/24
[train] time: 1.10 min, loss: 0.399, map_clean: 3.68, map_observed: 1.52
[val] time: 0.25 min, loss: -999.000, map_clean: 4.33, map_observed: 4.33
[test] time: 0.60 min, loss: -999.000, map_clean: 4.28, map_observed: 4.28
Epoch 14/24
[train] time: 1.10 min, loss: 0.405, map_clean: 3.69, map_observed: 1.52
[val] time: 0.25 min, loss: -999.000, map_clean: 4.41, map_observed: 4.41
[test] time: 0.59 min, loss: -999.000, map_clean: 4.30, map_observed: 4.30
Epoch 15/24
[train] time: 1.08 min, loss: 0.405, map_clean: 3.68, map_observed: 1.54
[val] time: 0.26 min, loss: -999.000, map_clean: 3.83, map_observed: 3.83
[test] time: 0.59 min, loss: -999.000, map_clean: 3.79, map_observed: 3.79
Epoch 16/24
[train] time: 1.09 min, loss: 0.405, map_clean: 3.68, map_observed: 1.53
[val] time: 0.25 min, loss: -999.000, map_clean: 4.37, map_observed: 4.37
[test] time: 0.59 min, loss: -999.000, map_clean: 4.27, map_observed: 4.27
Epoch 17/24
[train] time: 1.11 min, loss: 0.405, map_clean: 3.67, map_observed: 1.54
[val] time: 0.25 min, loss: -999.000, map_clean: 3.96, map_observed: 3.96
[test] time: 0.59 min, loss: -999.000, map_clean: 3.96, map_observed: 3.96
Epoch 18/24
[train] time: 1.09 min, loss: 0.404, map_clean: 3.68, map_observed: 1.53
[val] time: 0.24 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
[test] time: 0.60 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 19/24
[train] time: 1.07 min, loss: 0.405, map_clean: 3.67, map_observed: 1.54
[val] time: 0.26 min, loss: -999.000, map_clean: 5.13, map_observed: 5.13
*** new best weights ***
[test] time: 0.63 min, loss: -999.000, map_clean: 5.07, map_observed: 5.07
Epoch 20/24
[train] time: 1.14 min, loss: 0.404, map_clean: 3.69, map_observed: 1.54
[val] time: 0.27 min, loss: -999.000, map_clean: 4.02, map_observed: 4.02
[test] time: 0.62 min, loss: -999.000, map_clean: 3.92, map_observed: 3.92
Epoch 21/24
[train] time: 1.15 min, loss: 0.405, map_clean: 3.69, map_observed: 1.52
[val] time: 0.26 min, loss: -999.000, map_clean: 4.33, map_observed: 4.33
[test] time: 0.63 min, loss: -999.000, map_clean: 4.30, map_observed: 4.30
Epoch 22/24
[train] time: 1.16 min, loss: 0.405, map_clean: 3.68, map_observed: 1.54
[val] time: 0.25 min, loss: -999.000, map_clean: 3.73, map_observed: 3.73
[test] time: 0.62 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
Epoch 23/24
[train] time: 1.17 min, loss: 0.405, map_clean: 3.69, map_observed: 1.53
[val] time: 0.26 min, loss: -999.000, map_clean: 3.68, map_observed: 3.68
[test] time: 0.64 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
Epoch 24/24
[train] time: 1.18 min, loss: 0.405, map_clean: 3.70, map_observed: 1.53
[val] time: 0.26 min, loss: -999.000, map_clean: 4.66, map_observed: 4.66
[test] time: 0.64 min, loss: -999.000, map_clean: 4.67, map_observed: 4.67

*** TRAINING COMPLETE ***
Best epoch: 19
Best epoch validation score: 5.13
Best epoch test score:       5.07

Saving best weights for f to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_05-45-51_coco/best_model_state_f.pt

Saving best weights for g to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_05-45-51_coco/best_model_state_g.pt

Saving session data to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_05-45-51_coco/logs.json

Saving session data to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_05-45-51_coco/params.json

Reverting model to best weights.
DEVICE: cpu
coco an_ls, location 3 , linear_fixed_features
coco an_ls, location 3 , linear_fixed_features
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 82081 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.17 min, loss: 0.348, map_clean: 3.66, map_observed: 1.27
[val] time: 0.26 min, loss: -999.000, map_clean: 3.75, map_observed: 3.75
*** new best weights ***
[test] time: 0.63 min, loss: -999.000, map_clean: 3.72, map_observed: 3.72
Epoch 1/24
[train] time: 1.17 min, loss: 0.348, map_clean: 3.68, map_observed: 1.37
[val] time: 0.26 min, loss: -999.000, map_clean: 4.34, map_observed: 4.34
*** new best weights ***
[test] time: 0.64 min, loss: -999.000, map_clean: 4.28, map_observed: 4.28
Epoch 2/24
[train] time: 1.07 min, loss: 0.348, map_clean: 3.68, map_observed: 1.45
[val] time: 0.25 min, loss: -999.000, map_clean: 4.33, map_observed: 4.33
[test] time: 0.59 min, loss: -999.000, map_clean: 4.28, map_observed: 4.28
Epoch 3/24
[train] time: 1.10 min, loss: 0.347, map_clean: 3.68, map_observed: 1.55
[val] time: 0.25 min, loss: -999.000, map_clean: 4.74, map_observed: 4.74
*** new best weights ***
[test] time: 0.59 min, loss: -999.000, map_clean: 4.70, map_observed: 4.70
Epoch 4/24
[train] time: 1.11 min, loss: 0.347, map_clean: 3.68, map_observed: 1.61
[val] time: 0.25 min, loss: -999.000, map_clean: 4.11, map_observed: 4.11
[test] time: 0.61 min, loss: -999.000, map_clean: 4.15, map_observed: 4.15
Epoch 5/24
[train] time: 1.11 min, loss: 0.347, map_clean: 3.69, map_observed: 1.70
[val] time: 0.25 min, loss: -999.000, map_clean: 4.17, map_observed: 4.17
[test] time: 0.61 min, loss: -999.000, map_clean: 4.00, map_observed: 4.00
Epoch 6/24
[train] time: 1.11 min, loss: 0.347, map_clean: 3.68, map_observed: 1.74
[val] time: 0.26 min, loss: -999.000, map_clean: 3.67, map_observed: 3.67
[test] time: 0.61 min, loss: -999.000, map_clean: 3.65, map_observed: 3.65
Epoch 7/24
[train] time: 1.09 min, loss: 0.347, map_clean: 3.68, map_observed: 1.81
[val] time: 0.25 min, loss: -999.000, map_clean: 4.16, map_observed: 4.16
[test] time: 0.60 min, loss: -999.000, map_clean: 4.12, map_observed: 4.12
Epoch 8/24
[train] time: 1.11 min, loss: 0.347, map_clean: 3.69, map_observed: 1.86
[val] time: 0.25 min, loss: -999.000, map_clean: 4.25, map_observed: 4.25
[test] time: 0.60 min, loss: -999.000, map_clean: 4.15, map_observed: 4.15
Epoch 9/24
[train] time: 1.09 min, loss: 0.347, map_clean: 3.68, map_observed: 1.92
[val] time: 0.25 min, loss: -999.000, map_clean: 4.07, map_observed: 4.07
[test] time: 0.61 min, loss: -999.000, map_clean: 3.99, map_observed: 3.99
Epoch 10/24
[train] time: 1.13 min, loss: 0.347, map_clean: 3.69, map_observed: 1.96
[val] time: 0.25 min, loss: -999.000, map_clean: 4.13, map_observed: 4.13
[test] time: 0.61 min, loss: -999.000, map_clean: 4.11, map_observed: 4.11
Epoch 11/24
[train] time: 1.10 min, loss: 0.347, map_clean: 3.68, map_observed: 2.03
[val] time: 0.25 min, loss: -999.000, map_clean: 3.70, map_observed: 3.70
[test] time: 0.60 min, loss: -999.000, map_clean: 3.70, map_observed: 3.70
Epoch 12/24
[train] time: 1.10 min, loss: 0.347, map_clean: 3.69, map_observed: 2.05
[val] time: 0.26 min, loss: -999.000, map_clean: 4.26, map_observed: 4.26
[test] time: 0.60 min, loss: -999.000, map_clean: 4.21, map_observed: 4.21
Epoch 13/24
[train] time: 1.12 min, loss: 0.347, map_clean: 3.70, map_observed: 2.10
[val] time: 0.25 min, loss: -999.000, map_clean: 3.86, map_observed: 3.86
[test] time: 0.60 min, loss: -999.000, map_clean: 3.78, map_observed: 3.78
Epoch 14/24
[train] time: 1.11 min, loss: 0.347, map_clean: 3.68, map_observed: 2.12
[val] time: 0.25 min, loss: -999.000, map_clean: 4.03, map_observed: 4.03
[test] time: 0.60 min, loss: -999.000, map_clean: 4.01, map_observed: 4.01
Epoch 15/24
[train] time: 1.10 min, loss: 0.347, map_clean: 3.70, map_observed: 2.17
[val] time: 0.25 min, loss: -999.000, map_clean: 3.96, map_observed: 3.96
[test] time: 0.60 min, loss: -999.000, map_clean: 3.88, map_observed: 3.88
Epoch 16/24
[train] time: 1.11 min, loss: 0.347, map_clean: 3.69, map_observed: 2.20
[val] time: 0.26 min, loss: -999.000, map_clean: 4.11, map_observed: 4.11
[test] time: 0.60 min, loss: -999.000, map_clean: 4.03, map_observed: 4.03
Epoch 17/24
[train] time: 1.12 min, loss: 0.347, map_clean: 3.69, map_observed: 2.23
[val] time: 0.25 min, loss: -999.000, map_clean: 3.84, map_observed: 3.84
[test] time: 0.60 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80
Epoch 18/24
[train] time: 1.10 min, loss: 0.347, map_clean: 3.68, map_observed: 2.31
[val] time: 0.25 min, loss: -999.000, map_clean: 4.01, map_observed: 4.01
[test] time: 0.61 min, loss: -999.000, map_clean: 3.97, map_observed: 3.97
Epoch 19/24
[train] time: 1.11 min, loss: 0.347, map_clean: 3.68, map_observed: 2.28
[val] time: 0.26 min, loss: -999.000, map_clean: 4.24, map_observed: 4.24
[test] time: 0.60 min, loss: -999.000, map_clean: 4.21, map_observed: 4.21
Epoch 20/24
[train] time: 1.10 min, loss: 0.347, map_clean: 3.69, map_observed: 2.31
[val] time: 0.26 min, loss: -999.000, map_clean: 3.97, map_observed: 3.97
[test] time: 0.60 min, loss: -999.000, map_clean: 3.94, map_observed: 3.94
Epoch 21/24
[train] time: 1.11 min, loss: 0.347, map_clean: 3.68, map_observed: 2.37
[val] time: 0.25 min, loss: -999.000, map_clean: 3.97, map_observed: 3.97
[test] time: 0.61 min, loss: -999.000, map_clean: 3.95, map_observed: 3.95
Epoch 22/24
[train] time: 1.11 min, loss: 0.347, map_clean: 3.70, map_observed: 2.38
[val] time: 0.25 min, loss: -999.000, map_clean: 3.81, map_observed: 3.81
[test] time: 0.60 min, loss: -999.000, map_clean: 3.77, map_observed: 3.77
Epoch 23/24
[train] time: 1.09 min, loss: 0.347, map_clean: 3.68, map_observed: 2.38
[val] time: 0.23 min, loss: -999.000, map_clean: 4.26, map_observed: 4.26
[test] time: 0.60 min, loss: -999.000, map_clean: 4.25, map_observed: 4.25
Epoch 24/24
[train] time: 1.14 min, loss: 0.347, map_clean: 3.69, map_observed: 2.41
[val] time: 0.27 min, loss: -999.000, map_clean: 3.84, map_observed: 3.84
[test] time: 0.62 min, loss: -999.000, map_clean: 3.81, map_observed: 3.81

*** TRAINING COMPLETE ***
Best epoch: 3
Best epoch validation score: 4.74
Best epoch test score:       4.70

Saving best weights for f to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_06-40-04_coco/best_model_state_f.pt

Saving best weights for g to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_06-40-04_coco/best_model_state_g.pt

Saving session data to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_06-40-04_coco/logs.json

Saving session data to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_06-40-04_coco/params.json

Reverting model to best weights.
DEVICE: cpu
coco an_ls, location 3 , linear_fixed_features
coco an_ls, location 3 , linear_fixed_features
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 82081 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.13 min, loss: 0.347, map_clean: 3.57, map_observed: 1.26
[val] time: 0.25 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 3.64, map_observed: 3.64
Epoch 1/24
[train] time: 1.16 min, loss: 0.345, map_clean: 3.60, map_observed: 1.35
[val] time: 0.26 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
*** new best weights ***
[test] time: 0.63 min, loss: -999.000, map_clean: 3.65, map_observed: 3.65
Epoch 2/24
[train] time: 1.16 min, loss: 0.345, map_clean: 3.62, map_observed: 1.45
[val] time: 0.26 min, loss: -999.000, map_clean: 3.64, map_observed: 3.64
[test] time: 0.63 min, loss: -999.000, map_clean: 3.64, map_observed: 3.64
Epoch 3/24
[train] time: 1.18 min, loss: 0.345, map_clean: 3.62, map_observed: 1.51
[val] time: 0.26 min, loss: -999.000, map_clean: 3.61, map_observed: 3.61
[test] time: 0.64 min, loss: -999.000, map_clean: 3.60, map_observed: 3.60
Epoch 4/24
[train] time: 1.18 min, loss: 0.345, map_clean: 3.62, map_observed: 1.59
[val] time: 0.26 min, loss: -999.000, map_clean: 3.73, map_observed: 3.73
*** new best weights ***
[test] time: 0.63 min, loss: -999.000, map_clean: 3.72, map_observed: 3.72
Epoch 5/24
[train] time: 1.18 min, loss: 0.345, map_clean: 3.63, map_observed: 1.66
[val] time: 0.27 min, loss: -999.000, map_clean: 3.75, map_observed: 3.75
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 3.74, map_observed: 3.74
Epoch 6/24
[train] time: 1.07 min, loss: 0.345, map_clean: 3.65, map_observed: 1.70
[val] time: 0.25 min, loss: -999.000, map_clean: 3.62, map_observed: 3.62
[test] time: 0.60 min, loss: -999.000, map_clean: 3.59, map_observed: 3.59
Epoch 7/24
[train] time: 1.11 min, loss: 0.345, map_clean: 3.62, map_observed: 1.78
[val] time: 0.25 min, loss: -999.000, map_clean: 3.70, map_observed: 3.70
[test] time: 0.60 min, loss: -999.000, map_clean: 3.69, map_observed: 3.69
Epoch 8/24
[train] time: 1.11 min, loss: 0.345, map_clean: 3.63, map_observed: 1.85
[val] time: 0.25 min, loss: -999.000, map_clean: 3.91, map_observed: 3.91
*** new best weights ***
[test] time: 0.60 min, loss: -999.000, map_clean: 3.90, map_observed: 3.90
Epoch 9/24
[train] time: 1.12 min, loss: 0.345, map_clean: 3.66, map_observed: 1.92
[val] time: 0.25 min, loss: -999.000, map_clean: 3.73, map_observed: 3.73
[test] time: 0.59 min, loss: -999.000, map_clean: 3.72, map_observed: 3.72
Epoch 10/24
[train] time: 1.09 min, loss: 0.345, map_clean: 3.66, map_observed: 1.98
[val] time: 0.25 min, loss: -999.000, map_clean: 3.65, map_observed: 3.65
[test] time: 0.60 min, loss: -999.000, map_clean: 3.59, map_observed: 3.59
Epoch 11/24
[train] time: 1.10 min, loss: 0.345, map_clean: 3.65, map_observed: 2.04
[val] time: 0.25 min, loss: -999.000, map_clean: 3.68, map_observed: 3.68
[test] time: 0.60 min, loss: -999.000, map_clean: 3.67, map_observed: 3.67
Epoch 12/24
[train] time: 1.11 min, loss: 0.345, map_clean: 3.65, map_observed: 2.12
[val] time: 0.25 min, loss: -999.000, map_clean: 3.62, map_observed: 3.62
[test] time: 0.60 min, loss: -999.000, map_clean: 3.56, map_observed: 3.56
Epoch 13/24
[train] time: 1.10 min, loss: 0.345, map_clean: 3.65, map_observed: 2.14
[val] time: 0.26 min, loss: -999.000, map_clean: 3.72, map_observed: 3.72
[test] time: 0.60 min, loss: -999.000, map_clean: 3.69, map_observed: 3.69
Epoch 14/24
[train] time: 1.10 min, loss: 0.345, map_clean: 3.64, map_observed: 2.25
[val] time: 0.24 min, loss: -999.000, map_clean: 3.67, map_observed: 3.67
[test] time: 0.59 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 15/24
[train] time: 1.10 min, loss: 0.345, map_clean: 3.67, map_observed: 2.33
[val] time: 0.25 min, loss: -999.000, map_clean: 3.77, map_observed: 3.77
[test] time: 0.61 min, loss: -999.000, map_clean: 3.70, map_observed: 3.70
Epoch 16/24
[train] time: 1.10 min, loss: 0.345, map_clean: 3.66, map_observed: 2.36
[val] time: 0.24 min, loss: -999.000, map_clean: 3.69, map_observed: 3.69
[test] time: 0.60 min, loss: -999.000, map_clean: 3.65, map_observed: 3.65
Epoch 17/24
[train] time: 1.11 min, loss: 0.345, map_clean: 3.65, map_observed: 2.42
[val] time: 0.25 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
[test] time: 0.61 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 18/24
[train] time: 1.10 min, loss: 0.345, map_clean: 3.65, map_observed: 2.49
[val] time: 0.25 min, loss: -999.000, map_clean: 3.78, map_observed: 3.78
[test] time: 0.61 min, loss: -999.000, map_clean: 3.74, map_observed: 3.74
Epoch 19/24
[train] time: 1.10 min, loss: 0.345, map_clean: 3.66, map_observed: 2.60
[val] time: 0.26 min, loss: -999.000, map_clean: 3.83, map_observed: 3.83
[test] time: 0.60 min, loss: -999.000, map_clean: 3.77, map_observed: 3.77
Epoch 20/24
[train] time: 1.11 min, loss: 0.345, map_clean: 3.67, map_observed: 2.66
[val] time: 0.25 min, loss: -999.000, map_clean: 3.64, map_observed: 3.64
[test] time: 0.59 min, loss: -999.000, map_clean: 3.58, map_observed: 3.58
Epoch 21/24
[train] time: 1.11 min, loss: 0.345, map_clean: 3.66, map_observed: 2.75
[val] time: 0.24 min, loss: -999.000, map_clean: 3.70, map_observed: 3.70
[test] time: 0.60 min, loss: -999.000, map_clean: 3.68, map_observed: 3.68
Epoch 22/24
[train] time: 1.10 min, loss: 0.345, map_clean: 3.67, map_observed: 2.77
[val] time: 0.25 min, loss: -999.000, map_clean: 3.62, map_observed: 3.62
[test] time: 0.60 min, loss: -999.000, map_clean: 3.57, map_observed: 3.57
Epoch 23/24
[train] time: 1.10 min, loss: 0.345, map_clean: 3.67, map_observed: 2.89
[val] time: 0.26 min, loss: -999.000, map_clean: 3.61, map_observed: 3.61
[test] time: 0.59 min, loss: -999.000, map_clean: 3.57, map_observed: 3.57
Epoch 24/24
[train] time: 1.11 min, loss: 0.345, map_clean: 3.66, map_observed: 2.95
[val] time: 0.25 min, loss: -999.000, map_clean: 3.68, map_observed: 3.68
[test] time: 0.60 min, loss: -999.000, map_clean: 3.64, map_observed: 3.64

*** TRAINING COMPLETE ***
Best epoch: 8
Best epoch validation score: 3.91
Best epoch test score:       3.90

Saving best weights for f to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_07-34-39_coco/best_model_state_f.pt

Saving best weights for g to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_07-34-39_coco/best_model_state_g.pt

Saving session data to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_07-34-39_coco/logs.json

Saving session data to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_07-34-39_coco/params.json

Reverting model to best weights.
DEVICE: cpu
coco an_ls, location 3 , linear_fixed_features
coco an_ls, location 3 , linear_fixed_features
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 82081 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.08 min, loss: 0.359, map_clean: 3.51, map_observed: 1.26
[val] time: 0.26 min, loss: -999.000, map_clean: 3.57, map_observed: 3.57
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 3.57, map_observed: 3.57
Epoch 1/24
[train] time: 1.14 min, loss: 0.347, map_clean: 3.60, map_observed: 1.27
[val] time: 0.26 min, loss: -999.000, map_clean: 3.55, map_observed: 3.55
[test] time: 0.61 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
Epoch 2/24
[train] time: 1.14 min, loss: 0.346, map_clean: 3.54, map_observed: 1.30
[val] time: 0.25 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
[test] time: 0.61 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 3/24
[train] time: 1.11 min, loss: 0.345, map_clean: 3.51, map_observed: 1.32
[val] time: 0.26 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
[test] time: 0.63 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 4/24
[train] time: 1.15 min, loss: 0.345, map_clean: 3.51, map_observed: 1.34
[val] time: 0.27 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
[test] time: 0.63 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 5/24
[train] time: 1.15 min, loss: 0.345, map_clean: 3.51, map_observed: 1.36
[val] time: 0.26 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
[test] time: 0.63 min, loss: -999.000, map_clean: 3.48, map_observed: 3.48
Epoch 6/24
[train] time: 1.16 min, loss: 0.345, map_clean: 3.51, map_observed: 1.39
[val] time: 0.26 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
[test] time: 0.62 min, loss: -999.000, map_clean: 3.47, map_observed: 3.47
Epoch 7/24
[train] time: 1.17 min, loss: 0.345, map_clean: 3.50, map_observed: 1.41
[val] time: 0.26 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
[test] time: 0.62 min, loss: -999.000, map_clean: 3.47, map_observed: 3.47
Epoch 8/24
[train] time: 1.17 min, loss: 0.345, map_clean: 3.51, map_observed: 1.43
[val] time: 0.26 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
[test] time: 0.64 min, loss: -999.000, map_clean: 3.47, map_observed: 3.47
Epoch 9/24
[train] time: 1.11 min, loss: 0.345, map_clean: 3.51, map_observed: 1.46
[val] time: 0.25 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
[test] time: 0.61 min, loss: -999.000, map_clean: 3.46, map_observed: 3.46
Epoch 10/24
[train] time: 1.10 min, loss: 0.345, map_clean: 3.51, map_observed: 1.47
[val] time: 0.25 min, loss: -999.000, map_clean: 3.48, map_observed: 3.48
[test] time: 0.60 min, loss: -999.000, map_clean: 3.46, map_observed: 3.46
Epoch 11/24
[train] time: 1.11 min, loss: 0.345, map_clean: 3.52, map_observed: 1.50
[val] time: 0.25 min, loss: -999.000, map_clean: 3.48, map_observed: 3.48
[test] time: 0.60 min, loss: -999.000, map_clean: 3.46, map_observed: 3.46
Epoch 12/24
[train] time: 1.10 min, loss: 0.345, map_clean: 3.52, map_observed: 1.52
[val] time: 0.25 min, loss: -999.000, map_clean: 3.47, map_observed: 3.47
[test] time: 0.59 min, loss: -999.000, map_clean: 3.44, map_observed: 3.44
Epoch 13/24
[train] time: 1.10 min, loss: 0.345, map_clean: 3.51, map_observed: 1.54
[val] time: 0.24 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
[test] time: 0.60 min, loss: -999.000, map_clean: 3.48, map_observed: 3.48
Epoch 14/24
[train] time: 1.11 min, loss: 0.345, map_clean: 3.51, map_observed: 1.55
[val] time: 0.24 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
[test] time: 0.59 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 15/24
[train] time: 1.11 min, loss: 0.345, map_clean: 3.54, map_observed: 1.58
[val] time: 0.25 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
[test] time: 0.60 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 16/24
[train] time: 1.09 min, loss: 0.345, map_clean: 3.53, map_observed: 1.60
[val] time: 0.26 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
[test] time: 0.60 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 17/24
[train] time: 1.10 min, loss: 0.345, map_clean: 3.53, map_observed: 1.61
[val] time: 0.25 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
[test] time: 0.60 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 18/24
[train] time: 1.09 min, loss: 0.345, map_clean: 3.53, map_observed: 1.64
[val] time: 0.26 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
[test] time: 0.59 min, loss: -999.000, map_clean: 3.48, map_observed: 3.48
Epoch 19/24
[train] time: 1.09 min, loss: 0.345, map_clean: 3.54, map_observed: 1.66
[val] time: 0.25 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
[test] time: 0.60 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 20/24
[train] time: 1.10 min, loss: 0.345, map_clean: 3.53, map_observed: 1.67
[val] time: 0.24 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
[test] time: 0.59 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 21/24
[train] time: 1.10 min, loss: 0.345, map_clean: 3.55, map_observed: 1.70
[val] time: 0.25 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
[test] time: 0.60 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 22/24
[train] time: 1.10 min, loss: 0.345, map_clean: 3.55, map_observed: 1.71
[val] time: 0.26 min, loss: -999.000, map_clean: 3.55, map_observed: 3.55
[test] time: 0.59 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
Epoch 23/24
[train] time: 1.11 min, loss: 0.345, map_clean: 3.55, map_observed: 1.73
[val] time: 0.25 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
[test] time: 0.60 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 24/24
[train] time: 1.10 min, loss: 0.345, map_clean: 3.55, map_observed: 1.76
[val] time: 0.25 min, loss: -999.000, map_clean: 3.55, map_observed: 3.55
[test] time: 0.60 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51

*** TRAINING COMPLETE ***
Best epoch: 0
Best epoch validation score: 3.57
Best epoch test score:       3.57

Saving best weights for f to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_08-27-22_coco/best_model_state_f.pt

Saving best weights for g to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_08-27-22_coco/best_model_state_g.pt

Saving session data to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_08-27-22_coco/logs.json

Saving session data to ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_08-27-22_coco/params.json

Reverting model to best weights.
best run: ./results/coco_an_ls_uniform_3_linear_fixed_features_2022_04_27_05-45-51_coco
- learning rate: 0.01
- batch size:    16
- val score:     5.125765076695908
- test score:    5.070108449864095
