DEVICE: cpu
coco an_ls, location 1 , linear_fixed_features
coco an_ls, location 1 , linear_fixed_features
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 82081 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.37 min, loss: 0.405, map_clean: 3.68, map_observed: 1.26
[val] time: 0.28 min, loss: -999.000, map_clean: 4.60, map_observed: 4.60
*** new best weights ***
[test] time: 0.69 min, loss: -999.000, map_clean: 4.49, map_observed: 4.49
Epoch 1/24
[train] time: 1.38 min, loss: 0.425, map_clean: 3.69, map_observed: 1.33
[val] time: 0.29 min, loss: -999.000, map_clean: 3.75, map_observed: 3.75
[test] time: 0.71 min, loss: -999.000, map_clean: 3.72, map_observed: 3.72
Epoch 2/24
[train] time: 1.53 min, loss: 0.443, map_clean: 3.69, map_observed: 1.37
[val] time: 0.30 min, loss: -999.000, map_clean: 4.22, map_observed: 4.22
[test] time: 0.79 min, loss: -999.000, map_clean: 4.12, map_observed: 4.12
Epoch 3/24
[train] time: 1.65 min, loss: 0.470, map_clean: 3.69, map_observed: 1.39
[val] time: 0.34 min, loss: -999.000, map_clean: 4.13, map_observed: 4.13
[test] time: 0.82 min, loss: -999.000, map_clean: 4.21, map_observed: 4.21
Epoch 4/24
[train] time: 1.67 min, loss: 0.502, map_clean: 3.70, map_observed: 1.41
[val] time: 0.39 min, loss: -999.000, map_clean: 4.91, map_observed: 4.91
*** new best weights ***
[test] time: 0.92 min, loss: -999.000, map_clean: 4.86, map_observed: 4.86
Epoch 5/24
[train] time: 1.61 min, loss: 0.518, map_clean: 3.70, map_observed: 1.41
[val] time: 0.34 min, loss: -999.000, map_clean: 4.17, map_observed: 4.17
[test] time: 0.84 min, loss: -999.000, map_clean: 4.19, map_observed: 4.19
Epoch 6/24
[train] time: 1.71 min, loss: 0.545, map_clean: 3.71, map_observed: 1.41
[val] time: 0.35 min, loss: -999.000, map_clean: 3.98, map_observed: 3.98
[test] time: 0.83 min, loss: -999.000, map_clean: 4.01, map_observed: 4.01
Epoch 7/24
[train] time: 1.76 min, loss: 0.567, map_clean: 3.71, map_observed: 1.40
[val] time: 0.39 min, loss: -999.000, map_clean: 3.81, map_observed: 3.81
[test] time: 0.96 min, loss: -999.000, map_clean: 3.74, map_observed: 3.74
Epoch 8/24
[train] time: 1.75 min, loss: 0.570, map_clean: 3.74, map_observed: 1.41
[val] time: 0.34 min, loss: -999.000, map_clean: 4.00, map_observed: 4.00
[test] time: 0.84 min, loss: -999.000, map_clean: 3.96, map_observed: 3.96
Epoch 9/24
[train] time: 1.69 min, loss: 0.579, map_clean: 3.75, map_observed: 1.41
[val] time: 0.34 min, loss: -999.000, map_clean: 4.37, map_observed: 4.37
[test] time: 0.86 min, loss: -999.000, map_clean: 4.37, map_observed: 4.37
Epoch 10/24
[train] time: 1.55 min, loss: 0.581, map_clean: 3.72, map_observed: 1.40
[val] time: 0.32 min, loss: -999.000, map_clean: 3.64, map_observed: 3.64
[test] time: 0.76 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 11/24
[train] time: 1.46 min, loss: 0.590, map_clean: 3.69, map_observed: 1.42
[val] time: 0.29 min, loss: -999.000, map_clean: 3.98, map_observed: 3.98
[test] time: 0.71 min, loss: -999.000, map_clean: 3.99, map_observed: 3.99
Epoch 12/24
[train] time: 1.47 min, loss: 0.598, map_clean: 3.71, map_observed: 1.41
[val] time: 0.29 min, loss: -999.000, map_clean: 3.73, map_observed: 3.73
[test] time: 0.71 min, loss: -999.000, map_clean: 3.75, map_observed: 3.75
Epoch 13/24
[train] time: 1.51 min, loss: 0.608, map_clean: 3.71, map_observed: 1.42
[val] time: 0.32 min, loss: -999.000, map_clean: 3.75, map_observed: 3.75
[test] time: 0.78 min, loss: -999.000, map_clean: 3.75, map_observed: 3.75
Epoch 14/24
[train] time: 1.63 min, loss: 0.631, map_clean: 3.71, map_observed: 1.40
[val] time: 0.29 min, loss: -999.000, map_clean: 4.50, map_observed: 4.50
[test] time: 0.72 min, loss: -999.000, map_clean: 4.43, map_observed: 4.43
Epoch 15/24
[train] time: 1.50 min, loss: 0.633, map_clean: 3.71, map_observed: 1.40
[val] time: 0.29 min, loss: -999.000, map_clean: 3.81, map_observed: 3.81
[test] time: 0.70 min, loss: -999.000, map_clean: 3.81, map_observed: 3.81
Epoch 16/24
[train] time: 1.53 min, loss: 0.632, map_clean: 3.71, map_observed: 1.41
[val] time: 0.29 min, loss: -999.000, map_clean: 4.01, map_observed: 4.01
[test] time: 0.76 min, loss: -999.000, map_clean: 4.01, map_observed: 4.01
Epoch 17/24
[train] time: 1.65 min, loss: 0.658, map_clean: 3.69, map_observed: 1.40
[val] time: 0.32 min, loss: -999.000, map_clean: 3.89, map_observed: 3.89
[test] time: 0.71 min, loss: -999.000, map_clean: 3.91, map_observed: 3.91
Epoch 18/24
[train] time: 1.57 min, loss: 0.680, map_clean: 3.69, map_observed: 1.41
[val] time: 0.29 min, loss: -999.000, map_clean: 3.62, map_observed: 3.62
[test] time: 0.70 min, loss: -999.000, map_clean: 3.61, map_observed: 3.61
Epoch 19/24
[train] time: 1.53 min, loss: 0.691, map_clean: 3.72, map_observed: 1.39
[val] time: 0.29 min, loss: -999.000, map_clean: 3.74, map_observed: 3.74
[test] time: 0.71 min, loss: -999.000, map_clean: 3.75, map_observed: 3.75
Epoch 20/24
[train] time: 1.65 min, loss: 0.707, map_clean: 3.71, map_observed: 1.39
[val] time: 0.31 min, loss: -999.000, map_clean: 3.65, map_observed: 3.65
[test] time: 0.77 min, loss: -999.000, map_clean: 3.65, map_observed: 3.65
Epoch 21/24
[train] time: 1.53 min, loss: 0.715, map_clean: 3.70, map_observed: 1.40
[val] time: 0.29 min, loss: -999.000, map_clean: 3.73, map_observed: 3.73
[test] time: 0.71 min, loss: -999.000, map_clean: 3.70, map_observed: 3.70
Epoch 22/24
[train] time: 1.55 min, loss: 0.724, map_clean: 3.71, map_observed: 1.40
[val] time: 0.29 min, loss: -999.000, map_clean: 4.49, map_observed: 4.49
[test] time: 0.70 min, loss: -999.000, map_clean: 4.49, map_observed: 4.49
Epoch 23/24
[train] time: 1.59 min, loss: 0.726, map_clean: 3.71, map_observed: 1.40
[val] time: 0.31 min, loss: -999.000, map_clean: 3.69, map_observed: 3.69
[test] time: 0.77 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
Epoch 24/24
[train] time: 1.68 min, loss: 0.726, map_clean: 3.71, map_observed: 1.39
[val] time: 0.29 min, loss: -999.000, map_clean: 3.87, map_observed: 3.87
[test] time: 0.70 min, loss: -999.000, map_clean: 3.83, map_observed: 3.83

*** TRAINING COMPLETE ***
Best epoch: 4
Best epoch validation score: 4.91
Best epoch test score:       4.86

Saving best weights for f to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_09-34-26_coco/best_model_state_f.pt

Saving best weights for g to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_09-34-26_coco/best_model_state_g.pt

Saving session data to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_09-34-26_coco/logs.json

Saving session data to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_09-34-26_coco/params.json

Reverting model to best weights.
DEVICE: cpu
coco an_ls, location 1 , linear_fixed_features
coco an_ls, location 1 , linear_fixed_features
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 82081 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.40 min, loss: 0.350, map_clean: 3.68, map_observed: 1.25
[val] time: 0.29 min, loss: -999.000, map_clean: 4.10, map_observed: 4.10
*** new best weights ***
[test] time: 0.69 min, loss: -999.000, map_clean: 4.08, map_observed: 4.08
Epoch 1/24
[train] time: 1.54 min, loss: 0.349, map_clean: 3.69, map_observed: 1.37
[val] time: 0.31 min, loss: -999.000, map_clean: 4.12, map_observed: 4.12
*** new best weights ***
[test] time: 0.76 min, loss: -999.000, map_clean: 4.17, map_observed: 4.17
Epoch 2/24
[train] time: 1.43 min, loss: 0.349, map_clean: 3.67, map_observed: 1.46
[val] time: 0.29 min, loss: -999.000, map_clean: 4.00, map_observed: 4.00
[test] time: 0.70 min, loss: -999.000, map_clean: 3.95, map_observed: 3.95
Epoch 3/24
[train] time: 1.39 min, loss: 0.349, map_clean: 3.71, map_observed: 1.53
[val] time: 0.29 min, loss: -999.000, map_clean: 3.84, map_observed: 3.84
[test] time: 0.71 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80
Epoch 4/24
[train] time: 1.41 min, loss: 0.349, map_clean: 3.69, map_observed: 1.59
[val] time: 0.31 min, loss: -999.000, map_clean: 4.34, map_observed: 4.34
*** new best weights ***
[test] time: 0.76 min, loss: -999.000, map_clean: 4.28, map_observed: 4.28
Epoch 5/24
[train] time: 1.54 min, loss: 0.349, map_clean: 3.70, map_observed: 1.65
[val] time: 0.31 min, loss: -999.000, map_clean: 4.80, map_observed: 4.80
*** new best weights ***
[test] time: 0.70 min, loss: -999.000, map_clean: 4.78, map_observed: 4.78
Epoch 6/24
[train] time: 1.39 min, loss: 0.349, map_clean: 3.69, map_observed: 1.71
[val] time: 0.30 min, loss: -999.000, map_clean: 3.78, map_observed: 3.78
[test] time: 0.70 min, loss: -999.000, map_clean: 3.75, map_observed: 3.75
Epoch 7/24
[train] time: 1.40 min, loss: 0.349, map_clean: 3.69, map_observed: 1.74
[val] time: 0.29 min, loss: -999.000, map_clean: 3.83, map_observed: 3.83
[test] time: 0.72 min, loss: -999.000, map_clean: 3.79, map_observed: 3.79
Epoch 8/24
[train] time: 1.52 min, loss: 0.349, map_clean: 3.68, map_observed: 1.79
[val] time: 0.33 min, loss: -999.000, map_clean: 4.10, map_observed: 4.10
[test] time: 0.76 min, loss: -999.000, map_clean: 4.07, map_observed: 4.07
Epoch 9/24
[train] time: 1.45 min, loss: 0.349, map_clean: 3.69, map_observed: 1.82
[val] time: 0.29 min, loss: -999.000, map_clean: 4.09, map_observed: 4.09
[test] time: 0.71 min, loss: -999.000, map_clean: 4.13, map_observed: 4.13
Epoch 10/24
[train] time: 1.43 min, loss: 0.349, map_clean: 3.69, map_observed: 1.85
[val] time: 0.29 min, loss: -999.000, map_clean: 3.92, map_observed: 3.92
[test] time: 0.72 min, loss: -999.000, map_clean: 3.90, map_observed: 3.90
Epoch 11/24
[train] time: 1.39 min, loss: 0.349, map_clean: 3.69, map_observed: 1.91
[val] time: 0.31 min, loss: -999.000, map_clean: 3.60, map_observed: 3.60
[test] time: 0.78 min, loss: -999.000, map_clean: 3.62, map_observed: 3.62
Epoch 12/24
[train] time: 1.53 min, loss: 0.349, map_clean: 3.68, map_observed: 1.91
[val] time: 0.30 min, loss: -999.000, map_clean: 3.93, map_observed: 3.93
[test] time: 0.70 min, loss: -999.000, map_clean: 3.93, map_observed: 3.93
Epoch 13/24
[train] time: 1.41 min, loss: 0.349, map_clean: 3.68, map_observed: 1.93
[val] time: 0.28 min, loss: -999.000, map_clean: 4.18, map_observed: 4.18
[test] time: 0.70 min, loss: -999.000, map_clean: 4.13, map_observed: 4.13
Epoch 14/24
[train] time: 1.40 min, loss: 0.349, map_clean: 3.69, map_observed: 1.96
[val] time: 0.29 min, loss: -999.000, map_clean: 3.89, map_observed: 3.89
[test] time: 0.71 min, loss: -999.000, map_clean: 3.84, map_observed: 3.84
Epoch 15/24
[train] time: 1.54 min, loss: 0.349, map_clean: 3.69, map_observed: 1.99
[val] time: 0.32 min, loss: -999.000, map_clean: 3.82, map_observed: 3.82
[test] time: 0.74 min, loss: -999.000, map_clean: 3.83, map_observed: 3.83
Epoch 16/24
[train] time: 1.44 min, loss: 0.349, map_clean: 3.69, map_observed: 2.00
[val] time: 0.35 min, loss: -999.000, map_clean: 3.98, map_observed: 3.98
[test] time: 0.84 min, loss: -999.000, map_clean: 3.90, map_observed: 3.90
Epoch 17/24
[train] time: 1.67 min, loss: 0.349, map_clean: 3.69, map_observed: 2.02
[val] time: 0.36 min, loss: -999.000, map_clean: 4.12, map_observed: 4.12
[test] time: 0.85 min, loss: -999.000, map_clean: 4.10, map_observed: 4.10
Epoch 18/24
[train] time: 1.85 min, loss: 0.349, map_clean: 3.69, map_observed: 2.04
[val] time: 0.29 min, loss: -999.000, map_clean: 4.02, map_observed: 4.02
[test] time: 0.85 min, loss: -999.000, map_clean: 3.96, map_observed: 3.96
Epoch 19/24
[train] time: 1.71 min, loss: 0.349, map_clean: 3.68, map_observed: 2.07
[val] time: 0.35 min, loss: -999.000, map_clean: 4.02, map_observed: 4.02
[test] time: 0.84 min, loss: -999.000, map_clean: 3.97, map_observed: 3.97
Epoch 20/24
[train] time: 1.73 min, loss: 0.349, map_clean: 3.69, map_observed: 2.07
[val] time: 0.38 min, loss: -999.000, map_clean: 3.89, map_observed: 3.89
[test] time: 0.96 min, loss: -999.000, map_clean: 3.90, map_observed: 3.90
Epoch 21/24
[train] time: 1.87 min, loss: 0.349, map_clean: 3.69, map_observed: 2.09
[val] time: 0.35 min, loss: -999.000, map_clean: 3.68, map_observed: 3.68
[test] time: 0.84 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 22/24
[train] time: 1.71 min, loss: 0.349, map_clean: 3.69, map_observed: 2.09
[val] time: 0.35 min, loss: -999.000, map_clean: 3.89, map_observed: 3.89
[test] time: 0.84 min, loss: -999.000, map_clean: 3.84, map_observed: 3.84
Epoch 23/24
[train] time: 1.69 min, loss: 0.349, map_clean: 3.68, map_observed: 2.12
[val] time: 0.31 min, loss: -999.000, map_clean: 3.59, map_observed: 3.59
[test] time: 0.77 min, loss: -999.000, map_clean: 3.57, map_observed: 3.57
Epoch 24/24
[train] time: 1.48 min, loss: 0.349, map_clean: 3.68, map_observed: 2.12
[val] time: 0.29 min, loss: -999.000, map_clean: 3.97, map_observed: 3.97
[test] time: 0.71 min, loss: -999.000, map_clean: 3.96, map_observed: 3.96

*** TRAINING COMPLETE ***
Best epoch: 5
Best epoch validation score: 4.80
Best epoch test score:       4.78

Saving best weights for f to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_10-42-36_coco/best_model_state_f.pt

Saving best weights for g to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_10-42-36_coco/best_model_state_g.pt

Saving session data to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_10-42-36_coco/logs.json

Saving session data to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_10-42-36_coco/params.json

Reverting model to best weights.
DEVICE: cpu
coco an_ls, location 1 , linear_fixed_features
coco an_ls, location 1 , linear_fixed_features
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 82081 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.41 min, loss: 0.347, map_clean: 3.53, map_observed: 1.27
[val] time: 0.29 min, loss: -999.000, map_clean: 3.61, map_observed: 3.61
*** new best weights ***
[test] time: 0.72 min, loss: -999.000, map_clean: 3.57, map_observed: 3.57
Epoch 1/24
[train] time: 1.53 min, loss: 0.345, map_clean: 3.62, map_observed: 1.37
[val] time: 0.32 min, loss: -999.000, map_clean: 3.58, map_observed: 3.58
[test] time: 0.77 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
Epoch 2/24
[train] time: 1.39 min, loss: 0.345, map_clean: 3.63, map_observed: 1.46
[val] time: 0.28 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
[test] time: 0.70 min, loss: -999.000, map_clean: 3.45, map_observed: 3.45
Epoch 3/24
[train] time: 1.40 min, loss: 0.345, map_clean: 3.65, map_observed: 1.54
[val] time: 0.30 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
[test] time: 0.70 min, loss: -999.000, map_clean: 3.48, map_observed: 3.48
Epoch 4/24
[train] time: 1.41 min, loss: 0.345, map_clean: 3.63, map_observed: 1.59
[val] time: 0.32 min, loss: -999.000, map_clean: 3.89, map_observed: 3.89
*** new best weights ***
[test] time: 0.77 min, loss: -999.000, map_clean: 3.83, map_observed: 3.83
Epoch 5/24
[train] time: 1.55 min, loss: 0.345, map_clean: 3.68, map_observed: 1.66
[val] time: 0.29 min, loss: -999.000, map_clean: 3.70, map_observed: 3.70
[test] time: 0.70 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
Epoch 6/24
[train] time: 1.39 min, loss: 0.345, map_clean: 3.65, map_observed: 1.72
[val] time: 0.30 min, loss: -999.000, map_clean: 3.97, map_observed: 3.97
*** new best weights ***
[test] time: 0.71 min, loss: -999.000, map_clean: 3.93, map_observed: 3.93
Epoch 7/24
[train] time: 1.40 min, loss: 0.345, map_clean: 3.67, map_observed: 1.77
[val] time: 0.29 min, loss: -999.000, map_clean: 3.65, map_observed: 3.65
[test] time: 0.72 min, loss: -999.000, map_clean: 3.62, map_observed: 3.62
Epoch 8/24
[train] time: 1.55 min, loss: 0.345, map_clean: 3.66, map_observed: 1.85
[val] time: 0.31 min, loss: -999.000, map_clean: 3.65, map_observed: 3.65
[test] time: 0.77 min, loss: -999.000, map_clean: 3.62, map_observed: 3.62
Epoch 9/24
[train] time: 1.42 min, loss: 0.345, map_clean: 3.66, map_observed: 1.89
[val] time: 0.29 min, loss: -999.000, map_clean: 3.90, map_observed: 3.90
[test] time: 0.71 min, loss: -999.000, map_clean: 3.87, map_observed: 3.87
Epoch 10/24
[train] time: 1.41 min, loss: 0.345, map_clean: 3.68, map_observed: 1.97
[val] time: 0.30 min, loss: -999.000, map_clean: 3.72, map_observed: 3.72
[test] time: 0.71 min, loss: -999.000, map_clean: 3.70, map_observed: 3.70
Epoch 11/24
[train] time: 1.41 min, loss: 0.345, map_clean: 3.67, map_observed: 2.06
[val] time: 0.31 min, loss: -999.000, map_clean: 3.93, map_observed: 3.93
[test] time: 0.76 min, loss: -999.000, map_clean: 3.91, map_observed: 3.91
Epoch 12/24
[train] time: 1.54 min, loss: 0.345, map_clean: 3.67, map_observed: 2.10
[val] time: 0.30 min, loss: -999.000, map_clean: 3.69, map_observed: 3.69
[test] time: 0.69 min, loss: -999.000, map_clean: 3.64, map_observed: 3.64
Epoch 13/24
[train] time: 1.41 min, loss: 0.345, map_clean: 3.67, map_observed: 2.15
[val] time: 0.29 min, loss: -999.000, map_clean: 3.72, map_observed: 3.72
[test] time: 0.71 min, loss: -999.000, map_clean: 3.68, map_observed: 3.68
Epoch 14/24
[train] time: 1.42 min, loss: 0.345, map_clean: 3.66, map_observed: 2.21
[val] time: 0.29 min, loss: -999.000, map_clean: 3.78, map_observed: 3.78
[test] time: 0.71 min, loss: -999.000, map_clean: 3.77, map_observed: 3.77
Epoch 15/24
[train] time: 1.54 min, loss: 0.345, map_clean: 3.69, map_observed: 2.29
[val] time: 0.32 min, loss: -999.000, map_clean: 3.59, map_observed: 3.59
[test] time: 0.78 min, loss: -999.000, map_clean: 3.55, map_observed: 3.55
Epoch 16/24
[train] time: 1.43 min, loss: 0.345, map_clean: 3.66, map_observed: 2.33
[val] time: 0.30 min, loss: -999.000, map_clean: 3.87, map_observed: 3.87
[test] time: 0.71 min, loss: -999.000, map_clean: 3.82, map_observed: 3.82
Epoch 17/24
[train] time: 1.41 min, loss: 0.345, map_clean: 3.68, map_observed: 2.44
[val] time: 0.29 min, loss: -999.000, map_clean: 3.89, map_observed: 3.89
[test] time: 0.71 min, loss: -999.000, map_clean: 3.87, map_observed: 3.87
Epoch 18/24
[train] time: 1.43 min, loss: 0.345, map_clean: 3.69, map_observed: 2.44
[val] time: 0.33 min, loss: -999.000, map_clean: 3.72, map_observed: 3.72
[test] time: 0.77 min, loss: -999.000, map_clean: 3.68, map_observed: 3.68
Epoch 19/24
[train] time: 1.53 min, loss: 0.345, map_clean: 3.67, map_observed: 2.60
[val] time: 0.29 min, loss: -999.000, map_clean: 3.78, map_observed: 3.78
[test] time: 0.71 min, loss: -999.000, map_clean: 3.74, map_observed: 3.74
Epoch 20/24
[train] time: 1.41 min, loss: 0.345, map_clean: 3.67, map_observed: 2.63
[val] time: 0.30 min, loss: -999.000, map_clean: 3.73, map_observed: 3.73
[test] time: 0.70 min, loss: -999.000, map_clean: 3.71, map_observed: 3.71
Epoch 21/24
[train] time: 1.43 min, loss: 0.345, map_clean: 3.70, map_observed: 2.62
[val] time: 0.29 min, loss: -999.000, map_clean: 3.74, map_observed: 3.74
[test] time: 0.72 min, loss: -999.000, map_clean: 3.69, map_observed: 3.69
Epoch 22/24
[train] time: 1.57 min, loss: 0.345, map_clean: 3.68, map_observed: 2.78
[val] time: 0.32 min, loss: -999.000, map_clean: 3.55, map_observed: 3.55
[test] time: 0.77 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
Epoch 23/24
[train] time: 1.42 min, loss: 0.345, map_clean: 3.66, map_observed: 2.82
[val] time: 0.29 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80
[test] time: 0.72 min, loss: -999.000, map_clean: 3.77, map_observed: 3.77
Epoch 24/24
[train] time: 1.41 min, loss: 0.345, map_clean: 3.67, map_observed: 2.90
[val] time: 0.29 min, loss: -999.000, map_clean: 3.86, map_observed: 3.86
[test] time: 0.71 min, loss: -999.000, map_clean: 3.82, map_observed: 3.82

*** TRAINING COMPLETE ***
Best epoch: 6
Best epoch validation score: 3.97
Best epoch test score:       3.93

Saving best weights for f to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_11-49-22_coco/best_model_state_f.pt

Saving best weights for g to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_11-49-22_coco/best_model_state_g.pt

Saving session data to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_11-49-22_coco/logs.json

Saving session data to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_11-49-22_coco/params.json

Reverting model to best weights.
DEVICE: cpu
coco an_ls, location 1 , linear_fixed_features
coco an_ls, location 1 , linear_fixed_features
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 82081 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.55 min, loss: 0.353, map_clean: 3.48, map_observed: 1.26
[val] time: 0.32 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
*** new best weights ***
[test] time: 0.73 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
Epoch 1/24
[train] time: 1.39 min, loss: 0.346, map_clean: 3.52, map_observed: 1.29
[val] time: 0.30 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
[test] time: 0.69 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 2/24
[train] time: 1.42 min, loss: 0.345, map_clean: 3.51, map_observed: 1.31
[val] time: 0.29 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
[test] time: 0.71 min, loss: -999.000, map_clean: 3.48, map_observed: 3.48
Epoch 3/24
[train] time: 1.46 min, loss: 0.345, map_clean: 3.51, map_observed: 1.34
[val] time: 0.31 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
[test] time: 0.78 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 4/24
[train] time: 1.47 min, loss: 0.345, map_clean: 3.51, map_observed: 1.37
[val] time: 0.35 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
[test] time: 0.83 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 5/24
[train] time: 1.64 min, loss: 0.345, map_clean: 3.53, map_observed: 1.40
[val] time: 0.34 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
[test] time: 0.85 min, loss: -999.000, map_clean: 3.47, map_observed: 3.47
Epoch 6/24
[train] time: 1.84 min, loss: 0.345, map_clean: 3.53, map_observed: 1.43
[val] time: 0.38 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
[test] time: 0.78 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 7/24
[train] time: 1.62 min, loss: 0.345, map_clean: 3.53, map_observed: 1.46
[val] time: 0.36 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
*** new best weights ***
[test] time: 0.86 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 8/24
[train] time: 1.70 min, loss: 0.345, map_clean: 3.54, map_observed: 1.48
[val] time: 0.35 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
[test] time: 0.92 min, loss: -999.000, map_clean: 3.48, map_observed: 3.48
Epoch 9/24
[train] time: 1.89 min, loss: 0.345, map_clean: 3.55, map_observed: 1.51
[val] time: 0.35 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
[test] time: 0.85 min, loss: -999.000, map_clean: 3.48, map_observed: 3.48
Epoch 10/24
[train] time: 1.67 min, loss: 0.345, map_clean: 3.55, map_observed: 1.54
[val] time: 0.35 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
[test] time: 0.85 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 11/24
[train] time: 1.71 min, loss: 0.345, map_clean: 3.56, map_observed: 1.56
[val] time: 0.39 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
[test] time: 0.87 min, loss: -999.000, map_clean: 3.47, map_observed: 3.47
Epoch 12/24
[train] time: 1.52 min, loss: 0.345, map_clean: 3.56, map_observed: 1.59
[val] time: 0.29 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
[test] time: 0.71 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 13/24
[train] time: 1.40 min, loss: 0.345, map_clean: 3.57, map_observed: 1.61
[val] time: 0.30 min, loss: -999.000, map_clean: 3.56, map_observed: 3.56
*** new best weights ***
[test] time: 0.71 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
Epoch 14/24
[train] time: 1.41 min, loss: 0.345, map_clean: 3.57, map_observed: 1.64
[val] time: 0.29 min, loss: -999.000, map_clean: 3.58, map_observed: 3.58
*** new best weights ***
[test] time: 0.78 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
Epoch 15/24
[train] time: 1.54 min, loss: 0.345, map_clean: 3.59, map_observed: 1.67
[val] time: 0.32 min, loss: -999.000, map_clean: 3.55, map_observed: 3.55
[test] time: 0.72 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 16/24
[train] time: 1.42 min, loss: 0.345, map_clean: 3.56, map_observed: 1.69
[val] time: 0.29 min, loss: -999.000, map_clean: 3.60, map_observed: 3.60
*** new best weights ***
[test] time: 0.70 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
Epoch 17/24
[train] time: 1.41 min, loss: 0.345, map_clean: 3.60, map_observed: 1.71
[val] time: 0.29 min, loss: -999.000, map_clean: 3.57, map_observed: 3.57
[test] time: 0.70 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
Epoch 18/24
[train] time: 1.47 min, loss: 0.345, map_clean: 3.57, map_observed: 1.74
[val] time: 0.32 min, loss: -999.000, map_clean: 3.58, map_observed: 3.58
[test] time: 0.78 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
Epoch 19/24
[train] time: 1.54 min, loss: 0.345, map_clean: 3.59, map_observed: 1.76
[val] time: 0.30 min, loss: -999.000, map_clean: 3.64, map_observed: 3.64
*** new best weights ***
[test] time: 0.71 min, loss: -999.000, map_clean: 3.58, map_observed: 3.58
Epoch 20/24
[train] time: 1.42 min, loss: 0.345, map_clean: 3.60, map_observed: 1.79
[val] time: 0.30 min, loss: -999.000, map_clean: 3.60, map_observed: 3.60
[test] time: 0.71 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
Epoch 21/24
[train] time: 1.43 min, loss: 0.345, map_clean: 3.60, map_observed: 1.80
[val] time: 0.30 min, loss: -999.000, map_clean: 3.56, map_observed: 3.56
[test] time: 0.78 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 22/24
[train] time: 1.58 min, loss: 0.345, map_clean: 3.59, map_observed: 1.83
[val] time: 0.32 min, loss: -999.000, map_clean: 3.57, map_observed: 3.57
[test] time: 0.72 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
Epoch 23/24
[train] time: 1.39 min, loss: 0.345, map_clean: 3.59, map_observed: 1.85
[val] time: 0.30 min, loss: -999.000, map_clean: 3.64, map_observed: 3.64
[test] time: 0.71 min, loss: -999.000, map_clean: 3.57, map_observed: 3.57
Epoch 24/24
[train] time: 1.42 min, loss: 0.345, map_clean: 3.61, map_observed: 1.90
[val] time: 0.29 min, loss: -999.000, map_clean: 3.60, map_observed: 3.60
[test] time: 0.70 min, loss: -999.000, map_clean: 3.55, map_observed: 3.55

*** TRAINING COMPLETE ***
Best epoch: 19
Best epoch validation score: 3.64
Best epoch test score:       3.58

Saving best weights for f to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_12-53-00_coco/best_model_state_f.pt

Saving best weights for g to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_12-53-00_coco/best_model_state_g.pt

Saving session data to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_12-53-00_coco/logs.json

Saving session data to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_12-53-00_coco/params.json

Reverting model to best weights.
DEVICE: cpu
coco an_ls, location 1 , linear_fixed_features
coco an_ls, location 1 , linear_fixed_features
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 82081 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.24 min, loss: 0.389, map_clean: 3.68, map_observed: 1.27
[val] time: 0.29 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 1/24
[train] time: 1.14 min, loss: 0.406, map_clean: 3.69, map_observed: 1.35
[val] time: 0.25 min, loss: -999.000, map_clean: 3.81, map_observed: 3.81
*** new best weights ***
[test] time: 0.63 min, loss: -999.000, map_clean: 3.82, map_observed: 3.82
Epoch 2/24
[train] time: 1.15 min, loss: 0.405, map_clean: 3.68, map_observed: 1.39
[val] time: 0.25 min, loss: -999.000, map_clean: 3.91, map_observed: 3.91
*** new best weights ***
[test] time: 0.63 min, loss: -999.000, map_clean: 3.84, map_observed: 3.84
Epoch 3/24
[train] time: 1.15 min, loss: 0.405, map_clean: 3.69, map_observed: 1.43
[val] time: 0.27 min, loss: -999.000, map_clean: 4.46, map_observed: 4.46
*** new best weights ***
[test] time: 0.66 min, loss: -999.000, map_clean: 4.39, map_observed: 4.39
Epoch 4/24
[train] time: 1.24 min, loss: 0.405, map_clean: 3.70, map_observed: 1.46
[val] time: 0.28 min, loss: -999.000, map_clean: 4.30, map_observed: 4.30
[test] time: 0.65 min, loss: -999.000, map_clean: 4.21, map_observed: 4.21
Epoch 5/24
[train] time: 1.15 min, loss: 0.405, map_clean: 3.68, map_observed: 1.46
[val] time: 0.26 min, loss: -999.000, map_clean: 4.87, map_observed: 4.87
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 4.77, map_observed: 4.77
Epoch 6/24
[train] time: 1.16 min, loss: 0.405, map_clean: 3.69, map_observed: 1.47
[val] time: 0.27 min, loss: -999.000, map_clean: 4.08, map_observed: 4.08
[test] time: 0.62 min, loss: -999.000, map_clean: 4.06, map_observed: 4.06
Epoch 7/24
[train] time: 1.13 min, loss: 0.405, map_clean: 3.70, map_observed: 1.49
[val] time: 0.26 min, loss: -999.000, map_clean: 4.08, map_observed: 4.08
[test] time: 0.66 min, loss: -999.000, map_clean: 4.02, map_observed: 4.02
Epoch 8/24
[train] time: 1.23 min, loss: 0.405, map_clean: 3.69, map_observed: 1.50
[val] time: 0.27 min, loss: -999.000, map_clean: 4.39, map_observed: 4.39
[test] time: 0.67 min, loss: -999.000, map_clean: 4.40, map_observed: 4.40
Epoch 9/24
[train] time: 1.14 min, loss: 0.405, map_clean: 3.68, map_observed: 1.51
[val] time: 0.26 min, loss: -999.000, map_clean: 4.70, map_observed: 4.70
[test] time: 0.63 min, loss: -999.000, map_clean: 4.64, map_observed: 4.64
Epoch 10/24
[train] time: 1.15 min, loss: 0.413, map_clean: 3.68, map_observed: 1.53
[val] time: 0.27 min, loss: -999.000, map_clean: 4.27, map_observed: 4.27
[test] time: 0.62 min, loss: -999.000, map_clean: 4.30, map_observed: 4.30
Epoch 11/24
[train] time: 1.14 min, loss: 0.415, map_clean: 3.70, map_observed: 1.54
[val] time: 0.26 min, loss: -999.000, map_clean: 4.00, map_observed: 4.00
[test] time: 0.64 min, loss: -999.000, map_clean: 3.93, map_observed: 3.93
Epoch 12/24
[train] time: 1.23 min, loss: 0.415, map_clean: 3.68, map_observed: 1.52
[val] time: 0.27 min, loss: -999.000, map_clean: 4.13, map_observed: 4.13
[test] time: 0.67 min, loss: -999.000, map_clean: 4.12, map_observed: 4.12
Epoch 13/24
[train] time: 1.20 min, loss: 0.416, map_clean: 3.68, map_observed: 1.52
[val] time: 0.26 min, loss: -999.000, map_clean: 3.78, map_observed: 3.78
[test] time: 0.62 min, loss: -999.000, map_clean: 3.77, map_observed: 3.77
Epoch 14/24
[train] time: 1.14 min, loss: 0.416, map_clean: 3.69, map_observed: 1.53
[val] time: 0.27 min, loss: -999.000, map_clean: 4.04, map_observed: 4.04
[test] time: 0.61 min, loss: -999.000, map_clean: 4.01, map_observed: 4.01
Epoch 15/24
[train] time: 1.16 min, loss: 0.415, map_clean: 3.69, map_observed: 1.54
[val] time: 0.27 min, loss: -999.000, map_clean: 3.91, map_observed: 3.91
[test] time: 0.63 min, loss: -999.000, map_clean: 3.89, map_observed: 3.89
Epoch 16/24
[train] time: 1.24 min, loss: 0.416, map_clean: 3.69, map_observed: 1.54
[val] time: 0.29 min, loss: -999.000, map_clean: 4.50, map_observed: 4.50
[test] time: 0.68 min, loss: -999.000, map_clean: 4.42, map_observed: 4.42
Epoch 17/24
[train] time: 1.21 min, loss: 0.415, map_clean: 3.69, map_observed: 1.53
[val] time: 0.25 min, loss: -999.000, map_clean: 4.59, map_observed: 4.59
[test] time: 0.63 min, loss: -999.000, map_clean: 4.58, map_observed: 4.58
Epoch 18/24
[train] time: 1.16 min, loss: 0.416, map_clean: 3.69, map_observed: 1.54
[val] time: 0.26 min, loss: -999.000, map_clean: 4.43, map_observed: 4.43
[test] time: 0.62 min, loss: -999.000, map_clean: 4.41, map_observed: 4.41
Epoch 19/24
[train] time: 1.16 min, loss: 0.416, map_clean: 3.69, map_observed: 1.54
[val] time: 0.26 min, loss: -999.000, map_clean: 4.02, map_observed: 4.02
[test] time: 0.63 min, loss: -999.000, map_clean: 4.00, map_observed: 4.00
Epoch 20/24
[train] time: 1.24 min, loss: 0.415, map_clean: 3.69, map_observed: 1.54
[val] time: 0.28 min, loss: -999.000, map_clean: 4.48, map_observed: 4.48
[test] time: 0.67 min, loss: -999.000, map_clean: 4.47, map_observed: 4.47
Epoch 21/24
[train] time: 1.21 min, loss: 0.415, map_clean: 3.69, map_observed: 1.53
[val] time: 0.25 min, loss: -999.000, map_clean: 4.05, map_observed: 4.05
[test] time: 0.64 min, loss: -999.000, map_clean: 4.07, map_observed: 4.07
Epoch 22/24
[train] time: 1.34 min, loss: 0.415, map_clean: 3.68, map_observed: 1.52
[val] time: 0.31 min, loss: -999.000, map_clean: 3.69, map_observed: 3.69
[test] time: 0.71 min, loss: -999.000, map_clean: 3.69, map_observed: 3.69
Epoch 23/24
[train] time: 1.36 min, loss: 0.416, map_clean: 3.68, map_observed: 1.54
[val] time: 0.31 min, loss: -999.000, map_clean: 3.96, map_observed: 3.96
[test] time: 0.78 min, loss: -999.000, map_clean: 3.90, map_observed: 3.90
Epoch 24/24
[train] time: 1.43 min, loss: 0.415, map_clean: 3.69, map_observed: 1.52
[val] time: 0.26 min, loss: -999.000, map_clean: 3.81, map_observed: 3.81
[test] time: 0.72 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80

*** TRAINING COMPLETE ***
Best epoch: 5
Best epoch validation score: 4.87
Best epoch test score:       4.77

Saving best weights for f to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_14-00-21_coco/best_model_state_f.pt

Saving best weights for g to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_14-00-21_coco/best_model_state_g.pt

Saving session data to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_14-00-21_coco/logs.json

Saving session data to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_14-00-21_coco/params.json

Reverting model to best weights.
DEVICE: cpu
coco an_ls, location 1 , linear_fixed_features
coco an_ls, location 1 , linear_fixed_features
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 82081 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.26 min, loss: 0.348, map_clean: 3.65, map_observed: 1.27
[val] time: 0.30 min, loss: -999.000, map_clean: 3.42, map_observed: 3.42
*** new best weights ***
[test] time: 0.76 min, loss: -999.000, map_clean: 3.38, map_observed: 3.38
Epoch 1/24
[train] time: 1.22 min, loss: 0.348, map_clean: 3.69, map_observed: 1.39
[val] time: 0.30 min, loss: -999.000, map_clean: 3.83, map_observed: 3.83
*** new best weights ***
[test] time: 0.72 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80
Epoch 2/24
[train] time: 1.33 min, loss: 0.348, map_clean: 3.68, map_observed: 1.47
[val] time: 0.30 min, loss: -999.000, map_clean: 4.17, map_observed: 4.17
*** new best weights ***
[test] time: 0.71 min, loss: -999.000, map_clean: 4.07, map_observed: 4.07
Epoch 3/24
[train] time: 1.36 min, loss: 0.347, map_clean: 3.68, map_observed: 1.53
[val] time: 0.32 min, loss: -999.000, map_clean: 3.98, map_observed: 3.98
[test] time: 0.80 min, loss: -999.000, map_clean: 3.91, map_observed: 3.91
Epoch 4/24
[train] time: 1.43 min, loss: 0.347, map_clean: 3.71, map_observed: 1.61
[val] time: 0.30 min, loss: -999.000, map_clean: 4.02, map_observed: 4.02
[test] time: 0.69 min, loss: -999.000, map_clean: 3.96, map_observed: 3.96
Epoch 5/24
[train] time: 1.13 min, loss: 0.347, map_clean: 3.68, map_observed: 1.66
[val] time: 0.26 min, loss: -999.000, map_clean: 3.92, map_observed: 3.92
[test] time: 0.62 min, loss: -999.000, map_clean: 3.88, map_observed: 3.88
Epoch 6/24
[train] time: 1.17 min, loss: 0.347, map_clean: 3.70, map_observed: 1.74
[val] time: 0.28 min, loss: -999.000, map_clean: 4.52, map_observed: 4.52
*** new best weights ***
[test] time: 0.66 min, loss: -999.000, map_clean: 4.53, map_observed: 4.53
Epoch 7/24
[train] time: 1.23 min, loss: 0.347, map_clean: 3.68, map_observed: 1.83
[val] time: 0.28 min, loss: -999.000, map_clean: 4.21, map_observed: 4.21
[test] time: 0.63 min, loss: -999.000, map_clean: 4.15, map_observed: 4.15
Epoch 8/24
[train] time: 1.17 min, loss: 0.347, map_clean: 3.69, map_observed: 1.87
[val] time: 0.26 min, loss: -999.000, map_clean: 3.97, map_observed: 3.97
[test] time: 0.63 min, loss: -999.000, map_clean: 3.90, map_observed: 3.90
Epoch 9/24
[train] time: 1.15 min, loss: 0.347, map_clean: 3.69, map_observed: 1.93
[val] time: 0.27 min, loss: -999.000, map_clean: 3.77, map_observed: 3.77
[test] time: 0.61 min, loss: -999.000, map_clean: 3.73, map_observed: 3.73
Epoch 10/24
[train] time: 1.18 min, loss: 0.347, map_clean: 3.70, map_observed: 1.94
[val] time: 0.27 min, loss: -999.000, map_clean: 4.22, map_observed: 4.22
[test] time: 0.67 min, loss: -999.000, map_clean: 4.17, map_observed: 4.17
Epoch 11/24
[train] time: 1.21 min, loss: 0.347, map_clean: 3.68, map_observed: 2.01
[val] time: 0.27 min, loss: -999.000, map_clean: 3.75, map_observed: 3.75
[test] time: 0.63 min, loss: -999.000, map_clean: 3.69, map_observed: 3.69
Epoch 12/24
[train] time: 1.16 min, loss: 0.347, map_clean: 3.69, map_observed: 2.06
[val] time: 0.26 min, loss: -999.000, map_clean: 3.60, map_observed: 3.60
[test] time: 0.63 min, loss: -999.000, map_clean: 3.60, map_observed: 3.60
Epoch 13/24
[train] time: 1.16 min, loss: 0.347, map_clean: 3.69, map_observed: 2.10
[val] time: 0.26 min, loss: -999.000, map_clean: 4.36, map_observed: 4.36
[test] time: 0.63 min, loss: -999.000, map_clean: 4.35, map_observed: 4.35
Epoch 14/24
[train] time: 1.21 min, loss: 0.347, map_clean: 3.68, map_observed: 2.13
[val] time: 0.28 min, loss: -999.000, map_clean: 4.00, map_observed: 4.00
[test] time: 0.67 min, loss: -999.000, map_clean: 3.95, map_observed: 3.95
Epoch 15/24
[train] time: 1.21 min, loss: 0.347, map_clean: 3.70, map_observed: 2.15
[val] time: 0.26 min, loss: -999.000, map_clean: 3.71, map_observed: 3.71
[test] time: 0.64 min, loss: -999.000, map_clean: 3.67, map_observed: 3.67
Epoch 16/24
[train] time: 1.16 min, loss: 0.347, map_clean: 3.69, map_observed: 2.22
[val] time: 0.25 min, loss: -999.000, map_clean: 4.26, map_observed: 4.26
[test] time: 0.61 min, loss: -999.000, map_clean: 4.18, map_observed: 4.18
Epoch 17/24
[train] time: 1.15 min, loss: 0.347, map_clean: 3.69, map_observed: 2.23
[val] time: 0.26 min, loss: -999.000, map_clean: 3.74, map_observed: 3.74
[test] time: 0.66 min, loss: -999.000, map_clean: 3.68, map_observed: 3.68
Epoch 18/24
[train] time: 1.24 min, loss: 0.347, map_clean: 3.69, map_observed: 2.27
[val] time: 0.28 min, loss: -999.000, map_clean: 4.07, map_observed: 4.07
[test] time: 0.67 min, loss: -999.000, map_clean: 4.01, map_observed: 4.01
Epoch 19/24
[train] time: 1.14 min, loss: 0.347, map_clean: 3.71, map_observed: 2.30
[val] time: 0.26 min, loss: -999.000, map_clean: 4.04, map_observed: 4.04
[test] time: 0.63 min, loss: -999.000, map_clean: 3.96, map_observed: 3.96
Epoch 20/24
[train] time: 1.16 min, loss: 0.347, map_clean: 3.68, map_observed: 2.32
[val] time: 0.27 min, loss: -999.000, map_clean: 3.88, map_observed: 3.88
[test] time: 0.63 min, loss: -999.000, map_clean: 3.87, map_observed: 3.87
Epoch 21/24
[train] time: 1.15 min, loss: 0.347, map_clean: 3.68, map_observed: 2.34
[val] time: 0.27 min, loss: -999.000, map_clean: 3.79, map_observed: 3.79
[test] time: 0.67 min, loss: -999.000, map_clean: 3.73, map_observed: 3.73
Epoch 22/24
[train] time: 1.24 min, loss: 0.347, map_clean: 3.69, map_observed: 2.40
[val] time: 0.27 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80
[test] time: 0.62 min, loss: -999.000, map_clean: 3.72, map_observed: 3.72
Epoch 23/24
[train] time: 1.15 min, loss: 0.347, map_clean: 3.69, map_observed: 2.38
[val] time: 0.26 min, loss: -999.000, map_clean: 4.67, map_observed: 4.67
*** new best weights ***
[test] time: 0.63 min, loss: -999.000, map_clean: 4.69, map_observed: 4.69
Epoch 24/24
[train] time: 1.15 min, loss: 0.347, map_clean: 3.69, map_observed: 2.46
[val] time: 0.27 min, loss: -999.000, map_clean: 3.74, map_observed: 3.74
[test] time: 0.63 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66

*** TRAINING COMPLETE ***
Best epoch: 23
Best epoch validation score: 4.67
Best epoch test score:       4.69

Saving best weights for f to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_14-56-43_coco/best_model_state_f.pt

Saving best weights for g to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_14-56-43_coco/best_model_state_g.pt

Saving session data to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_14-56-43_coco/logs.json

Saving session data to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_14-56-43_coco/params.json

Reverting model to best weights.
DEVICE: cpu
coco an_ls, location 1 , linear_fixed_features
coco an_ls, location 1 , linear_fixed_features
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 82081 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.24 min, loss: 0.347, map_clean: 3.52, map_observed: 1.26
[val] time: 0.28 min, loss: -999.000, map_clean: 3.69, map_observed: 3.69
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
Epoch 1/24
[train] time: 1.15 min, loss: 0.345, map_clean: 3.59, map_observed: 1.34
[val] time: 0.26 min, loss: -999.000, map_clean: 3.70, map_observed: 3.70
*** new best weights ***
[test] time: 0.63 min, loss: -999.000, map_clean: 3.65, map_observed: 3.65
Epoch 2/24
[train] time: 1.16 min, loss: 0.345, map_clean: 3.60, map_observed: 1.44
[val] time: 0.26 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80
*** new best weights ***
[test] time: 0.63 min, loss: -999.000, map_clean: 3.75, map_observed: 3.75
Epoch 3/24
[train] time: 1.18 min, loss: 0.345, map_clean: 3.68, map_observed: 1.50
[val] time: 0.28 min, loss: -999.000, map_clean: 3.81, map_observed: 3.81
*** new best weights ***
[test] time: 0.68 min, loss: -999.000, map_clean: 3.75, map_observed: 3.75
Epoch 4/24
[train] time: 1.23 min, loss: 0.345, map_clean: 3.63, map_observed: 1.57
[val] time: 0.26 min, loss: -999.000, map_clean: 3.81, map_observed: 3.81
*** new best weights ***
[test] time: 0.63 min, loss: -999.000, map_clean: 3.78, map_observed: 3.78
Epoch 5/24
[train] time: 1.16 min, loss: 0.345, map_clean: 3.65, map_observed: 1.65
[val] time: 0.27 min, loss: -999.000, map_clean: 3.84, map_observed: 3.84
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80
Epoch 6/24
[train] time: 1.18 min, loss: 0.345, map_clean: 3.68, map_observed: 1.70
[val] time: 0.28 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
[test] time: 0.64 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 7/24
[train] time: 1.23 min, loss: 0.345, map_clean: 3.65, map_observed: 1.77
[val] time: 0.28 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80
[test] time: 0.66 min, loss: -999.000, map_clean: 3.75, map_observed: 3.75
Epoch 8/24
[train] time: 1.18 min, loss: 0.345, map_clean: 3.67, map_observed: 1.87
[val] time: 0.26 min, loss: -999.000, map_clean: 3.64, map_observed: 3.64
[test] time: 0.63 min, loss: -999.000, map_clean: 3.62, map_observed: 3.62
Epoch 9/24
[train] time: 1.17 min, loss: 0.345, map_clean: 3.66, map_observed: 1.90
[val] time: 0.26 min, loss: -999.000, map_clean: 3.73, map_observed: 3.73
[test] time: 0.63 min, loss: -999.000, map_clean: 3.70, map_observed: 3.70
Epoch 10/24
[train] time: 1.16 min, loss: 0.345, map_clean: 3.67, map_observed: 1.98
[val] time: 0.27 min, loss: -999.000, map_clean: 3.71, map_observed: 3.71
[test] time: 0.68 min, loss: -999.000, map_clean: 3.67, map_observed: 3.67
Epoch 11/24
[train] time: 1.22 min, loss: 0.345, map_clean: 3.64, map_observed: 2.05
[val] time: 0.27 min, loss: -999.000, map_clean: 3.75, map_observed: 3.75
[test] time: 0.66 min, loss: -999.000, map_clean: 3.71, map_observed: 3.71
Epoch 12/24
[train] time: 1.16 min, loss: 0.345, map_clean: 3.68, map_observed: 2.09
[val] time: 0.27 min, loss: -999.000, map_clean: 3.77, map_observed: 3.77
[test] time: 0.64 min, loss: -999.000, map_clean: 3.71, map_observed: 3.71
Epoch 13/24
[train] time: 1.16 min, loss: 0.345, map_clean: 3.68, map_observed: 2.19
[val] time: 0.26 min, loss: -999.000, map_clean: 3.68, map_observed: 3.68
[test] time: 0.63 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
Epoch 14/24
[train] time: 1.16 min, loss: 0.345, map_clean: 3.68, map_observed: 2.28
[val] time: 0.29 min, loss: -999.000, map_clean: 3.79, map_observed: 3.79
[test] time: 0.67 min, loss: -999.000, map_clean: 3.74, map_observed: 3.74
Epoch 15/24
[train] time: 1.24 min, loss: 0.345, map_clean: 3.67, map_observed: 2.31
[val] time: 0.27 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80
[test] time: 0.63 min, loss: -999.000, map_clean: 3.76, map_observed: 3.76
Epoch 16/24
[train] time: 1.19 min, loss: 0.345, map_clean: 3.68, map_observed: 2.40
[val] time: 0.26 min, loss: -999.000, map_clean: 3.70, map_observed: 3.70
[test] time: 0.63 min, loss: -999.000, map_clean: 3.67, map_observed: 3.67
Epoch 17/24
[train] time: 1.16 min, loss: 0.345, map_clean: 3.67, map_observed: 2.49
[val] time: 0.26 min, loss: -999.000, map_clean: 3.69, map_observed: 3.69
[test] time: 0.63 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 18/24
[train] time: 1.16 min, loss: 0.345, map_clean: 3.67, map_observed: 2.50
[val] time: 0.30 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80
[test] time: 0.80 min, loss: -999.000, map_clean: 3.78, map_observed: 3.78
Epoch 19/24
[train] time: 1.34 min, loss: 0.345, map_clean: 3.68, map_observed: 2.68
[val] time: 0.30 min, loss: -999.000, map_clean: 3.76, map_observed: 3.76
[test] time: 0.73 min, loss: -999.000, map_clean: 3.73, map_observed: 3.73
Epoch 20/24
[train] time: 1.33 min, loss: 0.345, map_clean: 3.68, map_observed: 2.61
[val] time: 0.32 min, loss: -999.000, map_clean: 3.71, map_observed: 3.71
[test] time: 0.73 min, loss: -999.000, map_clean: 3.67, map_observed: 3.67
Epoch 21/24
[train] time: 1.34 min, loss: 0.345, map_clean: 3.67, map_observed: 2.77
[val] time: 0.33 min, loss: -999.000, map_clean: 3.89, map_observed: 3.89
*** new best weights ***
[test] time: 0.79 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80
Epoch 22/24
[train] time: 1.33 min, loss: 0.345, map_clean: 3.68, map_observed: 2.85
[val] time: 0.30 min, loss: -999.000, map_clean: 3.69, map_observed: 3.69
[test] time: 0.72 min, loss: -999.000, map_clean: 3.65, map_observed: 3.65
Epoch 23/24
[train] time: 1.33 min, loss: 0.345, map_clean: 3.68, map_observed: 2.88
[val] time: 0.30 min, loss: -999.000, map_clean: 3.78, map_observed: 3.78
[test] time: 0.70 min, loss: -999.000, map_clean: 3.74, map_observed: 3.74
Epoch 24/24
[train] time: 1.38 min, loss: 0.345, map_clean: 3.68, map_observed: 2.99
[val] time: 0.34 min, loss: -999.000, map_clean: 3.80, map_observed: 3.80
[test] time: 0.78 min, loss: -999.000, map_clean: 3.78, map_observed: 3.78

*** TRAINING COMPLETE ***
Best epoch: 21
Best epoch validation score: 3.89
Best epoch test score:       3.80

Saving best weights for f to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_15-53-13_coco/best_model_state_f.pt

Saving best weights for g to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_15-53-13_coco/best_model_state_g.pt

Saving session data to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_15-53-13_coco/logs.json

Saving session data to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_15-53-13_coco/params.json

Reverting model to best weights.
DEVICE: cpu
coco an_ls, location 1 , linear_fixed_features
coco an_ls, location 1 , linear_fixed_features
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 82081 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.31 min, loss: 0.360, map_clean: 3.49, map_observed: 1.27
[val] time: 0.34 min, loss: -999.000, map_clean: 3.46, map_observed: 3.46
*** new best weights ***
[test] time: 0.79 min, loss: -999.000, map_clean: 3.44, map_observed: 3.44
Epoch 1/24
[train] time: 1.40 min, loss: 0.347, map_clean: 3.49, map_observed: 1.28
[val] time: 0.25 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
*** new best weights ***
[test] time: 0.63 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 2/24
[train] time: 1.16 min, loss: 0.346, map_clean: 3.50, map_observed: 1.30
[val] time: 0.26 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
*** new best weights ***
[test] time: 0.64 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
Epoch 3/24
[train] time: 1.15 min, loss: 0.345, map_clean: 3.51, map_observed: 1.32
[val] time: 0.26 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
[test] time: 0.67 min, loss: -999.000, map_clean: 3.49, map_observed: 3.49
Epoch 4/24
[train] time: 1.23 min, loss: 0.345, map_clean: 3.52, map_observed: 1.34
[val] time: 0.28 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
*** new best weights ***
[test] time: 0.66 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
Epoch 5/24
[train] time: 1.15 min, loss: 0.345, map_clean: 3.52, map_observed: 1.37
[val] time: 0.26 min, loss: -999.000, map_clean: 3.55, map_observed: 3.55
*** new best weights ***
[test] time: 0.63 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
Epoch 6/24
[train] time: 1.16 min, loss: 0.345, map_clean: 3.53, map_observed: 1.38
[val] time: 0.26 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
[test] time: 0.63 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
Epoch 7/24
[train] time: 1.19 min, loss: 0.345, map_clean: 3.53, map_observed: 1.41
[val] time: 0.27 min, loss: -999.000, map_clean: 3.55, map_observed: 3.55
*** new best weights ***
[test] time: 0.66 min, loss: -999.000, map_clean: 3.51, map_observed: 3.51
Epoch 8/24
[train] time: 1.21 min, loss: 0.345, map_clean: 3.53, map_observed: 1.43
[val] time: 0.27 min, loss: -999.000, map_clean: 3.56, map_observed: 3.56
*** new best weights ***
[test] time: 0.63 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
Epoch 9/24
[train] time: 1.15 min, loss: 0.345, map_clean: 3.54, map_observed: 1.45
[val] time: 0.26 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
[test] time: 0.62 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 10/24
[train] time: 1.15 min, loss: 0.345, map_clean: 3.54, map_observed: 1.47
[val] time: 0.27 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
[test] time: 0.62 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 11/24
[train] time: 1.16 min, loss: 0.345, map_clean: 3.52, map_observed: 1.49
[val] time: 0.27 min, loss: -999.000, map_clean: 3.57, map_observed: 3.57
*** new best weights ***
[test] time: 0.68 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
Epoch 12/24
[train] time: 1.22 min, loss: 0.345, map_clean: 3.55, map_observed: 1.52
[val] time: 0.26 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
[test] time: 0.63 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 13/24
[train] time: 1.16 min, loss: 0.345, map_clean: 3.55, map_observed: 1.53
[val] time: 0.26 min, loss: -999.000, map_clean: 3.56, map_observed: 3.56
[test] time: 0.63 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
Epoch 14/24
[train] time: 1.14 min, loss: 0.345, map_clean: 3.55, map_observed: 1.55
[val] time: 0.26 min, loss: -999.000, map_clean: 3.57, map_observed: 3.57
*** new best weights ***
[test] time: 0.65 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
Epoch 15/24
[train] time: 1.24 min, loss: 0.345, map_clean: 3.55, map_observed: 1.58
[val] time: 0.28 min, loss: -999.000, map_clean: 3.56, map_observed: 3.56
[test] time: 0.67 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
Epoch 16/24
[train] time: 1.19 min, loss: 0.345, map_clean: 3.57, map_observed: 1.60
[val] time: 0.27 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
[test] time: 0.62 min, loss: -999.000, map_clean: 3.50, map_observed: 3.50
Epoch 17/24
[train] time: 1.16 min, loss: 0.345, map_clean: 3.54, map_observed: 1.62
[val] time: 0.26 min, loss: -999.000, map_clean: 3.59, map_observed: 3.59
*** new best weights ***
[test] time: 0.63 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
Epoch 18/24
[train] time: 1.15 min, loss: 0.345, map_clean: 3.55, map_observed: 1.62
[val] time: 0.26 min, loss: -999.000, map_clean: 3.59, map_observed: 3.59
*** new best weights ***
[test] time: 0.68 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
Epoch 19/24
[train] time: 1.26 min, loss: 0.345, map_clean: 3.56, map_observed: 1.65
[val] time: 0.28 min, loss: -999.000, map_clean: 3.59, map_observed: 3.59
*** new best weights ***
[test] time: 0.66 min, loss: -999.000, map_clean: 3.54, map_observed: 3.54
Epoch 20/24
[train] time: 1.16 min, loss: 0.345, map_clean: 3.57, map_observed: 1.67
[val] time: 0.26 min, loss: -999.000, map_clean: 3.56, map_observed: 3.56
[test] time: 0.63 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
Epoch 21/24
[train] time: 1.16 min, loss: 0.345, map_clean: 3.57, map_observed: 1.69
[val] time: 0.27 min, loss: -999.000, map_clean: 3.58, map_observed: 3.58
[test] time: 0.65 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53
Epoch 22/24
[train] time: 1.17 min, loss: 0.345, map_clean: 3.57, map_observed: 1.72
[val] time: 0.27 min, loss: -999.000, map_clean: 3.59, map_observed: 3.59
*** new best weights ***
[test] time: 0.67 min, loss: -999.000, map_clean: 3.55, map_observed: 3.55
Epoch 23/24
[train] time: 1.23 min, loss: 0.345, map_clean: 3.59, map_observed: 1.73
[val] time: 0.27 min, loss: -999.000, map_clean: 3.57, map_observed: 3.57
[test] time: 0.63 min, loss: -999.000, map_clean: 3.52, map_observed: 3.52
Epoch 24/24
[train] time: 1.15 min, loss: 0.345, map_clean: 3.57, map_observed: 1.75
[val] time: 0.27 min, loss: -999.000, map_clean: 3.58, map_observed: 3.58
[test] time: 0.63 min, loss: -999.000, map_clean: 3.53, map_observed: 3.53

*** TRAINING COMPLETE ***
Best epoch: 22
Best epoch validation score: 3.59
Best epoch test score:       3.55

Saving best weights for f to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_16-50-29_coco/best_model_state_f.pt

Saving best weights for g to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_16-50-29_coco/best_model_state_g.pt

Saving session data to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_16-50-29_coco/logs.json

Saving session data to ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_16-50-29_coco/params.json

Reverting model to best weights.
best run: ./results/coco_an_ls_uniform_1_linear_fixed_features_2022_04_26_09-34-26_coco
- learning rate: 0.01
- batch size:    8
- val score:     4.913315558278574
- test score:    4.862900477426935
