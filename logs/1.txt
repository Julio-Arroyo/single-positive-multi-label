PASCAL EM, uniform 1 , LINEAR FIXED FEATURES
PASCAL EM, uniform 1 , LINEAR FIXED FEATURES
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 4574 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 0.08 min, loss: -0.012, map_clean: 12.29, map_observed: 9.13
[val] time: 0.02 min, loss: -999.000, map_clean: 15.83, map_observed: 15.83
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 15.00, map_observed: 15.00
Epoch 1/24
[train] time: 0.08 min, loss: -0.011, map_clean: 12.47, map_observed: 9.31
[val] time: 0.02 min, loss: -999.000, map_clean: 16.05, map_observed: 16.05
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 15.15, map_observed: 15.15
Epoch 2/24
[train] time: 0.08 min, loss: -0.007, map_clean: 10.80, map_observed: 8.12
[val] time: 0.02 min, loss: -999.000, map_clean: 11.88, map_observed: 11.88
[test] time: 0.09 min, loss: -999.000, map_clean: 11.31, map_observed: 11.31
Epoch 3/24
[train] time: 0.08 min, loss: -0.006, map_clean: 10.64, map_observed: 8.20
[val] time: 0.02 min, loss: -999.000, map_clean: 11.61, map_observed: 11.61
[test] time: 0.09 min, loss: -999.000, map_clean: 10.99, map_observed: 10.99
Epoch 4/24
[train] time: 0.08 min, loss: -0.006, map_clean: 11.33, map_observed: 8.66
[val] time: 0.02 min, loss: -999.000, map_clean: 11.81, map_observed: 11.81
[test] time: 0.09 min, loss: -999.000, map_clean: 11.32, map_observed: 11.32
Epoch 5/24
[train] time: 0.09 min, loss: -0.005, map_clean: 8.59, map_observed: 6.07
[val] time: 0.02 min, loss: -999.000, map_clean: 11.51, map_observed: 11.51
[test] time: 0.09 min, loss: -999.000, map_clean: 11.05, map_observed: 11.05
Epoch 6/24
[train] time: 0.09 min, loss: -0.006, map_clean: 11.43, map_observed: 8.83
[val] time: 0.02 min, loss: -999.000, map_clean: 11.89, map_observed: 11.89
[test] time: 0.09 min, loss: -999.000, map_clean: 11.23, map_observed: 11.23
Epoch 7/24
[train] time: 0.10 min, loss: -0.006, map_clean: 11.45, map_observed: 8.84
[val] time: 0.03 min, loss: -999.000, map_clean: 11.94, map_observed: 11.94
[test] time: 0.11 min, loss: -999.000, map_clean: 11.35, map_observed: 11.35
Epoch 8/24
[train] time: 0.10 min, loss: -0.003, map_clean: 11.45, map_observed: 8.85
[val] time: 0.02 min, loss: -999.000, map_clean: 11.81, map_observed: 11.81
[test] time: 0.09 min, loss: -999.000, map_clean: 11.31, map_observed: 11.31
Epoch 9/24
[train] time: 0.09 min, loss: 0.010, map_clean: 11.28, map_observed: 8.79
[val] time: 0.02 min, loss: -999.000, map_clean: 11.87, map_observed: 11.87
[test] time: 0.09 min, loss: -999.000, map_clean: 11.29, map_observed: 11.29
Epoch 10/24
[train] time: 0.08 min, loss: 0.010, map_clean: 11.44, map_observed: 8.70
[val] time: 0.02 min, loss: -999.000, map_clean: 11.86, map_observed: 11.86
[test] time: 0.09 min, loss: -999.000, map_clean: 11.29, map_observed: 11.29
Epoch 11/24
[train] time: 0.08 min, loss: 0.010, map_clean: 11.65, map_observed: 9.17
[val] time: 0.02 min, loss: -999.000, map_clean: 11.80, map_observed: 11.80
[test] time: 0.08 min, loss: -999.000, map_clean: 11.17, map_observed: 11.17
Epoch 12/24
[train] time: 0.07 min, loss: 0.010, map_clean: 11.14, map_observed: 8.64
[val] time: 0.02 min, loss: -999.000, map_clean: 11.80, map_observed: 11.80
[test] time: 0.08 min, loss: -999.000, map_clean: 11.02, map_observed: 11.02
Epoch 13/24
[train] time: 0.08 min, loss: 0.013, map_clean: 7.42, map_observed: 5.10
[val] time: 0.02 min, loss: -999.000, map_clean: 7.37, map_observed: 7.37
[test] time: 0.09 min, loss: -999.000, map_clean: 7.22, map_observed: 7.22
Epoch 14/24
[train] time: 0.08 min, loss: 0.016, map_clean: 7.34, map_observed: 5.02
[val] time: 0.02 min, loss: -999.000, map_clean: 7.38, map_observed: 7.38
[test] time: 0.09 min, loss: -999.000, map_clean: 7.22, map_observed: 7.22
Epoch 15/24
[train] time: 0.08 min, loss: 0.032, map_clean: 7.34, map_observed: 5.02
[val] time: 0.02 min, loss: -999.000, map_clean: 7.37, map_observed: 7.37
[test] time: 0.08 min, loss: -999.000, map_clean: 7.23, map_observed: 7.23
Epoch 16/24
[train] time: 0.08 min, loss: 0.036, map_clean: 7.33, map_observed: 5.03
[val] time: 0.02 min, loss: -999.000, map_clean: 7.37, map_observed: 7.37
[test] time: 0.08 min, loss: -999.000, map_clean: 7.23, map_observed: 7.23
Epoch 17/24
[train] time: 0.08 min, loss: 0.036, map_clean: 7.33, map_observed: 5.03
[val] time: 0.02 min, loss: -999.000, map_clean: 7.37, map_observed: 7.37
[test] time: 0.08 min, loss: -999.000, map_clean: 7.23, map_observed: 7.23
Epoch 18/24
[train] time: 0.07 min, loss: 0.036, map_clean: 7.33, map_observed: 5.03
[val] time: 0.02 min, loss: -999.000, map_clean: 7.37, map_observed: 7.37
[test] time: 0.08 min, loss: -999.000, map_clean: 7.23, map_observed: 7.23
Epoch 19/24
[train] time: 0.08 min, loss: 0.036, map_clean: 7.33, map_observed: 5.03
[val] time: 0.02 min, loss: -999.000, map_clean: 7.37, map_observed: 7.37
[test] time: 0.08 min, loss: -999.000, map_clean: 7.24, map_observed: 7.24
Epoch 20/24
[train] time: 0.08 min, loss: 0.036, map_clean: 7.33, map_observed: 5.03
[val] time: 0.02 min, loss: -999.000, map_clean: 7.37, map_observed: 7.37
[test] time: 0.08 min, loss: -999.000, map_clean: 7.24, map_observed: 7.24
Epoch 21/24
[train] time: 0.07 min, loss: 0.036, map_clean: 7.33, map_observed: 5.03
[val] time: 0.02 min, loss: -999.000, map_clean: 7.37, map_observed: 7.37
[test] time: 0.09 min, loss: -999.000, map_clean: 7.24, map_observed: 7.24
Epoch 22/24
[train] time: 0.08 min, loss: 0.036, map_clean: 7.33, map_observed: 5.03
[val] time: 0.02 min, loss: -999.000, map_clean: 7.37, map_observed: 7.37
[test] time: 0.08 min, loss: -999.000, map_clean: 7.24, map_observed: 7.24
Epoch 23/24
[train] time: 0.07 min, loss: 0.036, map_clean: 7.34, map_observed: 5.03
[val] time: 0.02 min, loss: -999.000, map_clean: 7.37, map_observed: 7.37
[test] time: 0.08 min, loss: -999.000, map_clean: 7.24, map_observed: 7.24
Epoch 24/24
[train] time: 0.08 min, loss: 0.036, map_clean: 7.34, map_observed: 5.04
[val] time: 0.02 min, loss: -999.000, map_clean: 7.38, map_observed: 7.38
[test] time: 0.08 min, loss: -999.000, map_clean: 7.25, map_observed: 7.25

*** TRAINING COMPLETE ***
Best epoch: 1
Best epoch validation score: 16.05
Best epoch test score:       15.15

Saving best weights for f to ./results/multi_label_experiment_2022_04_14_20-04-42_pascal/best_model_state_f.pt

Saving best weights for g to ./results/multi_label_experiment_2022_04_14_20-04-42_pascal/best_model_state_g.pt

Saving session data to ./results/multi_label_experiment_2022_04_14_20-04-42_pascal/logs.json

Saving session data to ./results/multi_label_experiment_2022_04_14_20-04-42_pascal/params.json

Reverting model to best weights.
PASCAL EM, uniform 1 , LINEAR FIXED FEATURES
PASCAL EM, uniform 1 , LINEAR FIXED FEATURES
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 4574 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 0.09 min, loss: -0.117, map_clean: 71.79, map_observed: 59.69
[val] time: 0.02 min, loss: -999.000, map_clean: 83.64, map_observed: 83.64
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 83.71, map_observed: 83.71
Epoch 1/24
[train] time: 0.08 min, loss: -0.120, map_clean: 82.48, map_observed: 70.55
[val] time: 0.02 min, loss: -999.000, map_clean: 84.35, map_observed: 84.35
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 84.88, map_observed: 84.88
Epoch 2/24
[train] time: 0.09 min, loss: -0.121, map_clean: 84.87, map_observed: 72.49
[val] time: 0.02 min, loss: -999.000, map_clean: 84.75, map_observed: 84.75
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 85.19, map_observed: 85.19
Epoch 3/24
[train] time: 0.08 min, loss: -0.121, map_clean: 85.52, map_observed: 73.63
[val] time: 0.02 min, loss: -999.000, map_clean: 85.36, map_observed: 85.36
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 85.63, map_observed: 85.63
Epoch 4/24
[train] time: 0.08 min, loss: -0.122, map_clean: 86.16, map_observed: 74.24
[val] time: 0.02 min, loss: -999.000, map_clean: 84.80, map_observed: 84.80
[test] time: 0.09 min, loss: -999.000, map_clean: 85.26, map_observed: 85.26
Epoch 5/24
[train] time: 0.08 min, loss: -0.122, map_clean: 86.51, map_observed: 74.76
[val] time: 0.02 min, loss: -999.000, map_clean: 85.02, map_observed: 85.02
[test] time: 0.09 min, loss: -999.000, map_clean: 85.36, map_observed: 85.36
Epoch 6/24
[train] time: 0.08 min, loss: -0.122, map_clean: 87.02, map_observed: 75.15
[val] time: 0.02 min, loss: -999.000, map_clean: 85.38, map_observed: 85.38
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 85.96, map_observed: 85.96
Epoch 7/24
[train] time: 0.08 min, loss: -0.122, map_clean: 87.75, map_observed: 76.52
[val] time: 0.02 min, loss: -999.000, map_clean: 85.08, map_observed: 85.08
[test] time: 0.09 min, loss: -999.000, map_clean: 85.87, map_observed: 85.87
Epoch 8/24
[train] time: 0.08 min, loss: -0.122, map_clean: 87.46, map_observed: 76.34
[val] time: 0.02 min, loss: -999.000, map_clean: 85.49, map_observed: 85.49
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 85.83, map_observed: 85.83
Epoch 9/24
[train] time: 0.07 min, loss: -0.122, map_clean: 87.89, map_observed: 76.86
[val] time: 0.02 min, loss: -999.000, map_clean: 85.20, map_observed: 85.20
[test] time: 0.08 min, loss: -999.000, map_clean: 85.84, map_observed: 85.84
Epoch 10/24
[train] time: 0.07 min, loss: -0.123, map_clean: 87.97, map_observed: 77.31
[val] time: 0.02 min, loss: -999.000, map_clean: 85.25, map_observed: 85.25
[test] time: 0.08 min, loss: -999.000, map_clean: 85.85, map_observed: 85.85
Epoch 11/24
[train] time: 0.07 min, loss: -0.123, map_clean: 88.30, map_observed: 77.82
[val] time: 0.02 min, loss: -999.000, map_clean: 85.15, map_observed: 85.15
[test] time: 0.08 min, loss: -999.000, map_clean: 85.78, map_observed: 85.78
Epoch 12/24
[train] time: 0.08 min, loss: -0.123, map_clean: 88.70, map_observed: 77.91
[val] time: 0.02 min, loss: -999.000, map_clean: 85.56, map_observed: 85.56
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 86.12, map_observed: 86.12
Epoch 13/24
[train] time: 0.08 min, loss: -0.123, map_clean: 88.62, map_observed: 78.29
[val] time: 0.02 min, loss: -999.000, map_clean: 85.39, map_observed: 85.39
[test] time: 0.08 min, loss: -999.000, map_clean: 85.84, map_observed: 85.84
Epoch 14/24
[train] time: 0.07 min, loss: -0.123, map_clean: 89.15, map_observed: 78.23
[val] time: 0.02 min, loss: -999.000, map_clean: 85.28, map_observed: 85.28
[test] time: 0.08 min, loss: -999.000, map_clean: 85.76, map_observed: 85.76
Epoch 15/24
[train] time: 0.07 min, loss: -0.123, map_clean: 88.88, map_observed: 78.56
[val] time: 0.02 min, loss: -999.000, map_clean: 85.33, map_observed: 85.33
[test] time: 0.08 min, loss: -999.000, map_clean: 86.01, map_observed: 86.01
Epoch 16/24
[train] time: 0.07 min, loss: -0.123, map_clean: 89.36, map_observed: 79.14
[val] time: 0.02 min, loss: -999.000, map_clean: 85.67, map_observed: 85.67
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 85.91, map_observed: 85.91
Epoch 17/24
[train] time: 0.07 min, loss: -0.123, map_clean: 89.13, map_observed: 79.12
[val] time: 0.02 min, loss: -999.000, map_clean: 85.19, map_observed: 85.19
[test] time: 0.08 min, loss: -999.000, map_clean: 85.70, map_observed: 85.70
Epoch 18/24
[train] time: 0.07 min, loss: -0.123, map_clean: 89.52, map_observed: 79.31
[val] time: 0.02 min, loss: -999.000, map_clean: 85.43, map_observed: 85.43
[test] time: 0.08 min, loss: -999.000, map_clean: 86.18, map_observed: 86.18
Epoch 19/24
[train] time: 0.08 min, loss: -0.123, map_clean: 89.75, map_observed: 80.06
[val] time: 0.02 min, loss: -999.000, map_clean: 85.61, map_observed: 85.61
[test] time: 0.08 min, loss: -999.000, map_clean: 85.75, map_observed: 85.75
Epoch 20/24
[train] time: 0.08 min, loss: -0.123, map_clean: 89.38, map_observed: 79.61
[val] time: 0.02 min, loss: -999.000, map_clean: 85.81, map_observed: 85.81
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 86.17, map_observed: 86.17
Epoch 21/24
[train] time: 0.07 min, loss: -0.124, map_clean: 89.84, map_observed: 80.02
[val] time: 0.02 min, loss: -999.000, map_clean: 85.66, map_observed: 85.66
[test] time: 0.08 min, loss: -999.000, map_clean: 86.14, map_observed: 86.14
Epoch 22/24
[train] time: 0.07 min, loss: -0.124, map_clean: 90.20, map_observed: 80.38
[val] time: 0.02 min, loss: -999.000, map_clean: 85.41, map_observed: 85.41
[test] time: 0.08 min, loss: -999.000, map_clean: 85.61, map_observed: 85.61
Epoch 23/24
[train] time: 0.07 min, loss: -0.123, map_clean: 89.83, map_observed: 80.59
[val] time: 0.02 min, loss: -999.000, map_clean: 85.20, map_observed: 85.20
[test] time: 0.08 min, loss: -999.000, map_clean: 85.90, map_observed: 85.90
Epoch 24/24
[train] time: 0.07 min, loss: -0.124, map_clean: 90.02, map_observed: 80.62
[val] time: 0.02 min, loss: -999.000, map_clean: 85.70, map_observed: 85.70
[test] time: 0.08 min, loss: -999.000, map_clean: 86.10, map_observed: 86.10

*** TRAINING COMPLETE ***
Best epoch: 20
Best epoch validation score: 85.81
Best epoch test score:       86.17

Saving best weights for f to ./results/multi_label_experiment_2022_04_14_20-09-23_pascal/best_model_state_f.pt

Saving best weights for g to ./results/multi_label_experiment_2022_04_14_20-09-23_pascal/best_model_state_g.pt

Saving session data to ./results/multi_label_experiment_2022_04_14_20-09-23_pascal/logs.json

Saving session data to ./results/multi_label_experiment_2022_04_14_20-09-23_pascal/params.json

Reverting model to best weights.
PASCAL EM, uniform 1 , LINEAR FIXED FEATURES
PASCAL EM, uniform 1 , LINEAR FIXED FEATURES
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 4574 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 0.08 min, loss: -0.111, map_clean: 52.36, map_observed: 41.56
[val] time: 0.02 min, loss: -999.000, map_clean: 74.54, map_observed: 74.54
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 75.15, map_observed: 75.15
Epoch 1/24
[train] time: 0.08 min, loss: -0.117, map_clean: 77.02, map_observed: 64.26
[val] time: 0.02 min, loss: -999.000, map_clean: 78.65, map_observed: 78.65
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 79.48, map_observed: 79.48
Epoch 2/24
[train] time: 0.09 min, loss: -0.119, map_clean: 80.85, map_observed: 68.21
[val] time: 0.02 min, loss: -999.000, map_clean: 80.64, map_observed: 80.64
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 81.47, map_observed: 81.47
Epoch 3/24
[train] time: 0.08 min, loss: -0.120, map_clean: 82.50, map_observed: 70.18
[val] time: 0.02 min, loss: -999.000, map_clean: 81.78, map_observed: 81.78
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 82.53, map_observed: 82.53
Epoch 4/24
[train] time: 0.08 min, loss: -0.120, map_clean: 83.59, map_observed: 71.19
[val] time: 0.02 min, loss: -999.000, map_clean: 82.69, map_observed: 82.69
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 83.25, map_observed: 83.25
Epoch 5/24
[train] time: 0.08 min, loss: -0.121, map_clean: 84.37, map_observed: 72.03
[val] time: 0.02 min, loss: -999.000, map_clean: 83.36, map_observed: 83.36
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 83.78, map_observed: 83.78
Epoch 6/24
[train] time: 0.09 min, loss: -0.121, map_clean: 85.07, map_observed: 72.64
[val] time: 0.02 min, loss: -999.000, map_clean: 83.74, map_observed: 83.74
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 84.12, map_observed: 84.12
Epoch 7/24
[train] time: 0.09 min, loss: -0.121, map_clean: 85.55, map_observed: 73.08
[val] time: 0.02 min, loss: -999.000, map_clean: 84.09, map_observed: 84.09
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 84.45, map_observed: 84.45
Epoch 8/24
[train] time: 0.09 min, loss: -0.122, map_clean: 85.92, map_observed: 73.52
[val] time: 0.02 min, loss: -999.000, map_clean: 84.25, map_observed: 84.25
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 84.66, map_observed: 84.66
Epoch 9/24
[train] time: 0.07 min, loss: -0.122, map_clean: 86.38, map_observed: 74.00
[val] time: 0.02 min, loss: -999.000, map_clean: 84.39, map_observed: 84.39
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 84.81, map_observed: 84.81
Epoch 10/24
[train] time: 0.07 min, loss: -0.122, map_clean: 86.58, map_observed: 74.29
[val] time: 0.02 min, loss: -999.000, map_clean: 84.62, map_observed: 84.62
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 85.00, map_observed: 85.00
Epoch 11/24
[train] time: 0.07 min, loss: -0.122, map_clean: 86.88, map_observed: 74.61
[val] time: 0.02 min, loss: -999.000, map_clean: 84.66, map_observed: 84.66
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 85.10, map_observed: 85.10
Epoch 12/24
[train] time: 0.07 min, loss: -0.122, map_clean: 87.06, map_observed: 74.79
[val] time: 0.02 min, loss: -999.000, map_clean: 84.84, map_observed: 84.84
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 85.24, map_observed: 85.24
Epoch 13/24
[train] time: 0.07 min, loss: -0.122, map_clean: 87.24, map_observed: 74.99
[val] time: 0.02 min, loss: -999.000, map_clean: 85.04, map_observed: 85.04
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 85.42, map_observed: 85.42
Epoch 14/24
[train] time: 0.07 min, loss: -0.122, map_clean: 87.46, map_observed: 75.21
[val] time: 0.02 min, loss: -999.000, map_clean: 85.08, map_observed: 85.08
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 85.42, map_observed: 85.42
Epoch 15/24
[train] time: 0.07 min, loss: -0.122, map_clean: 87.58, map_observed: 75.50
[val] time: 0.02 min, loss: -999.000, map_clean: 85.14, map_observed: 85.14
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 85.51, map_observed: 85.51
Epoch 16/24
[train] time: 0.07 min, loss: -0.122, map_clean: 87.65, map_observed: 75.62
[val] time: 0.02 min, loss: -999.000, map_clean: 85.27, map_observed: 85.27
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 85.60, map_observed: 85.60
Epoch 17/24
[train] time: 0.07 min, loss: -0.122, map_clean: 87.95, map_observed: 75.76
[val] time: 0.02 min, loss: -999.000, map_clean: 85.26, map_observed: 85.26
[test] time: 0.08 min, loss: -999.000, map_clean: 85.67, map_observed: 85.67
Epoch 18/24
[train] time: 0.07 min, loss: -0.123, map_clean: 88.05, map_observed: 76.04
[val] time: 0.02 min, loss: -999.000, map_clean: 85.17, map_observed: 85.17
[test] time: 0.08 min, loss: -999.000, map_clean: 85.63, map_observed: 85.63
Epoch 19/24
[train] time: 0.07 min, loss: -0.123, map_clean: 88.25, map_observed: 76.11
[val] time: 0.02 min, loss: -999.000, map_clean: 85.24, map_observed: 85.24
[test] time: 0.08 min, loss: -999.000, map_clean: 85.69, map_observed: 85.69
Epoch 20/24
[train] time: 0.08 min, loss: -0.123, map_clean: 88.29, map_observed: 76.31
[val] time: 0.02 min, loss: -999.000, map_clean: 85.34, map_observed: 85.34
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 85.77, map_observed: 85.77
Epoch 21/24
[train] time: 0.08 min, loss: -0.123, map_clean: 88.41, map_observed: 76.43
[val] time: 0.02 min, loss: -999.000, map_clean: 85.34, map_observed: 85.34
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 85.80, map_observed: 85.80
Epoch 22/24
[train] time: 0.07 min, loss: -0.123, map_clean: 88.52, map_observed: 76.51
[val] time: 0.02 min, loss: -999.000, map_clean: 85.26, map_observed: 85.26
[test] time: 0.08 min, loss: -999.000, map_clean: 85.79, map_observed: 85.79
Epoch 23/24
[train] time: 0.07 min, loss: -0.123, map_clean: 88.53, map_observed: 76.59
[val] time: 0.02 min, loss: -999.000, map_clean: 85.50, map_observed: 85.50
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 85.88, map_observed: 85.88
Epoch 24/24
[train] time: 0.07 min, loss: -0.123, map_clean: 88.64, map_observed: 76.72
[val] time: 0.02 min, loss: -999.000, map_clean: 85.44, map_observed: 85.44
[test] time: 0.08 min, loss: -999.000, map_clean: 85.90, map_observed: 85.90

*** TRAINING COMPLETE ***
Best epoch: 23
Best epoch validation score: 85.50
Best epoch test score:       85.88

Saving best weights for f to ./results/multi_label_experiment_2022_04_14_20-13-56_pascal/best_model_state_f.pt

Saving best weights for g to ./results/multi_label_experiment_2022_04_14_20-13-56_pascal/best_model_state_g.pt

Saving session data to ./results/multi_label_experiment_2022_04_14_20-13-56_pascal/logs.json

Saving session data to ./results/multi_label_experiment_2022_04_14_20-13-56_pascal/params.json

Reverting model to best weights.
PASCAL EM, uniform 1 , LINEAR FIXED FEATURES
PASCAL EM, uniform 1 , LINEAR FIXED FEATURES
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 4574 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 0.08 min, loss: -0.105, map_clean: 14.11, map_observed: 10.28
[val] time: 0.02 min, loss: -999.000, map_clean: 22.51, map_observed: 22.51
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 22.15, map_observed: 22.15
Epoch 1/24
[train] time: 0.08 min, loss: -0.108, map_clean: 34.39, map_observed: 27.32
[val] time: 0.02 min, loss: -999.000, map_clean: 44.75, map_observed: 44.75
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 43.47, map_observed: 43.47
Epoch 2/24
[train] time: 0.09 min, loss: -0.110, map_clean: 51.97, map_observed: 42.14
[val] time: 0.02 min, loss: -999.000, map_clean: 57.70, map_observed: 57.70
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 56.35, map_observed: 56.35
Epoch 3/24
[train] time: 0.08 min, loss: -0.111, map_clean: 61.53, map_observed: 50.11
[val] time: 0.02 min, loss: -999.000, map_clean: 64.28, map_observed: 64.28
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 63.35, map_observed: 63.35
Epoch 4/24
[train] time: 0.08 min, loss: -0.112, map_clean: 67.18, map_observed: 54.82
[val] time: 0.02 min, loss: -999.000, map_clean: 68.27, map_observed: 68.27
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 67.56, map_observed: 67.56
Epoch 5/24
[train] time: 0.08 min, loss: -0.113, map_clean: 70.56, map_observed: 57.81
[val] time: 0.02 min, loss: -999.000, map_clean: 70.92, map_observed: 70.92
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 70.32, map_observed: 70.32
Epoch 6/24
[train] time: 0.09 min, loss: -0.114, map_clean: 72.93, map_observed: 60.07
[val] time: 0.02 min, loss: -999.000, map_clean: 72.68, map_observed: 72.68
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 72.24, map_observed: 72.24
Epoch 7/24
[train] time: 0.08 min, loss: -0.115, map_clean: 74.43, map_observed: 61.47
[val] time: 0.02 min, loss: -999.000, map_clean: 74.04, map_observed: 74.04
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 73.72, map_observed: 73.72
Epoch 8/24
[train] time: 0.09 min, loss: -0.116, map_clean: 75.81, map_observed: 62.88
[val] time: 0.02 min, loss: -999.000, map_clean: 75.12, map_observed: 75.12
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 74.86, map_observed: 74.86
Epoch 9/24
[train] time: 0.07 min, loss: -0.116, map_clean: 76.89, map_observed: 63.84
[val] time: 0.02 min, loss: -999.000, map_clean: 75.91, map_observed: 75.91
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 75.76, map_observed: 75.76
Epoch 10/24
[train] time: 0.08 min, loss: -0.117, map_clean: 77.63, map_observed: 64.72
[val] time: 0.02 min, loss: -999.000, map_clean: 76.54, map_observed: 76.54
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 76.52, map_observed: 76.52
Epoch 11/24
[train] time: 0.07 min, loss: -0.117, map_clean: 78.38, map_observed: 65.38
[val] time: 0.02 min, loss: -999.000, map_clean: 77.15, map_observed: 77.15
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 77.18, map_observed: 77.18
Epoch 12/24
[train] time: 0.08 min, loss: -0.117, map_clean: 78.95, map_observed: 66.02
[val] time: 0.02 min, loss: -999.000, map_clean: 77.70, map_observed: 77.70
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 77.76, map_observed: 77.76
Epoch 13/24
[train] time: 0.08 min, loss: -0.118, map_clean: 79.48, map_observed: 66.53
[val] time: 0.02 min, loss: -999.000, map_clean: 78.15, map_observed: 78.15
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 78.25, map_observed: 78.25
Epoch 14/24
[train] time: 0.08 min, loss: -0.118, map_clean: 79.86, map_observed: 67.01
[val] time: 0.02 min, loss: -999.000, map_clean: 78.47, map_observed: 78.47
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 78.68, map_observed: 78.68
Epoch 15/24
[train] time: 0.07 min, loss: -0.118, map_clean: 80.17, map_observed: 67.22
[val] time: 0.02 min, loss: -999.000, map_clean: 78.95, map_observed: 78.95
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 79.07, map_observed: 79.07
Epoch 16/24
[train] time: 0.07 min, loss: -0.118, map_clean: 80.63, map_observed: 67.87
[val] time: 0.02 min, loss: -999.000, map_clean: 79.29, map_observed: 79.29
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 79.44, map_observed: 79.44
Epoch 17/24
[train] time: 0.07 min, loss: -0.119, map_clean: 81.04, map_observed: 68.19
[val] time: 0.02 min, loss: -999.000, map_clean: 79.57, map_observed: 79.57
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 79.75, map_observed: 79.75
Epoch 18/24
[train] time: 0.07 min, loss: -0.119, map_clean: 81.37, map_observed: 68.63
[val] time: 0.02 min, loss: -999.000, map_clean: 79.82, map_observed: 79.82
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 80.05, map_observed: 80.05
Epoch 19/24
[train] time: 0.07 min, loss: -0.119, map_clean: 81.59, map_observed: 68.80
[val] time: 0.02 min, loss: -999.000, map_clean: 80.08, map_observed: 80.08
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 80.31, map_observed: 80.31
Epoch 20/24
[train] time: 0.08 min, loss: -0.119, map_clean: 81.84, map_observed: 69.10
[val] time: 0.02 min, loss: -999.000, map_clean: 80.28, map_observed: 80.28
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 80.56, map_observed: 80.56
Epoch 21/24
[train] time: 0.08 min, loss: -0.119, map_clean: 82.12, map_observed: 69.52
[val] time: 0.02 min, loss: -999.000, map_clean: 80.50, map_observed: 80.50
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 80.80, map_observed: 80.80
Epoch 22/24
[train] time: 0.08 min, loss: -0.119, map_clean: 82.27, map_observed: 69.53
[val] time: 0.02 min, loss: -999.000, map_clean: 80.68, map_observed: 80.68
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 81.01, map_observed: 81.01
Epoch 23/24
[train] time: 0.08 min, loss: -0.120, map_clean: 82.50, map_observed: 69.73
[val] time: 0.02 min, loss: -999.000, map_clean: 80.93, map_observed: 80.93
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 81.21, map_observed: 81.21
Epoch 24/24
[train] time: 0.08 min, loss: -0.120, map_clean: 82.67, map_observed: 69.97
[val] time: 0.02 min, loss: -999.000, map_clean: 81.13, map_observed: 81.13
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 81.40, map_observed: 81.40

*** TRAINING COMPLETE ***
Best epoch: 24
Best epoch validation score: 81.13
Best epoch test score:       81.40

Saving best weights for f to ./results/multi_label_experiment_2022_04_14_20-18-29_pascal/best_model_state_f.pt

Saving best weights for g to ./results/multi_label_experiment_2022_04_14_20-18-29_pascal/best_model_state_g.pt

Saving session data to ./results/multi_label_experiment_2022_04_14_20-18-29_pascal/logs.json

Saving session data to ./results/multi_label_experiment_2022_04_14_20-18-29_pascal/params.json

Reverting model to best weights.
PASCAL EM, uniform 1 , LINEAR FIXED FEATURES
PASCAL EM, uniform 1 , LINEAR FIXED FEATURES
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 4574 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 0.07 min, loss: -0.028, map_clean: 16.42, map_observed: 12.51
[val] time: 0.02 min, loss: -999.000, map_clean: 25.68, map_observed: 25.68
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 26.27, map_observed: 26.27
Epoch 1/24
[train] time: 0.07 min, loss: -0.030, map_clean: 24.80, map_observed: 20.35
[val] time: 0.02 min, loss: -999.000, map_clean: 26.10, map_observed: 26.10
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 26.82, map_observed: 26.82
Epoch 2/24
[train] time: 0.07 min, loss: -0.030, map_clean: 25.54, map_observed: 21.37
[val] time: 0.02 min, loss: -999.000, map_clean: 26.57, map_observed: 26.57
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 26.77, map_observed: 26.77
Epoch 3/24
[train] time: 0.07 min, loss: -0.030, map_clean: 25.74, map_observed: 21.69
[val] time: 0.02 min, loss: -999.000, map_clean: 25.63, map_observed: 25.63
[test] time: 0.09 min, loss: -999.000, map_clean: 26.30, map_observed: 26.30
Epoch 4/24
[train] time: 0.07 min, loss: -0.030, map_clean: 25.84, map_observed: 21.81
[val] time: 0.02 min, loss: -999.000, map_clean: 25.75, map_observed: 25.75
[test] time: 0.08 min, loss: -999.000, map_clean: 26.44, map_observed: 26.44
Epoch 5/24
[train] time: 0.07 min, loss: -0.031, map_clean: 26.14, map_observed: 22.53
[val] time: 0.02 min, loss: -999.000, map_clean: 26.27, map_observed: 26.27
[test] time: 0.08 min, loss: -999.000, map_clean: 26.85, map_observed: 26.85
Epoch 6/24
[train] time: 0.07 min, loss: -0.031, map_clean: 26.30, map_observed: 21.90
[val] time: 0.02 min, loss: -999.000, map_clean: 25.85, map_observed: 25.85
[test] time: 0.08 min, loss: -999.000, map_clean: 26.49, map_observed: 26.49
Epoch 7/24
[train] time: 0.07 min, loss: -0.031, map_clean: 26.16, map_observed: 22.24
[val] time: 0.02 min, loss: -999.000, map_clean: 25.59, map_observed: 25.59
[test] time: 0.09 min, loss: -999.000, map_clean: 26.47, map_observed: 26.47
Epoch 8/24
[train] time: 0.07 min, loss: -0.030, map_clean: 26.37, map_observed: 22.44
[val] time: 0.02 min, loss: -999.000, map_clean: 26.23, map_observed: 26.23
[test] time: 0.08 min, loss: -999.000, map_clean: 26.74, map_observed: 26.74
Epoch 9/24
[train] time: 0.07 min, loss: -0.031, map_clean: 26.48, map_observed: 22.45
[val] time: 0.02 min, loss: -999.000, map_clean: 25.67, map_observed: 25.67
[test] time: 0.08 min, loss: -999.000, map_clean: 26.44, map_observed: 26.44
Epoch 10/24
[train] time: 0.06 min, loss: -0.031, map_clean: 27.05, map_observed: 23.23
[val] time: 0.02 min, loss: -999.000, map_clean: 25.94, map_observed: 25.94
[test] time: 0.07 min, loss: -999.000, map_clean: 26.39, map_observed: 26.39
Epoch 11/24
[train] time: 0.07 min, loss: -0.031, map_clean: 27.14, map_observed: 23.60
[val] time: 0.02 min, loss: -999.000, map_clean: 26.27, map_observed: 26.27
[test] time: 0.07 min, loss: -999.000, map_clean: 26.61, map_observed: 26.61
Epoch 12/24
[train] time: 0.07 min, loss: -0.023, map_clean: 27.71, map_observed: 24.33
[val] time: 0.02 min, loss: -999.000, map_clean: 26.64, map_observed: 26.64
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 27.09, map_observed: 27.09
Epoch 13/24
[train] time: 0.06 min, loss: -0.020, map_clean: 27.85, map_observed: 23.50
[val] time: 0.02 min, loss: -999.000, map_clean: 25.90, map_observed: 25.90
[test] time: 0.07 min, loss: -999.000, map_clean: 26.85, map_observed: 26.85
Epoch 14/24
[train] time: 0.06 min, loss: -0.020, map_clean: 28.13, map_observed: 24.38
[val] time: 0.02 min, loss: -999.000, map_clean: 26.13, map_observed: 26.13
[test] time: 0.07 min, loss: -999.000, map_clean: 26.93, map_observed: 26.93
Epoch 15/24
[train] time: 0.07 min, loss: -0.020, map_clean: 27.84, map_observed: 24.12
[val] time: 0.02 min, loss: -999.000, map_clean: 26.34, map_observed: 26.34
[test] time: 0.07 min, loss: -999.000, map_clean: 26.95, map_observed: 26.95
Epoch 16/24
[train] time: 0.06 min, loss: -0.020, map_clean: 27.99, map_observed: 24.08
[val] time: 0.02 min, loss: -999.000, map_clean: 25.82, map_observed: 25.82
[test] time: 0.08 min, loss: -999.000, map_clean: 26.22, map_observed: 26.22
Epoch 17/24
[train] time: 0.06 min, loss: -0.020, map_clean: 28.33, map_observed: 24.56
[val] time: 0.02 min, loss: -999.000, map_clean: 26.51, map_observed: 26.51
[test] time: 0.08 min, loss: -999.000, map_clean: 26.98, map_observed: 26.98
Epoch 18/24
[train] time: 0.06 min, loss: -0.020, map_clean: 28.36, map_observed: 24.46
[val] time: 0.02 min, loss: -999.000, map_clean: 26.33, map_observed: 26.33
[test] time: 0.07 min, loss: -999.000, map_clean: 26.98, map_observed: 26.98
Epoch 19/24
[train] time: 0.06 min, loss: -0.020, map_clean: 28.40, map_observed: 24.43
[val] time: 0.02 min, loss: -999.000, map_clean: 25.86, map_observed: 25.86
[test] time: 0.07 min, loss: -999.000, map_clean: 26.10, map_observed: 26.10
Epoch 20/24
[train] time: 0.06 min, loss: -0.020, map_clean: 27.99, map_observed: 24.49
[val] time: 0.02 min, loss: -999.000, map_clean: 25.97, map_observed: 25.97
[test] time: 0.07 min, loss: -999.000, map_clean: 26.67, map_observed: 26.67
Epoch 21/24
[train] time: 0.06 min, loss: -0.020, map_clean: 27.88, map_observed: 24.51
[val] time: 0.02 min, loss: -999.000, map_clean: 25.94, map_observed: 25.94
[test] time: 0.07 min, loss: -999.000, map_clean: 26.47, map_observed: 26.47
Epoch 22/24
[train] time: 0.06 min, loss: -0.020, map_clean: 28.32, map_observed: 24.94
[val] time: 0.02 min, loss: -999.000, map_clean: 26.82, map_observed: 26.82
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 27.16, map_observed: 27.16
Epoch 23/24
[train] time: 0.06 min, loss: -0.018, map_clean: 28.52, map_observed: 25.07
[val] time: 0.02 min, loss: -999.000, map_clean: 26.91, map_observed: 26.91
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 27.02, map_observed: 27.02
Epoch 24/24
[train] time: 0.06 min, loss: -0.000, map_clean: 28.48, map_observed: 24.94
[val] time: 0.02 min, loss: -999.000, map_clean: 25.96, map_observed: 25.96
[test] time: 0.07 min, loss: -999.000, map_clean: 26.54, map_observed: 26.54

*** TRAINING COMPLETE ***
Best epoch: 23
Best epoch validation score: 26.91
Best epoch test score:       27.02

Saving best weights for f to ./results/multi_label_experiment_2022_04_14_20-23-07_pascal/best_model_state_f.pt

Saving best weights for g to ./results/multi_label_experiment_2022_04_14_20-23-07_pascal/best_model_state_g.pt

Saving session data to ./results/multi_label_experiment_2022_04_14_20-23-07_pascal/logs.json

Saving session data to ./results/multi_label_experiment_2022_04_14_20-23-07_pascal/params.json

Reverting model to best weights.
PASCAL EM, uniform 1 , LINEAR FIXED FEATURES
PASCAL EM, uniform 1 , LINEAR FIXED FEATURES
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 4574 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 0.07 min, loss: -0.116, map_clean: 69.59, map_observed: 57.86
[val] time: 0.02 min, loss: -999.000, map_clean: 82.71, map_observed: 82.71
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 83.01, map_observed: 83.01
Epoch 1/24
[train] time: 0.07 min, loss: -0.120, map_clean: 82.67, map_observed: 70.22
[val] time: 0.02 min, loss: -999.000, map_clean: 84.22, map_observed: 84.22
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 84.61, map_observed: 84.61
Epoch 2/24
[train] time: 0.07 min, loss: -0.121, map_clean: 84.81, map_observed: 72.40
[val] time: 0.02 min, loss: -999.000, map_clean: 84.94, map_observed: 84.94
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 85.29, map_observed: 85.29
Epoch 3/24
[train] time: 0.07 min, loss: -0.121, map_clean: 85.66, map_observed: 73.67
[val] time: 0.02 min, loss: -999.000, map_clean: 85.24, map_observed: 85.24
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 85.53, map_observed: 85.53
Epoch 4/24
[train] time: 0.07 min, loss: -0.122, map_clean: 86.54, map_observed: 74.33
[val] time: 0.02 min, loss: -999.000, map_clean: 85.13, map_observed: 85.13
[test] time: 0.09 min, loss: -999.000, map_clean: 85.45, map_observed: 85.45
Epoch 5/24
[train] time: 0.07 min, loss: -0.122, map_clean: 86.89, map_observed: 74.71
[val] time: 0.02 min, loss: -999.000, map_clean: 85.20, map_observed: 85.20
[test] time: 0.09 min, loss: -999.000, map_clean: 85.82, map_observed: 85.82
Epoch 6/24
[train] time: 0.07 min, loss: -0.122, map_clean: 87.43, map_observed: 75.58
[val] time: 0.02 min, loss: -999.000, map_clean: 85.26, map_observed: 85.26
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 85.84, map_observed: 85.84
Epoch 7/24
[train] time: 0.07 min, loss: -0.122, map_clean: 87.55, map_observed: 75.75
[val] time: 0.02 min, loss: -999.000, map_clean: 85.69, map_observed: 85.69
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 85.91, map_observed: 85.91
Epoch 8/24
[train] time: 0.08 min, loss: -0.122, map_clean: 88.16, map_observed: 76.31
[val] time: 0.02 min, loss: -999.000, map_clean: 85.56, map_observed: 85.56
[test] time: 0.08 min, loss: -999.000, map_clean: 86.09, map_observed: 86.09
Epoch 9/24
[train] time: 0.07 min, loss: -0.123, map_clean: 88.13, map_observed: 76.78
[val] time: 0.02 min, loss: -999.000, map_clean: 85.45, map_observed: 85.45
[test] time: 0.07 min, loss: -999.000, map_clean: 85.98, map_observed: 85.98
Epoch 10/24
[train] time: 0.06 min, loss: -0.123, map_clean: 88.61, map_observed: 76.76
[val] time: 0.02 min, loss: -999.000, map_clean: 85.47, map_observed: 85.47
[test] time: 0.08 min, loss: -999.000, map_clean: 86.02, map_observed: 86.02
Epoch 11/24
[train] time: 0.06 min, loss: -0.123, map_clean: 88.43, map_observed: 77.14
[val] time: 0.02 min, loss: -999.000, map_clean: 85.68, map_observed: 85.68
[test] time: 0.07 min, loss: -999.000, map_clean: 86.14, map_observed: 86.14
Epoch 12/24
[train] time: 0.06 min, loss: -0.123, map_clean: 88.77, map_observed: 77.63
[val] time: 0.02 min, loss: -999.000, map_clean: 85.54, map_observed: 85.54
[test] time: 0.07 min, loss: -999.000, map_clean: 85.98, map_observed: 85.98
Epoch 13/24
[train] time: 0.06 min, loss: -0.123, map_clean: 88.77, map_observed: 77.91
[val] time: 0.02 min, loss: -999.000, map_clean: 85.59, map_observed: 85.59
[test] time: 0.07 min, loss: -999.000, map_clean: 86.24, map_observed: 86.24
Epoch 14/24
[train] time: 0.06 min, loss: -0.123, map_clean: 89.22, map_observed: 78.15
[val] time: 0.02 min, loss: -999.000, map_clean: 85.60, map_observed: 85.60
[test] time: 0.07 min, loss: -999.000, map_clean: 86.15, map_observed: 86.15
Epoch 15/24
[train] time: 0.06 min, loss: -0.123, map_clean: 89.38, map_observed: 78.39
[val] time: 0.02 min, loss: -999.000, map_clean: 85.39, map_observed: 85.39
[test] time: 0.07 min, loss: -999.000, map_clean: 86.00, map_observed: 86.00
Epoch 16/24
[train] time: 0.06 min, loss: -0.123, map_clean: 89.19, map_observed: 78.05
[val] time: 0.02 min, loss: -999.000, map_clean: 85.74, map_observed: 85.74
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 86.11, map_observed: 86.11
Epoch 17/24
[train] time: 0.06 min, loss: -0.123, map_clean: 89.62, map_observed: 78.50
[val] time: 0.02 min, loss: -999.000, map_clean: 85.71, map_observed: 85.71
[test] time: 0.07 min, loss: -999.000, map_clean: 86.25, map_observed: 86.25
Epoch 18/24
[train] time: 0.06 min, loss: -0.123, map_clean: 89.47, map_observed: 78.92
[val] time: 0.02 min, loss: -999.000, map_clean: 85.88, map_observed: 85.88
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 86.37, map_observed: 86.37
Epoch 19/24
[train] time: 0.06 min, loss: -0.123, map_clean: 89.95, map_observed: 79.24
[val] time: 0.02 min, loss: -999.000, map_clean: 85.60, map_observed: 85.60
[test] time: 0.07 min, loss: -999.000, map_clean: 86.26, map_observed: 86.26
Epoch 20/24
[train] time: 0.06 min, loss: -0.124, map_clean: 89.95, map_observed: 79.15
[val] time: 0.02 min, loss: -999.000, map_clean: 85.84, map_observed: 85.84
[test] time: 0.07 min, loss: -999.000, map_clean: 86.14, map_observed: 86.14
Epoch 21/24
[train] time: 0.06 min, loss: -0.124, map_clean: 90.04, map_observed: 79.34
[val] time: 0.02 min, loss: -999.000, map_clean: 85.67, map_observed: 85.67
[test] time: 0.07 min, loss: -999.000, map_clean: 86.30, map_observed: 86.30
Epoch 22/24
[train] time: 0.06 min, loss: -0.124, map_clean: 89.92, map_observed: 79.62
[val] time: 0.02 min, loss: -999.000, map_clean: 85.76, map_observed: 85.76
[test] time: 0.07 min, loss: -999.000, map_clean: 86.35, map_observed: 86.35
Epoch 23/24
[train] time: 0.06 min, loss: -0.124, map_clean: 90.33, map_observed: 79.98
[val] time: 0.02 min, loss: -999.000, map_clean: 85.52, map_observed: 85.52
[test] time: 0.07 min, loss: -999.000, map_clean: 86.09, map_observed: 86.09
Epoch 24/24
[train] time: 0.06 min, loss: -0.124, map_clean: 90.01, map_observed: 79.80
[val] time: 0.02 min, loss: -999.000, map_clean: 85.90, map_observed: 85.90
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 86.30, map_observed: 86.30

*** TRAINING COMPLETE ***
Best epoch: 24
Best epoch validation score: 85.90
Best epoch test score:       86.30

Saving best weights for f to ./results/multi_label_experiment_2022_04_14_20-27-09_pascal/best_model_state_f.pt

Saving best weights for g to ./results/multi_label_experiment_2022_04_14_20-27-09_pascal/best_model_state_g.pt

Saving session data to ./results/multi_label_experiment_2022_04_14_20-27-09_pascal/logs.json

Saving session data to ./results/multi_label_experiment_2022_04_14_20-27-09_pascal/params.json

Reverting model to best weights.
PASCAL EM, uniform 1 , LINEAR FIXED FEATURES
PASCAL EM, uniform 1 , LINEAR FIXED FEATURES
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 4574 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 0.07 min, loss: -0.109, map_clean: 43.03, map_observed: 34.09
[val] time: 0.02 min, loss: -999.000, map_clean: 69.71, map_observed: 69.71
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 68.88, map_observed: 68.88
Epoch 1/24
[train] time: 0.07 min, loss: -0.115, map_clean: 72.98, map_observed: 60.63
[val] time: 0.02 min, loss: -999.000, map_clean: 76.65, map_observed: 76.65
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 76.63, map_observed: 76.63
Epoch 2/24
[train] time: 0.07 min, loss: -0.118, map_clean: 78.62, map_observed: 66.50
[val] time: 0.02 min, loss: -999.000, map_clean: 78.98, map_observed: 78.98
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 79.31, map_observed: 79.31
Epoch 3/24
[train] time: 0.07 min, loss: -0.119, map_clean: 80.77, map_observed: 68.47
[val] time: 0.02 min, loss: -999.000, map_clean: 80.38, map_observed: 80.38
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 80.85, map_observed: 80.85
Epoch 4/24
[train] time: 0.07 min, loss: -0.120, map_clean: 82.10, map_observed: 69.55
[val] time: 0.02 min, loss: -999.000, map_clean: 81.36, map_observed: 81.36
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 81.86, map_observed: 81.86
Epoch 5/24
[train] time: 0.08 min, loss: -0.120, map_clean: 83.09, map_observed: 70.77
[val] time: 0.02 min, loss: -999.000, map_clean: 82.01, map_observed: 82.01
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 82.53, map_observed: 82.53
Epoch 6/24
[train] time: 0.08 min, loss: -0.120, map_clean: 83.77, map_observed: 71.29
[val] time: 0.02 min, loss: -999.000, map_clean: 82.57, map_observed: 82.57
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 83.05, map_observed: 83.05
Epoch 7/24
[train] time: 0.07 min, loss: -0.121, map_clean: 84.32, map_observed: 72.10
[val] time: 0.02 min, loss: -999.000, map_clean: 83.03, map_observed: 83.03
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 83.49, map_observed: 83.49
Epoch 8/24
[train] time: 0.07 min, loss: -0.121, map_clean: 84.77, map_observed: 72.53
[val] time: 0.02 min, loss: -999.000, map_clean: 83.38, map_observed: 83.38
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 83.82, map_observed: 83.82
Epoch 9/24
[train] time: 0.07 min, loss: -0.121, map_clean: 85.25, map_observed: 72.94
[val] time: 0.02 min, loss: -999.000, map_clean: 83.69, map_observed: 83.69
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 84.13, map_observed: 84.13
Epoch 10/24
[train] time: 0.06 min, loss: -0.121, map_clean: 85.61, map_observed: 73.37
[val] time: 0.02 min, loss: -999.000, map_clean: 83.87, map_observed: 83.87
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 84.31, map_observed: 84.31
Epoch 11/24
[train] time: 0.06 min, loss: -0.121, map_clean: 86.05, map_observed: 73.66
[val] time: 0.02 min, loss: -999.000, map_clean: 84.05, map_observed: 84.05
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 84.48, map_observed: 84.48
Epoch 12/24
[train] time: 0.07 min, loss: -0.122, map_clean: 86.18, map_observed: 73.95
[val] time: 0.02 min, loss: -999.000, map_clean: 84.31, map_observed: 84.31
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 84.68, map_observed: 84.68
Epoch 13/24
[train] time: 0.06 min, loss: -0.122, map_clean: 86.36, map_observed: 74.21
[val] time: 0.02 min, loss: -999.000, map_clean: 84.41, map_observed: 84.41
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 84.81, map_observed: 84.81
Epoch 14/24
[train] time: 0.06 min, loss: -0.122, map_clean: 86.63, map_observed: 74.48
[val] time: 0.02 min, loss: -999.000, map_clean: 84.49, map_observed: 84.49
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 84.90, map_observed: 84.90
Epoch 15/24
[train] time: 0.06 min, loss: -0.122, map_clean: 86.87, map_observed: 74.56
[val] time: 0.02 min, loss: -999.000, map_clean: 84.65, map_observed: 84.65
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 85.04, map_observed: 85.04
Epoch 16/24
[train] time: 0.06 min, loss: -0.122, map_clean: 87.07, map_observed: 74.81
[val] time: 0.02 min, loss: -999.000, map_clean: 84.73, map_observed: 84.73
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 85.15, map_observed: 85.15
Epoch 17/24
[train] time: 0.06 min, loss: -0.122, map_clean: 87.17, map_observed: 74.99
[val] time: 0.02 min, loss: -999.000, map_clean: 84.83, map_observed: 84.83
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 85.21, map_observed: 85.21
Epoch 18/24
[train] time: 0.06 min, loss: -0.122, map_clean: 87.34, map_observed: 75.08
[val] time: 0.02 min, loss: -999.000, map_clean: 84.87, map_observed: 84.87
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 85.28, map_observed: 85.28
Epoch 19/24
[train] time: 0.06 min, loss: -0.122, map_clean: 87.29, map_observed: 75.15
[val] time: 0.02 min, loss: -999.000, map_clean: 84.92, map_observed: 84.92
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 85.34, map_observed: 85.34
Epoch 20/24
[train] time: 0.06 min, loss: -0.122, map_clean: 87.64, map_observed: 75.50
[val] time: 0.02 min, loss: -999.000, map_clean: 84.91, map_observed: 84.91
[test] time: 0.07 min, loss: -999.000, map_clean: 85.41, map_observed: 85.41
Epoch 21/24
[train] time: 0.06 min, loss: -0.122, map_clean: 87.70, map_observed: 75.52
[val] time: 0.02 min, loss: -999.000, map_clean: 85.02, map_observed: 85.02
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 85.47, map_observed: 85.47
Epoch 22/24
[train] time: 0.06 min, loss: -0.122, map_clean: 87.79, map_observed: 75.54
[val] time: 0.02 min, loss: -999.000, map_clean: 85.11, map_observed: 85.11
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 85.54, map_observed: 85.54
Epoch 23/24
[train] time: 0.06 min, loss: -0.122, map_clean: 87.89, map_observed: 75.74
[val] time: 0.02 min, loss: -999.000, map_clean: 85.10, map_observed: 85.10
[test] time: 0.07 min, loss: -999.000, map_clean: 85.55, map_observed: 85.55
Epoch 24/24
[train] time: 0.06 min, loss: -0.122, map_clean: 88.07, map_observed: 75.97
[val] time: 0.02 min, loss: -999.000, map_clean: 85.23, map_observed: 85.23
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 85.64, map_observed: 85.64

*** TRAINING COMPLETE ***
Best epoch: 24
Best epoch validation score: 85.23
Best epoch test score:       85.64

Saving best weights for f to ./results/multi_label_experiment_2022_04_14_20-31-13_pascal/best_model_state_f.pt

Saving best weights for g to ./results/multi_label_experiment_2022_04_14_20-31-13_pascal/best_model_state_g.pt

Saving session data to ./results/multi_label_experiment_2022_04_14_20-31-13_pascal/logs.json

Saving session data to ./results/multi_label_experiment_2022_04_14_20-31-13_pascal/params.json

Reverting model to best weights.
PASCAL EM, uniform 1 , LINEAR FIXED FEATURES
PASCAL EM, uniform 1 , LINEAR FIXED FEATURES
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 4574 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 0.07 min, loss: -0.103, map_clean: 10.65, map_observed: 7.75
[val] time: 0.02 min, loss: -999.000, map_clean: 15.44, map_observed: 15.44
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 14.01, map_observed: 14.01
Epoch 1/24
[train] time: 0.08 min, loss: -0.106, map_clean: 21.31, map_observed: 16.65
[val] time: 0.02 min, loss: -999.000, map_clean: 30.05, map_observed: 30.05
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 27.26, map_observed: 27.26
Epoch 2/24
[train] time: 0.07 min, loss: -0.108, map_clean: 35.72, map_observed: 28.63
[val] time: 0.02 min, loss: -999.000, map_clean: 43.78, map_observed: 43.78
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 40.94, map_observed: 40.94
Epoch 3/24
[train] time: 0.07 min, loss: -0.109, map_clean: 47.76, map_observed: 39.02
[val] time: 0.02 min, loss: -999.000, map_clean: 53.28, map_observed: 53.28
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 51.09, map_observed: 51.09
Epoch 4/24
[train] time: 0.07 min, loss: -0.110, map_clean: 56.15, map_observed: 46.23
[val] time: 0.02 min, loss: -999.000, map_clean: 59.79, map_observed: 59.79
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 58.11, map_observed: 58.11
Epoch 5/24
[train] time: 0.07 min, loss: -0.111, map_clean: 62.16, map_observed: 51.44
[val] time: 0.02 min, loss: -999.000, map_clean: 63.93, map_observed: 63.93
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 62.59, map_observed: 62.59
Epoch 6/24
[train] time: 0.07 min, loss: -0.112, map_clean: 66.14, map_observed: 54.74
[val] time: 0.02 min, loss: -999.000, map_clean: 66.96, map_observed: 66.96
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 65.89, map_observed: 65.89
Epoch 7/24
[train] time: 0.07 min, loss: -0.113, map_clean: 68.86, map_observed: 57.30
[val] time: 0.02 min, loss: -999.000, map_clean: 69.09, map_observed: 69.09
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 68.31, map_observed: 68.31
Epoch 8/24
[train] time: 0.07 min, loss: -0.113, map_clean: 70.92, map_observed: 58.92
[val] time: 0.02 min, loss: -999.000, map_clean: 70.76, map_observed: 70.76
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 70.12, map_observed: 70.12
Epoch 9/24
[train] time: 0.07 min, loss: -0.114, map_clean: 72.51, map_observed: 60.49
[val] time: 0.02 min, loss: -999.000, map_clean: 72.03, map_observed: 72.03
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 71.47, map_observed: 71.47
Epoch 10/24
[train] time: 0.07 min, loss: -0.115, map_clean: 73.89, map_observed: 61.72
[val] time: 0.02 min, loss: -999.000, map_clean: 73.09, map_observed: 73.09
*** new best weights ***
[test] time: 0.09 min, loss: -999.000, map_clean: 72.63, map_observed: 72.63
Epoch 11/24
[train] time: 0.07 min, loss: -0.115, map_clean: 74.85, map_observed: 62.58
[val] time: 0.02 min, loss: -999.000, map_clean: 73.93, map_observed: 73.93
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 73.53, map_observed: 73.53
Epoch 12/24
[train] time: 0.06 min, loss: -0.115, map_clean: 75.62, map_observed: 63.30
[val] time: 0.02 min, loss: -999.000, map_clean: 74.69, map_observed: 74.69
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 74.34, map_observed: 74.34
Epoch 13/24
[train] time: 0.06 min, loss: -0.116, map_clean: 76.37, map_observed: 63.99
[val] time: 0.02 min, loss: -999.000, map_clean: 75.28, map_observed: 75.28
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 75.01, map_observed: 75.01
Epoch 14/24
[train] time: 0.06 min, loss: -0.116, map_clean: 77.06, map_observed: 64.66
[val] time: 0.02 min, loss: -999.000, map_clean: 75.90, map_observed: 75.90
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 75.64, map_observed: 75.64
Epoch 15/24
[train] time: 0.06 min, loss: -0.116, map_clean: 77.61, map_observed: 65.19
[val] time: 0.02 min, loss: -999.000, map_clean: 76.38, map_observed: 76.38
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 76.17, map_observed: 76.17
Epoch 16/24
[train] time: 0.06 min, loss: -0.117, map_clean: 78.18, map_observed: 65.83
[val] time: 0.02 min, loss: -999.000, map_clean: 76.78, map_observed: 76.78
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 76.63, map_observed: 76.63
Epoch 17/24
[train] time: 0.06 min, loss: -0.117, map_clean: 78.59, map_observed: 66.19
[val] time: 0.02 min, loss: -999.000, map_clean: 77.16, map_observed: 77.16
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 77.06, map_observed: 77.06
Epoch 18/24
[train] time: 0.06 min, loss: -0.117, map_clean: 78.91, map_observed: 66.50
[val] time: 0.02 min, loss: -999.000, map_clean: 77.48, map_observed: 77.48
*** new best weights ***
[test] time: 0.07 min, loss: -999.000, map_clean: 77.43, map_observed: 77.43
Epoch 19/24
[train] time: 0.06 min, loss: -0.117, map_clean: 79.30, map_observed: 66.90
[val] time: 0.02 min, loss: -999.000, map_clean: 77.79, map_observed: 77.79
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 77.80, map_observed: 77.80
Epoch 20/24
[train] time: 0.07 min, loss: -0.118, map_clean: 79.73, map_observed: 67.25
[val] time: 0.02 min, loss: -999.000, map_clean: 78.11, map_observed: 78.11
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 78.13, map_observed: 78.13
Epoch 21/24
[train] time: 0.07 min, loss: -0.118, map_clean: 79.90, map_observed: 67.45
[val] time: 0.02 min, loss: -999.000, map_clean: 78.39, map_observed: 78.39
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 78.41, map_observed: 78.41
Epoch 22/24
[train] time: 0.07 min, loss: -0.118, map_clean: 80.22, map_observed: 67.79
[val] time: 0.02 min, loss: -999.000, map_clean: 78.63, map_observed: 78.63
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 78.69, map_observed: 78.69
Epoch 23/24
[train] time: 0.07 min, loss: -0.118, map_clean: 80.52, map_observed: 68.05
[val] time: 0.02 min, loss: -999.000, map_clean: 78.87, map_observed: 78.87
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 78.96, map_observed: 78.96
Epoch 24/24
[train] time: 0.06 min, loss: -0.118, map_clean: 80.71, map_observed: 68.29
[val] time: 0.02 min, loss: -999.000, map_clean: 79.11, map_observed: 79.11
*** new best weights ***
[test] time: 0.08 min, loss: -999.000, map_clean: 79.20, map_observed: 79.20

*** TRAINING COMPLETE ***
Best epoch: 24
Best epoch validation score: 79.11
Best epoch test score:       79.20

Saving best weights for f to ./results/multi_label_experiment_2022_04_14_20-35-17_pascal/best_model_state_f.pt

Saving best weights for g to ./results/multi_label_experiment_2022_04_14_20-35-17_pascal/best_model_state_g.pt

Saving session data to ./results/multi_label_experiment_2022_04_14_20-35-17_pascal/logs.json

Saving session data to ./results/multi_label_experiment_2022_04_14_20-35-17_pascal/params.json

Reverting model to best weights.
best run: ./results/multi_label_experiment_2022_04_14_20-27-09_pascal
- learning rate: 0.001
- batch size:    16
- val score:     85.89625510932449
- test score:    86.30264841620559
