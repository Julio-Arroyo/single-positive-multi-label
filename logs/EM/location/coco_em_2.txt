coco em, location 2 , LINEAR FIXED FEATURES
coco em, location 2 , LINEAR FIXED FEATURES
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 65665 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.16 min, loss: 0.012, map_clean: 3.91, map_observed: 1.44
[val] time: 0.23 min, loss: -999.000, map_clean: 5.17, map_observed: 5.17
*** new best weights ***
[test] time: 0.58 min, loss: -999.000, map_clean: 5.08, map_observed: 5.08
Epoch 1/24
[train] time: 1.18 min, loss: 0.027, map_clean: 4.68, map_observed: 2.20
[val] time: 0.24 min, loss: -999.000, map_clean: 4.80, map_observed: 4.80
[test] time: 0.58 min, loss: -999.000, map_clean: 4.75, map_observed: 4.75
Epoch 2/24
[train] time: 1.19 min, loss: 0.037, map_clean: 4.78, map_observed: 2.31
[val] time: 0.24 min, loss: -999.000, map_clean: 4.93, map_observed: 4.93
[test] time: 0.57 min, loss: -999.000, map_clean: 4.87, map_observed: 4.87
Epoch 3/24
[train] time: 1.19 min, loss: 0.040, map_clean: 3.71, map_observed: 1.28
[val] time: 0.23 min, loss: -999.000, map_clean: 3.68, map_observed: 3.68
[test] time: 0.58 min, loss: -999.000, map_clean: 3.64, map_observed: 3.64
Epoch 4/24
[train] time: 1.19 min, loss: 0.040, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.67, map_observed: 3.67
[test] time: 0.58 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 5/24
[train] time: 1.22 min, loss: 0.042, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.67, map_observed: 3.67
[test] time: 0.58 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 6/24
[train] time: 1.26 min, loss: 0.044, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.67, map_observed: 3.67
[test] time: 0.58 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 7/24
[train] time: 1.32 min, loss: 0.045, map_clean: 3.68, map_observed: 1.27
[val] time: 0.25 min, loss: -999.000, map_clean: 3.67, map_observed: 3.67
[test] time: 0.59 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 8/24
[train] time: 1.48 min, loss: 0.046, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.67, map_observed: 3.67
[test] time: 0.58 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 9/24
[train] time: 1.55 min, loss: 0.046, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
[test] time: 0.58 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 10/24
[train] time: 1.57 min, loss: 0.046, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
[test] time: 0.59 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 11/24
[train] time: 1.57 min, loss: 0.046, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
[test] time: 0.59 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 12/24
[train] time: 1.59 min, loss: 0.046, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
[test] time: 0.59 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 13/24
[train] time: 1.60 min, loss: 0.046, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
[test] time: 0.59 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 14/24
[train] time: 1.61 min, loss: 0.046, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
[test] time: 0.58 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 15/24
[train] time: 1.62 min, loss: 0.046, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
[test] time: 0.59 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 16/24
[train] time: 1.62 min, loss: 0.046, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
[test] time: 0.59 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 17/24
[train] time: 1.62 min, loss: 0.046, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
[test] time: 0.59 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 18/24
[train] time: 1.62 min, loss: 0.046, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
[test] time: 0.59 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 19/24
[train] time: 1.62 min, loss: 0.046, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
[test] time: 0.59 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 20/24
[train] time: 1.62 min, loss: 0.046, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
[test] time: 0.59 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 21/24
[train] time: 1.62 min, loss: 0.046, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
[test] time: 0.58 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 22/24
[train] time: 1.61 min, loss: 0.046, map_clean: 3.68, map_observed: 1.27
[val] time: 0.25 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
[test] time: 0.59 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 23/24
[train] time: 1.62 min, loss: 0.046, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
[test] time: 0.59 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63
Epoch 24/24
[train] time: 1.62 min, loss: 0.046, map_clean: 3.68, map_observed: 1.27
[val] time: 0.24 min, loss: -999.000, map_clean: 3.66, map_observed: 3.66
[test] time: 0.58 min, loss: -999.000, map_clean: 3.63, map_observed: 3.63

*** TRAINING COMPLETE ***
Best epoch: 0
Best epoch validation score: 5.17
Best epoch test score:       5.08

Saving best weights for f to ./results/multi_label_experiment_2022_04_19_16-44-37_coco/best_model_state_f.pt

Saving best weights for g to ./results/multi_label_experiment_2022_04_19_16-44-37_coco/best_model_state_g.pt

Saving session data to ./results/multi_label_experiment_2022_04_19_16-44-37_coco/logs.json

Saving session data to ./results/multi_label_experiment_2022_04_19_16-44-37_coco/params.json

Reverting model to best weights.
coco em, location 2 , LINEAR FIXED FEATURES
coco em, location 2 , LINEAR FIXED FEATURES
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 65665 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.18 min, loss: -0.131, map_clean: 44.40, map_observed: 29.45
[val] time: 0.25 min, loss: -999.000, map_clean: 57.86, map_observed: 57.86
*** new best weights ***
[test] time: 0.60 min, loss: -999.000, map_clean: 57.41, map_observed: 57.41
Epoch 1/24
[train] time: 1.17 min, loss: -0.131, map_clean: 48.86, map_observed: 33.22
[val] time: 0.25 min, loss: -999.000, map_clean: 58.72, map_observed: 58.72
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 58.44, map_observed: 58.44
Epoch 2/24
[train] time: 1.19 min, loss: -0.131, map_clean: 49.92, map_observed: 34.55
[val] time: 0.25 min, loss: -999.000, map_clean: 59.54, map_observed: 59.54
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 58.87, map_observed: 58.87
Epoch 3/24
[train] time: 1.18 min, loss: -0.131, map_clean: 50.73, map_observed: 35.26
[val] time: 0.25 min, loss: -999.000, map_clean: 59.74, map_observed: 59.74
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 59.21, map_observed: 59.21
Epoch 4/24
[train] time: 1.19 min, loss: -0.132, map_clean: 51.19, map_observed: 35.79
[val] time: 0.25 min, loss: -999.000, map_clean: 60.16, map_observed: 60.16
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 59.27, map_observed: 59.27
Epoch 5/24
[train] time: 1.18 min, loss: -0.132, map_clean: 51.72, map_observed: 36.24
[val] time: 0.25 min, loss: -999.000, map_clean: 59.54, map_observed: 59.54
[test] time: 0.61 min, loss: -999.000, map_clean: 58.88, map_observed: 58.88
Epoch 6/24
[train] time: 1.18 min, loss: -0.132, map_clean: 51.74, map_observed: 36.50
[val] time: 0.25 min, loss: -999.000, map_clean: 60.23, map_observed: 60.23
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 59.59, map_observed: 59.59
Epoch 7/24
[train] time: 1.20 min, loss: -0.132, map_clean: 52.10, map_observed: 36.83
[val] time: 0.25 min, loss: -999.000, map_clean: 60.26, map_observed: 60.26
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 59.40, map_observed: 59.40
Epoch 8/24
[train] time: 1.18 min, loss: -0.132, map_clean: 52.24, map_observed: 37.10
[val] time: 0.26 min, loss: -999.000, map_clean: 60.13, map_observed: 60.13
[test] time: 0.60 min, loss: -999.000, map_clean: 59.32, map_observed: 59.32
Epoch 9/24
[train] time: 1.18 min, loss: -0.132, map_clean: 52.55, map_observed: 37.17
[val] time: 0.25 min, loss: -999.000, map_clean: 60.49, map_observed: 60.49
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 59.54, map_observed: 59.54
Epoch 10/24
[train] time: 1.20 min, loss: -0.132, map_clean: 52.22, map_observed: 37.14
[val] time: 0.25 min, loss: -999.000, map_clean: 60.02, map_observed: 60.02
[test] time: 0.61 min, loss: -999.000, map_clean: 59.39, map_observed: 59.39
Epoch 11/24
[train] time: 1.19 min, loss: -0.132, map_clean: 52.38, map_observed: 37.60
[val] time: 0.25 min, loss: -999.000, map_clean: 59.52, map_observed: 59.52
[test] time: 0.61 min, loss: -999.000, map_clean: 58.87, map_observed: 58.87
Epoch 12/24
[train] time: 1.20 min, loss: -0.132, map_clean: 52.59, map_observed: 37.47
[val] time: 0.26 min, loss: -999.000, map_clean: 60.28, map_observed: 60.28
[test] time: 0.61 min, loss: -999.000, map_clean: 59.69, map_observed: 59.69
Epoch 13/24
[train] time: 1.18 min, loss: -0.132, map_clean: 52.58, map_observed: 37.62
[val] time: 0.25 min, loss: -999.000, map_clean: 59.65, map_observed: 59.65
[test] time: 0.62 min, loss: -999.000, map_clean: 58.79, map_observed: 58.79
Epoch 14/24
[train] time: 1.19 min, loss: -0.132, map_clean: 52.63, map_observed: 37.67
[val] time: 0.25 min, loss: -999.000, map_clean: 60.75, map_observed: 60.75
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 60.02, map_observed: 60.02
Epoch 15/24
[train] time: 1.19 min, loss: -0.132, map_clean: 52.77, map_observed: 37.75
[val] time: 0.25 min, loss: -999.000, map_clean: 60.16, map_observed: 60.16
[test] time: 0.61 min, loss: -999.000, map_clean: 59.25, map_observed: 59.25
Epoch 16/24
[train] time: 1.19 min, loss: -0.132, map_clean: 52.66, map_observed: 37.91
[val] time: 0.26 min, loss: -999.000, map_clean: 59.19, map_observed: 59.19
[test] time: 0.62 min, loss: -999.000, map_clean: 58.53, map_observed: 58.53
Epoch 17/24
[train] time: 1.19 min, loss: -0.132, map_clean: 52.77, map_observed: 37.86
[val] time: 0.25 min, loss: -999.000, map_clean: 59.79, map_observed: 59.79
[test] time: 0.61 min, loss: -999.000, map_clean: 59.31, map_observed: 59.31
Epoch 18/24
[train] time: 1.20 min, loss: -0.132, map_clean: 52.82, map_observed: 38.07
[val] time: 0.25 min, loss: -999.000, map_clean: 59.77, map_observed: 59.77
[test] time: 0.61 min, loss: -999.000, map_clean: 59.11, map_observed: 59.11
Epoch 19/24
[train] time: 1.18 min, loss: -0.132, map_clean: 52.85, map_observed: 38.07
[val] time: 0.26 min, loss: -999.000, map_clean: 60.31, map_observed: 60.31
[test] time: 0.61 min, loss: -999.000, map_clean: 59.37, map_observed: 59.37
Epoch 20/24
[train] time: 1.19 min, loss: -0.132, map_clean: 52.80, map_observed: 37.98
[val] time: 0.25 min, loss: -999.000, map_clean: 60.19, map_observed: 60.19
[test] time: 0.61 min, loss: -999.000, map_clean: 59.54, map_observed: 59.54
Epoch 21/24
[train] time: 1.19 min, loss: -0.132, map_clean: 52.82, map_observed: 38.01
[val] time: 0.25 min, loss: -999.000, map_clean: 59.97, map_observed: 59.97
[test] time: 0.61 min, loss: -999.000, map_clean: 59.32, map_observed: 59.32
Epoch 22/24
[train] time: 1.18 min, loss: -0.132, map_clean: 52.92, map_observed: 38.11
[val] time: 0.25 min, loss: -999.000, map_clean: 59.69, map_observed: 59.69
[test] time: 0.61 min, loss: -999.000, map_clean: 59.06, map_observed: 59.06
Epoch 23/24
[train] time: 1.19 min, loss: -0.132, map_clean: 52.80, map_observed: 38.09
[val] time: 0.25 min, loss: -999.000, map_clean: 60.41, map_observed: 60.41
[test] time: 0.62 min, loss: -999.000, map_clean: 59.89, map_observed: 59.89
Epoch 24/24
[train] time: 1.19 min, loss: -0.132, map_clean: 52.87, map_observed: 38.04
[val] time: 0.25 min, loss: -999.000, map_clean: 59.72, map_observed: 59.72
[test] time: 0.61 min, loss: -999.000, map_clean: 59.13, map_observed: 59.13

*** TRAINING COMPLETE ***
Best epoch: 14
Best epoch validation score: 60.75
Best epoch test score:       60.02

Saving best weights for f to ./results/multi_label_experiment_2022_04_19_17-42-40_coco/best_model_state_f.pt

Saving best weights for g to ./results/multi_label_experiment_2022_04_19_17-42-40_coco/best_model_state_g.pt

Saving session data to ./results/multi_label_experiment_2022_04_19_17-42-40_coco/logs.json

Saving session data to ./results/multi_label_experiment_2022_04_19_17-42-40_coco/params.json

Reverting model to best weights.
coco em, location 2 , LINEAR FIXED FEATURES
coco em, location 2 , LINEAR FIXED FEATURES
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 65665 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.19 min, loss: -0.132, map_clean: 50.20, map_observed: 30.57
[val] time: 0.26 min, loss: -999.000, map_clean: 59.43, map_observed: 59.43
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 58.90, map_observed: 58.90
Epoch 1/24
[train] time: 1.19 min, loss: -0.132, map_clean: 57.75, map_observed: 36.25
[val] time: 0.25 min, loss: -999.000, map_clean: 61.00, map_observed: 61.00
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 60.40, map_observed: 60.40
Epoch 2/24
[train] time: 1.19 min, loss: -0.132, map_clean: 58.96, map_observed: 37.30
[val] time: 0.25 min, loss: -999.000, map_clean: 61.30, map_observed: 61.30
*** new best weights ***
[test] time: 0.60 min, loss: -999.000, map_clean: 60.80, map_observed: 60.80
Epoch 3/24
[train] time: 1.18 min, loss: -0.133, map_clean: 59.79, map_observed: 38.00
[val] time: 0.26 min, loss: -999.000, map_clean: 62.12, map_observed: 62.12
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 61.52, map_observed: 61.52
Epoch 4/24
[train] time: 1.18 min, loss: -0.133, map_clean: 60.29, map_observed: 38.51
[val] time: 0.25 min, loss: -999.000, map_clean: 62.60, map_observed: 62.60
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 62.01, map_observed: 62.01
Epoch 5/24
[train] time: 1.19 min, loss: -0.133, map_clean: 60.77, map_observed: 38.83
[val] time: 0.25 min, loss: -999.000, map_clean: 62.84, map_observed: 62.84
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 62.35, map_observed: 62.35
Epoch 6/24
[train] time: 1.20 min, loss: -0.133, map_clean: 61.15, map_observed: 39.27
[val] time: 0.25 min, loss: -999.000, map_clean: 62.91, map_observed: 62.91
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 62.38, map_observed: 62.38
Epoch 7/24
[train] time: 1.18 min, loss: -0.133, map_clean: 61.42, map_observed: 39.62
[val] time: 0.25 min, loss: -999.000, map_clean: 63.01, map_observed: 63.01
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 62.47, map_observed: 62.47
Epoch 8/24
[train] time: 1.19 min, loss: -0.133, map_clean: 61.66, map_observed: 39.87
[val] time: 0.25 min, loss: -999.000, map_clean: 63.30, map_observed: 63.30
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 62.74, map_observed: 62.74
Epoch 9/24
[train] time: 1.18 min, loss: -0.133, map_clean: 61.89, map_observed: 40.11
[val] time: 0.26 min, loss: -999.000, map_clean: 63.28, map_observed: 63.28
[test] time: 0.61 min, loss: -999.000, map_clean: 62.87, map_observed: 62.87
Epoch 10/24
[train] time: 1.20 min, loss: -0.133, map_clean: 62.03, map_observed: 40.34
[val] time: 0.25 min, loss: -999.000, map_clean: 63.56, map_observed: 63.56
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 63.04, map_observed: 63.04
Epoch 11/24
[train] time: 1.20 min, loss: -0.133, map_clean: 62.28, map_observed: 40.50
[val] time: 0.25 min, loss: -999.000, map_clean: 63.55, map_observed: 63.55
[test] time: 0.61 min, loss: -999.000, map_clean: 62.96, map_observed: 62.96
Epoch 12/24
[train] time: 1.20 min, loss: -0.133, map_clean: 62.40, map_observed: 40.66
[val] time: 0.25 min, loss: -999.000, map_clean: 63.49, map_observed: 63.49
[test] time: 0.62 min, loss: -999.000, map_clean: 63.08, map_observed: 63.08
Epoch 13/24
[train] time: 1.19 min, loss: -0.133, map_clean: 62.49, map_observed: 40.94
[val] time: 0.25 min, loss: -999.000, map_clean: 63.68, map_observed: 63.68
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 63.18, map_observed: 63.18
Epoch 14/24
[train] time: 1.19 min, loss: -0.133, map_clean: 62.71, map_observed: 41.13
[val] time: 0.25 min, loss: -999.000, map_clean: 63.76, map_observed: 63.76
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 63.27, map_observed: 63.27
Epoch 15/24
[train] time: 1.21 min, loss: -0.133, map_clean: 62.79, map_observed: 41.18
[val] time: 0.25 min, loss: -999.000, map_clean: 63.81, map_observed: 63.81
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 63.24, map_observed: 63.24
Epoch 16/24
[train] time: 1.20 min, loss: -0.133, map_clean: 62.89, map_observed: 41.40
[val] time: 0.25 min, loss: -999.000, map_clean: 63.89, map_observed: 63.89
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 63.36, map_observed: 63.36
Epoch 17/24
[train] time: 1.21 min, loss: -0.133, map_clean: 62.99, map_observed: 41.53
[val] time: 0.25 min, loss: -999.000, map_clean: 64.13, map_observed: 64.13
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 63.63, map_observed: 63.63
Epoch 18/24
[train] time: 1.19 min, loss: -0.133, map_clean: 63.10, map_observed: 41.85
[val] time: 0.25 min, loss: -999.000, map_clean: 63.82, map_observed: 63.82
[test] time: 0.62 min, loss: -999.000, map_clean: 63.22, map_observed: 63.22
Epoch 19/24
[train] time: 1.19 min, loss: -0.133, map_clean: 63.25, map_observed: 41.88
[val] time: 0.26 min, loss: -999.000, map_clean: 64.00, map_observed: 64.00
[test] time: 0.62 min, loss: -999.000, map_clean: 63.41, map_observed: 63.41
Epoch 20/24
[train] time: 1.19 min, loss: -0.133, map_clean: 63.29, map_observed: 42.03
[val] time: 0.25 min, loss: -999.000, map_clean: 63.91, map_observed: 63.91
[test] time: 0.62 min, loss: -999.000, map_clean: 63.29, map_observed: 63.29
Epoch 21/24
[train] time: 1.20 min, loss: -0.133, map_clean: 63.28, map_observed: 42.04
[val] time: 0.25 min, loss: -999.000, map_clean: 63.94, map_observed: 63.94
[test] time: 0.62 min, loss: -999.000, map_clean: 63.28, map_observed: 63.28
Epoch 22/24
[train] time: 1.20 min, loss: -0.133, map_clean: 63.39, map_observed: 42.31
[val] time: 0.26 min, loss: -999.000, map_clean: 64.25, map_observed: 64.25
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 63.56, map_observed: 63.56
Epoch 23/24
[train] time: 1.19 min, loss: -0.133, map_clean: 63.53, map_observed: 42.22
[val] time: 0.25 min, loss: -999.000, map_clean: 63.98, map_observed: 63.98
[test] time: 0.62 min, loss: -999.000, map_clean: 63.37, map_observed: 63.37
Epoch 24/24
[train] time: 1.21 min, loss: -0.133, map_clean: 63.58, map_observed: 42.41
[val] time: 0.26 min, loss: -999.000, map_clean: 64.09, map_observed: 64.09
[test] time: 0.62 min, loss: -999.000, map_clean: 63.44, map_observed: 63.44

*** TRAINING COMPLETE ***
Best epoch: 22
Best epoch validation score: 64.25
Best epoch test score:       63.56

Saving best weights for f to ./results/multi_label_experiment_2022_04_19_18-34-24_coco/best_model_state_f.pt

Saving best weights for g to ./results/multi_label_experiment_2022_04_19_18-34-24_coco/best_model_state_g.pt

Saving session data to ./results/multi_label_experiment_2022_04_19_18-34-24_coco/logs.json

Saving session data to ./results/multi_label_experiment_2022_04_19_18-34-24_coco/params.json

Reverting model to best weights.
coco em, location 2 , LINEAR FIXED FEATURES
coco em, location 2 , LINEAR FIXED FEATURES
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 65665 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.19 min, loss: -0.131, map_clean: 30.64, map_observed: 17.71
[val] time: 0.25 min, loss: -999.000, map_clean: 46.78, map_observed: 46.78
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 46.74, map_observed: 46.74
Epoch 1/24
[train] time: 1.19 min, loss: -0.132, map_clean: 50.21, map_observed: 30.69
[val] time: 0.25 min, loss: -999.000, map_clean: 53.31, map_observed: 53.31
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 53.00, map_observed: 53.00
Epoch 2/24
[train] time: 1.19 min, loss: -0.132, map_clean: 54.38, map_observed: 33.60
[val] time: 0.26 min, loss: -999.000, map_clean: 55.77, map_observed: 55.77
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 55.33, map_observed: 55.33
Epoch 3/24
[train] time: 1.18 min, loss: -0.132, map_clean: 56.28, map_observed: 34.81
[val] time: 0.26 min, loss: -999.000, map_clean: 57.16, map_observed: 57.16
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 56.68, map_observed: 56.68
Epoch 4/24
[train] time: 1.19 min, loss: -0.132, map_clean: 57.43, map_observed: 35.60
[val] time: 0.25 min, loss: -999.000, map_clean: 57.99, map_observed: 57.99
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 57.47, map_observed: 57.47
Epoch 5/24
[train] time: 1.20 min, loss: -0.132, map_clean: 58.20, map_observed: 36.23
[val] time: 0.25 min, loss: -999.000, map_clean: 58.71, map_observed: 58.71
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 58.19, map_observed: 58.19
Epoch 6/24
[train] time: 1.19 min, loss: -0.132, map_clean: 58.83, map_observed: 36.59
[val] time: 0.25 min, loss: -999.000, map_clean: 59.14, map_observed: 59.14
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 58.62, map_observed: 58.62
Epoch 7/24
[train] time: 1.19 min, loss: -0.132, map_clean: 59.28, map_observed: 36.96
[val] time: 0.25 min, loss: -999.000, map_clean: 59.56, map_observed: 59.56
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 59.04, map_observed: 59.04
Epoch 8/24
[train] time: 1.19 min, loss: -0.132, map_clean: 59.67, map_observed: 37.21
[val] time: 0.25 min, loss: -999.000, map_clean: 59.85, map_observed: 59.85
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 59.33, map_observed: 59.33
Epoch 9/24
[train] time: 1.21 min, loss: -0.132, map_clean: 59.96, map_observed: 37.52
[val] time: 0.25 min, loss: -999.000, map_clean: 60.11, map_observed: 60.11
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 59.60, map_observed: 59.60
Epoch 10/24
[train] time: 1.20 min, loss: -0.133, map_clean: 60.27, map_observed: 37.75
[val] time: 0.25 min, loss: -999.000, map_clean: 60.34, map_observed: 60.34
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 59.82, map_observed: 59.82
Epoch 11/24
[train] time: 1.20 min, loss: -0.133, map_clean: 60.48, map_observed: 38.00
[val] time: 0.25 min, loss: -999.000, map_clean: 60.52, map_observed: 60.52
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 60.01, map_observed: 60.01
Epoch 12/24
[train] time: 1.19 min, loss: -0.133, map_clean: 60.69, map_observed: 38.03
[val] time: 0.25 min, loss: -999.000, map_clean: 60.71, map_observed: 60.71
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 60.24, map_observed: 60.24
Epoch 13/24
[train] time: 1.19 min, loss: -0.133, map_clean: 60.89, map_observed: 38.29
[val] time: 0.25 min, loss: -999.000, map_clean: 60.86, map_observed: 60.86
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 60.36, map_observed: 60.36
Epoch 14/24
[train] time: 1.20 min, loss: -0.133, map_clean: 61.04, map_observed: 38.46
[val] time: 0.25 min, loss: -999.000, map_clean: 61.06, map_observed: 61.06
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 60.59, map_observed: 60.59
Epoch 15/24
[train] time: 1.20 min, loss: -0.133, map_clean: 61.24, map_observed: 38.62
[val] time: 0.25 min, loss: -999.000, map_clean: 61.15, map_observed: 61.15
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 60.63, map_observed: 60.63
Epoch 16/24
[train] time: 1.20 min, loss: -0.133, map_clean: 61.41, map_observed: 38.75
[val] time: 0.25 min, loss: -999.000, map_clean: 61.26, map_observed: 61.26
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 60.76, map_observed: 60.76
Epoch 17/24
[train] time: 1.20 min, loss: -0.133, map_clean: 61.56, map_observed: 38.84
[val] time: 0.26 min, loss: -999.000, map_clean: 61.35, map_observed: 61.35
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 60.87, map_observed: 60.87
Epoch 18/24
[train] time: 1.20 min, loss: -0.133, map_clean: 61.67, map_observed: 39.11
[val] time: 0.25 min, loss: -999.000, map_clean: 61.49, map_observed: 61.49
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 61.00, map_observed: 61.00
Epoch 19/24
[train] time: 1.21 min, loss: -0.133, map_clean: 61.74, map_observed: 39.04
[val] time: 0.25 min, loss: -999.000, map_clean: 61.51, map_observed: 61.51
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 61.02, map_observed: 61.02
Epoch 20/24
[train] time: 1.20 min, loss: -0.133, map_clean: 61.84, map_observed: 39.21
[val] time: 0.25 min, loss: -999.000, map_clean: 61.61, map_observed: 61.61
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 61.14, map_observed: 61.14
Epoch 21/24
[train] time: 1.21 min, loss: -0.133, map_clean: 62.00, map_observed: 39.38
[val] time: 0.25 min, loss: -999.000, map_clean: 61.73, map_observed: 61.73
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 61.28, map_observed: 61.28
Epoch 22/24
[train] time: 1.20 min, loss: -0.133, map_clean: 62.19, map_observed: 39.57
[val] time: 0.25 min, loss: -999.000, map_clean: 61.76, map_observed: 61.76
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 61.28, map_observed: 61.28
Epoch 23/24
[train] time: 1.21 min, loss: -0.133, map_clean: 62.15, map_observed: 39.53
[val] time: 0.25 min, loss: -999.000, map_clean: 61.89, map_observed: 61.89
*** new best weights ***
[test] time: 0.61 min, loss: -999.000, map_clean: 61.42, map_observed: 61.42
Epoch 24/24
[train] time: 1.20 min, loss: -0.133, map_clean: 62.27, map_observed: 39.66
[val] time: 0.25 min, loss: -999.000, map_clean: 61.94, map_observed: 61.94
*** new best weights ***
[test] time: 0.62 min, loss: -999.000, map_clean: 61.44, map_observed: 61.44

*** TRAINING COMPLETE ***
Best epoch: 24
Best epoch validation score: 61.94
Best epoch test score:       61.44

Saving best weights for f to ./results/multi_label_experiment_2022_04_19_19-26-30_coco/best_model_state_f.pt

Saving best weights for g to ./results/multi_label_experiment_2022_04_19_19-26-30_coco/best_model_state_g.pt

Saving session data to ./results/multi_label_experiment_2022_04_19_19-26-30_coco/logs.json

Saving session data to ./results/multi_label_experiment_2022_04_19_19-26-30_coco/params.json

Reverting model to best weights.
coco em, location 2 , LINEAR FIXED FEATURES
coco em, location 2 , LINEAR FIXED FEATURES
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 65665 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.01 min, loss: -0.034, map_clean: 10.44, map_observed: 6.41
[val] time: 0.23 min, loss: -999.000, map_clean: 18.82, map_observed: 18.82
*** new best weights ***
[test] time: 0.55 min, loss: -999.000, map_clean: 18.83, map_observed: 18.83
Epoch 1/24
[train] time: 1.00 min, loss: -0.035, map_clean: 12.11, map_observed: 8.01
[val] time: 0.23 min, loss: -999.000, map_clean: 20.01, map_observed: 20.01
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 19.93, map_observed: 19.93
Epoch 2/24
[train] time: 1.01 min, loss: -0.030, map_clean: 12.85, map_observed: 8.66
[val] time: 0.23 min, loss: -999.000, map_clean: 19.48, map_observed: 19.48
[test] time: 0.56 min, loss: -999.000, map_clean: 19.47, map_observed: 19.47
Epoch 3/24
[train] time: 1.01 min, loss: -0.021, map_clean: 13.17, map_observed: 9.08
[val] time: 0.23 min, loss: -999.000, map_clean: 18.64, map_observed: 18.64
[test] time: 0.56 min, loss: -999.000, map_clean: 18.61, map_observed: 18.61
Epoch 4/24
[train] time: 1.02 min, loss: -0.015, map_clean: 12.68, map_observed: 8.52
[val] time: 0.22 min, loss: -999.000, map_clean: 18.62, map_observed: 18.62
[test] time: 0.55 min, loss: -999.000, map_clean: 18.42, map_observed: 18.42
Epoch 5/24
[train] time: 1.02 min, loss: -0.013, map_clean: 12.53, map_observed: 8.24
[val] time: 0.23 min, loss: -999.000, map_clean: 18.10, map_observed: 18.10
[test] time: 0.56 min, loss: -999.000, map_clean: 17.93, map_observed: 17.93
Epoch 6/24
[train] time: 1.02 min, loss: -0.010, map_clean: 12.59, map_observed: 8.66
[val] time: 0.22 min, loss: -999.000, map_clean: 17.87, map_observed: 17.87
[test] time: 0.55 min, loss: -999.000, map_clean: 17.83, map_observed: 17.83
Epoch 7/24
[train] time: 1.02 min, loss: -0.005, map_clean: 10.71, map_observed: 6.83
[val] time: 0.23 min, loss: -999.000, map_clean: 16.33, map_observed: 16.33
[test] time: 0.54 min, loss: -999.000, map_clean: 16.24, map_observed: 16.24
Epoch 8/24
[train] time: 1.01 min, loss: -0.001, map_clean: 10.53, map_observed: 6.65
[val] time: 0.23 min, loss: -999.000, map_clean: 14.78, map_observed: 14.78
[test] time: 0.55 min, loss: -999.000, map_clean: 14.61, map_observed: 14.61
Epoch 9/24
[train] time: 1.01 min, loss: 0.000, map_clean: 10.24, map_observed: 6.41
[val] time: 0.23 min, loss: -999.000, map_clean: 14.10, map_observed: 14.10
[test] time: 0.55 min, loss: -999.000, map_clean: 14.07, map_observed: 14.07
Epoch 10/24
[train] time: 1.02 min, loss: 0.003, map_clean: 10.26, map_observed: 6.92
[val] time: 0.22 min, loss: -999.000, map_clean: 13.33, map_observed: 13.33
[test] time: 0.55 min, loss: -999.000, map_clean: 13.39, map_observed: 13.39
Epoch 11/24
[train] time: 1.03 min, loss: 0.010, map_clean: 9.45, map_observed: 5.81
[val] time: 0.22 min, loss: -999.000, map_clean: 11.33, map_observed: 11.33
[test] time: 0.56 min, loss: -999.000, map_clean: 11.24, map_observed: 11.24
Epoch 12/24
[train] time: 1.03 min, loss: 0.010, map_clean: 9.20, map_observed: 5.61
[val] time: 0.22 min, loss: -999.000, map_clean: 11.99, map_observed: 11.99
[test] time: 0.55 min, loss: -999.000, map_clean: 11.99, map_observed: 11.99
Epoch 13/24
[train] time: 1.04 min, loss: 0.012, map_clean: 9.53, map_observed: 5.76
[val] time: 0.23 min, loss: -999.000, map_clean: 12.29, map_observed: 12.29
[test] time: 0.54 min, loss: -999.000, map_clean: 12.35, map_observed: 12.35
Epoch 14/24
[train] time: 1.04 min, loss: 0.016, map_clean: 9.30, map_observed: 5.86
[val] time: 0.23 min, loss: -999.000, map_clean: 11.89, map_observed: 11.89
[test] time: 0.54 min, loss: -999.000, map_clean: 11.92, map_observed: 11.92
Epoch 15/24
[train] time: 1.08 min, loss: 0.017, map_clean: 9.12, map_observed: 5.60
[val] time: 0.23 min, loss: -999.000, map_clean: 10.78, map_observed: 10.78
[test] time: 0.55 min, loss: -999.000, map_clean: 10.69, map_observed: 10.69
Epoch 16/24
[train] time: 1.11 min, loss: 0.018, map_clean: 9.04, map_observed: 5.60
[val] time: 0.23 min, loss: -999.000, map_clean: 10.44, map_observed: 10.44
[test] time: 0.55 min, loss: -999.000, map_clean: 10.45, map_observed: 10.45
Epoch 17/24
[train] time: 1.12 min, loss: 0.019, map_clean: 8.38, map_observed: 5.30
[val] time: 0.22 min, loss: -999.000, map_clean: 10.83, map_observed: 10.83
[test] time: 0.55 min, loss: -999.000, map_clean: 10.83, map_observed: 10.83
Epoch 18/24
[train] time: 1.14 min, loss: 0.020, map_clean: 8.85, map_observed: 5.40
[val] time: 0.23 min, loss: -999.000, map_clean: 9.42, map_observed: 9.42
[test] time: 0.55 min, loss: -999.000, map_clean: 9.35, map_observed: 9.35
Epoch 19/24
[train] time: 1.15 min, loss: 0.020, map_clean: 8.49, map_observed: 4.95
[val] time: 0.23 min, loss: -999.000, map_clean: 10.39, map_observed: 10.39
[test] time: 0.55 min, loss: -999.000, map_clean: 10.44, map_observed: 10.44
Epoch 20/24
[train] time: 1.15 min, loss: 0.021, map_clean: 8.24, map_observed: 5.30
[val] time: 0.22 min, loss: -999.000, map_clean: 11.01, map_observed: 11.01
[test] time: 0.55 min, loss: -999.000, map_clean: 11.01, map_observed: 11.01
Epoch 21/24
[train] time: 1.16 min, loss: 0.021, map_clean: 8.79, map_observed: 5.33
[val] time: 0.23 min, loss: -999.000, map_clean: 10.56, map_observed: 10.56
[test] time: 0.55 min, loss: -999.000, map_clean: 10.49, map_observed: 10.49
Epoch 22/24
[train] time: 1.16 min, loss: 0.021, map_clean: 8.91, map_observed: 5.44
[val] time: 0.22 min, loss: -999.000, map_clean: 10.48, map_observed: 10.48
[test] time: 0.54 min, loss: -999.000, map_clean: 10.50, map_observed: 10.50
Epoch 23/24
[train] time: 1.17 min, loss: 0.023, map_clean: 8.39, map_observed: 5.08
[val] time: 0.23 min, loss: -999.000, map_clean: 10.02, map_observed: 10.02
[test] time: 0.55 min, loss: -999.000, map_clean: 9.95, map_observed: 9.95
Epoch 24/24
[train] time: 1.17 min, loss: 0.023, map_clean: 8.43, map_observed: 5.20
[val] time: 0.23 min, loss: -999.000, map_clean: 9.83, map_observed: 9.83
[test] time: 0.55 min, loss: -999.000, map_clean: 9.74, map_observed: 9.74

*** TRAINING COMPLETE ***
Best epoch: 1
Best epoch validation score: 20.01
Best epoch test score:       19.93

Saving best weights for f to ./results/multi_label_experiment_2022_04_19_20-18-44_coco/best_model_state_f.pt

Saving best weights for g to ./results/multi_label_experiment_2022_04_19_20-18-44_coco/best_model_state_g.pt

Saving session data to ./results/multi_label_experiment_2022_04_19_20-18-44_coco/logs.json

Saving session data to ./results/multi_label_experiment_2022_04_19_20-18-44_coco/params.json

Reverting model to best weights.
coco em, location 2 , LINEAR FIXED FEATURES
coco em, location 2 , LINEAR FIXED FEATURES
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 65665 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.02 min, loss: -0.131, map_clean: 48.02, map_observed: 31.02
[val] time: 0.24 min, loss: -999.000, map_clean: 58.74, map_observed: 58.74
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 58.08, map_observed: 58.08
Epoch 1/24
[train] time: 1.02 min, loss: -0.132, map_clean: 52.56, map_observed: 34.82
[val] time: 0.23 min, loss: -999.000, map_clean: 60.12, map_observed: 60.12
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 59.29, map_observed: 59.29
Epoch 2/24
[train] time: 1.02 min, loss: -0.132, map_clean: 53.69, map_observed: 36.06
[val] time: 0.23 min, loss: -999.000, map_clean: 61.01, map_observed: 61.01
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 60.36, map_observed: 60.36
Epoch 3/24
[train] time: 1.02 min, loss: -0.132, map_clean: 54.72, map_observed: 36.92
[val] time: 0.23 min, loss: -999.000, map_clean: 61.08, map_observed: 61.08
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 60.62, map_observed: 60.62
Epoch 4/24
[train] time: 1.02 min, loss: -0.132, map_clean: 55.12, map_observed: 37.48
[val] time: 0.23 min, loss: -999.000, map_clean: 61.31, map_observed: 61.31
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 60.60, map_observed: 60.60
Epoch 5/24
[train] time: 1.02 min, loss: -0.132, map_clean: 55.63, map_observed: 38.09
[val] time: 0.23 min, loss: -999.000, map_clean: 61.35, map_observed: 61.35
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 60.69, map_observed: 60.69
Epoch 6/24
[train] time: 1.04 min, loss: -0.132, map_clean: 55.86, map_observed: 38.44
[val] time: 0.23 min, loss: -999.000, map_clean: 61.31, map_observed: 61.31
[test] time: 0.56 min, loss: -999.000, map_clean: 60.59, map_observed: 60.59
Epoch 7/24
[train] time: 1.02 min, loss: -0.132, map_clean: 56.05, map_observed: 38.72
[val] time: 0.23 min, loss: -999.000, map_clean: 61.83, map_observed: 61.83
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 61.09, map_observed: 61.09
Epoch 8/24
[train] time: 1.03 min, loss: -0.132, map_clean: 56.23, map_observed: 38.86
[val] time: 0.23 min, loss: -999.000, map_clean: 61.35, map_observed: 61.35
[test] time: 0.56 min, loss: -999.000, map_clean: 60.53, map_observed: 60.53
Epoch 9/24
[train] time: 1.03 min, loss: -0.132, map_clean: 56.33, map_observed: 39.18
[val] time: 0.23 min, loss: -999.000, map_clean: 61.47, map_observed: 61.47
[test] time: 0.57 min, loss: -999.000, map_clean: 60.81, map_observed: 60.81
Epoch 10/24
[train] time: 1.02 min, loss: -0.132, map_clean: 56.58, map_observed: 39.30
[val] time: 0.23 min, loss: -999.000, map_clean: 61.81, map_observed: 61.81
[test] time: 0.57 min, loss: -999.000, map_clean: 60.94, map_observed: 60.94
Epoch 11/24
[train] time: 1.02 min, loss: -0.132, map_clean: 56.64, map_observed: 39.52
[val] time: 0.23 min, loss: -999.000, map_clean: 61.58, map_observed: 61.58
[test] time: 0.57 min, loss: -999.000, map_clean: 60.97, map_observed: 60.97
Epoch 12/24
[train] time: 1.03 min, loss: -0.132, map_clean: 56.72, map_observed: 39.55
[val] time: 0.23 min, loss: -999.000, map_clean: 61.84, map_observed: 61.84
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 61.01, map_observed: 61.01
Epoch 13/24
[train] time: 1.01 min, loss: -0.132, map_clean: 56.56, map_observed: 39.79
[val] time: 0.23 min, loss: -999.000, map_clean: 61.52, map_observed: 61.52
[test] time: 0.56 min, loss: -999.000, map_clean: 60.66, map_observed: 60.66
Epoch 14/24
[train] time: 1.02 min, loss: -0.132, map_clean: 56.85, map_observed: 39.96
[val] time: 0.23 min, loss: -999.000, map_clean: 61.49, map_observed: 61.49
[test] time: 0.56 min, loss: -999.000, map_clean: 60.76, map_observed: 60.76
Epoch 15/24
[train] time: 1.01 min, loss: -0.132, map_clean: 57.07, map_observed: 40.15
[val] time: 0.23 min, loss: -999.000, map_clean: 62.03, map_observed: 62.03
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 61.30, map_observed: 61.30
Epoch 16/24
[train] time: 1.01 min, loss: -0.132, map_clean: 56.94, map_observed: 40.08
[val] time: 0.24 min, loss: -999.000, map_clean: 61.56, map_observed: 61.56
[test] time: 0.57 min, loss: -999.000, map_clean: 60.94, map_observed: 60.94
Epoch 17/24
[train] time: 1.02 min, loss: -0.132, map_clean: 57.09, map_observed: 40.22
[val] time: 0.24 min, loss: -999.000, map_clean: 61.46, map_observed: 61.46
[test] time: 0.56 min, loss: -999.000, map_clean: 60.62, map_observed: 60.62
Epoch 18/24
[train] time: 1.02 min, loss: -0.132, map_clean: 57.00, map_observed: 40.28
[val] time: 0.23 min, loss: -999.000, map_clean: 61.58, map_observed: 61.58
[test] time: 0.58 min, loss: -999.000, map_clean: 60.85, map_observed: 60.85
Epoch 19/24
[train] time: 1.01 min, loss: -0.132, map_clean: 57.15, map_observed: 40.33
[val] time: 0.24 min, loss: -999.000, map_clean: 61.86, map_observed: 61.86
[test] time: 0.57 min, loss: -999.000, map_clean: 61.13, map_observed: 61.13
Epoch 20/24
[train] time: 1.02 min, loss: -0.132, map_clean: 57.26, map_observed: 40.34
[val] time: 0.23 min, loss: -999.000, map_clean: 61.69, map_observed: 61.69
[test] time: 0.57 min, loss: -999.000, map_clean: 61.04, map_observed: 61.04
Epoch 21/24
[train] time: 1.02 min, loss: -0.132, map_clean: 57.20, map_observed: 40.43
[val] time: 0.24 min, loss: -999.000, map_clean: 61.54, map_observed: 61.54
[test] time: 0.57 min, loss: -999.000, map_clean: 60.74, map_observed: 60.74
Epoch 22/24
[train] time: 1.02 min, loss: -0.132, map_clean: 57.05, map_observed: 40.52
[val] time: 0.23 min, loss: -999.000, map_clean: 61.95, map_observed: 61.95
[test] time: 0.57 min, loss: -999.000, map_clean: 61.19, map_observed: 61.19
Epoch 23/24
[train] time: 1.03 min, loss: -0.132, map_clean: 57.15, map_observed: 40.58
[val] time: 0.24 min, loss: -999.000, map_clean: 61.80, map_observed: 61.80
[test] time: 0.57 min, loss: -999.000, map_clean: 61.20, map_observed: 61.20
Epoch 24/24
[train] time: 1.02 min, loss: -0.132, map_clean: 57.19, map_observed: 40.62
[val] time: 0.23 min, loss: -999.000, map_clean: 61.45, map_observed: 61.45
[test] time: 0.56 min, loss: -999.000, map_clean: 60.75, map_observed: 60.75

*** TRAINING COMPLETE ***
Best epoch: 15
Best epoch validation score: 62.03
Best epoch test score:       61.30

Saving best weights for f to ./results/multi_label_experiment_2022_04_19_21-05-41_coco/best_model_state_f.pt

Saving best weights for g to ./results/multi_label_experiment_2022_04_19_21-05-41_coco/best_model_state_g.pt

Saving session data to ./results/multi_label_experiment_2022_04_19_21-05-41_coco/logs.json

Saving session data to ./results/multi_label_experiment_2022_04_19_21-05-41_coco/params.json

Reverting model to best weights.
coco em, location 2 , LINEAR FIXED FEATURES
coco em, location 2 , LINEAR FIXED FEATURES
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 65665 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.02 min, loss: -0.132, map_clean: 49.07, map_observed: 29.62
[val] time: 0.24 min, loss: -999.000, map_clean: 58.58, map_observed: 58.58
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 57.99, map_observed: 57.99
Epoch 1/24
[train] time: 1.01 min, loss: -0.132, map_clean: 57.75, map_observed: 36.07
[val] time: 0.24 min, loss: -999.000, map_clean: 60.31, map_observed: 60.31
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 59.72, map_observed: 59.72
Epoch 2/24
[train] time: 1.01 min, loss: -0.132, map_clean: 59.14, map_observed: 37.26
[val] time: 0.23 min, loss: -999.000, map_clean: 61.31, map_observed: 61.31
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 60.78, map_observed: 60.78
Epoch 3/24
[train] time: 1.03 min, loss: -0.133, map_clean: 59.98, map_observed: 37.92
[val] time: 0.23 min, loss: -999.000, map_clean: 61.72, map_observed: 61.72
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 61.20, map_observed: 61.20
Epoch 4/24
[train] time: 1.00 min, loss: -0.133, map_clean: 60.62, map_observed: 38.39
[val] time: 0.23 min, loss: -999.000, map_clean: 62.12, map_observed: 62.12
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 61.57, map_observed: 61.57
Epoch 5/24
[train] time: 1.03 min, loss: -0.133, map_clean: 61.01, map_observed: 38.79
[val] time: 0.23 min, loss: -999.000, map_clean: 62.31, map_observed: 62.31
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 61.75, map_observed: 61.75
Epoch 6/24
[train] time: 1.02 min, loss: -0.133, map_clean: 61.36, map_observed: 39.07
[val] time: 0.23 min, loss: -999.000, map_clean: 62.60, map_observed: 62.60
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 62.12, map_observed: 62.12
Epoch 7/24
[train] time: 1.01 min, loss: -0.133, map_clean: 61.71, map_observed: 39.53
[val] time: 0.23 min, loss: -999.000, map_clean: 62.64, map_observed: 62.64
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 62.12, map_observed: 62.12
Epoch 8/24
[train] time: 1.02 min, loss: -0.133, map_clean: 61.89, map_observed: 39.61
[val] time: 0.23 min, loss: -999.000, map_clean: 62.90, map_observed: 62.90
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 62.51, map_observed: 62.51
Epoch 9/24
[train] time: 1.03 min, loss: -0.133, map_clean: 62.17, map_observed: 39.90
[val] time: 0.23 min, loss: -999.000, map_clean: 63.02, map_observed: 63.02
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 62.45, map_observed: 62.45
Epoch 10/24
[train] time: 1.01 min, loss: -0.133, map_clean: 62.38, map_observed: 40.20
[val] time: 0.24 min, loss: -999.000, map_clean: 63.21, map_observed: 63.21
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 62.74, map_observed: 62.74
Epoch 11/24
[train] time: 1.02 min, loss: -0.133, map_clean: 62.50, map_observed: 40.33
[val] time: 0.23 min, loss: -999.000, map_clean: 63.53, map_observed: 63.53
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 63.04, map_observed: 63.04
Epoch 12/24
[train] time: 1.02 min, loss: -0.133, map_clean: 62.75, map_observed: 40.62
[val] time: 0.23 min, loss: -999.000, map_clean: 63.47, map_observed: 63.47
[test] time: 0.57 min, loss: -999.000, map_clean: 62.98, map_observed: 62.98
Epoch 13/24
[train] time: 1.01 min, loss: -0.133, map_clean: 62.80, map_observed: 40.92
[val] time: 0.24 min, loss: -999.000, map_clean: 63.59, map_observed: 63.59
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 63.04, map_observed: 63.04
Epoch 14/24
[train] time: 1.01 min, loss: -0.133, map_clean: 63.09, map_observed: 41.14
[val] time: 0.23 min, loss: -999.000, map_clean: 63.51, map_observed: 63.51
[test] time: 0.56 min, loss: -999.000, map_clean: 63.07, map_observed: 63.07
Epoch 15/24
[train] time: 1.03 min, loss: -0.133, map_clean: 63.18, map_observed: 41.11
[val] time: 0.23 min, loss: -999.000, map_clean: 63.56, map_observed: 63.56
[test] time: 0.57 min, loss: -999.000, map_clean: 62.96, map_observed: 62.96
Epoch 16/24
[train] time: 1.02 min, loss: -0.133, map_clean: 63.31, map_observed: 41.20
[val] time: 0.24 min, loss: -999.000, map_clean: 63.65, map_observed: 63.65
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 63.09, map_observed: 63.09
Epoch 17/24
[train] time: 1.02 min, loss: -0.133, map_clean: 63.42, map_observed: 41.60
[val] time: 0.23 min, loss: -999.000, map_clean: 63.70, map_observed: 63.70
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 63.17, map_observed: 63.17
Epoch 18/24
[train] time: 1.03 min, loss: -0.133, map_clean: 63.51, map_observed: 41.62
[val] time: 0.23 min, loss: -999.000, map_clean: 63.66, map_observed: 63.66
[test] time: 0.57 min, loss: -999.000, map_clean: 63.14, map_observed: 63.14
Epoch 19/24
[train] time: 1.01 min, loss: -0.133, map_clean: 63.59, map_observed: 41.86
[val] time: 0.24 min, loss: -999.000, map_clean: 63.82, map_observed: 63.82
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 63.37, map_observed: 63.37
Epoch 20/24
[train] time: 1.01 min, loss: -0.133, map_clean: 63.61, map_observed: 41.92
[val] time: 0.23 min, loss: -999.000, map_clean: 63.93, map_observed: 63.93
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 63.45, map_observed: 63.45
Epoch 21/24
[train] time: 1.03 min, loss: -0.133, map_clean: 63.68, map_observed: 42.06
[val] time: 0.23 min, loss: -999.000, map_clean: 63.96, map_observed: 63.96
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 63.40, map_observed: 63.40
Epoch 22/24
[train] time: 1.01 min, loss: -0.133, map_clean: 63.80, map_observed: 42.12
[val] time: 0.24 min, loss: -999.000, map_clean: 63.99, map_observed: 63.99
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 63.60, map_observed: 63.60
Epoch 23/24
[train] time: 1.02 min, loss: -0.133, map_clean: 63.94, map_observed: 42.41
[val] time: 0.24 min, loss: -999.000, map_clean: 64.02, map_observed: 64.02
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 63.50, map_observed: 63.50
Epoch 24/24
[train] time: 1.03 min, loss: -0.133, map_clean: 63.91, map_observed: 42.26
[val] time: 0.23 min, loss: -999.000, map_clean: 64.03, map_observed: 64.03
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 63.46, map_observed: 63.46

*** TRAINING COMPLETE ***
Best epoch: 24
Best epoch validation score: 64.03
Best epoch test score:       63.46

Saving best weights for f to ./results/multi_label_experiment_2022_04_19_21-52-06_coco/best_model_state_f.pt

Saving best weights for g to ./results/multi_label_experiment_2022_04_19_21-52-06_coco/best_model_state_g.pt

Saving session data to ./results/multi_label_experiment_2022_04_19_21-52-06_coco/logs.json

Saving session data to ./results/multi_label_experiment_2022_04_19_21-52-06_coco/params.json

Reverting model to best weights.
coco em, location 2 , LINEAR FIXED FEATURES
coco em, location 2 , LINEAR FIXED FEATURES
Using single positive labels for training.
Using clean labels for validation.
initializing image classifier
training a linear classifier only
initializing label estimator
observed positives: 65665 total, 1.0 per example on average
observed negatives: 0 total, 0.0 per example on average
Epoch 0/24
[train] time: 1.03 min, loss: -0.130, map_clean: 25.67, map_observed: 14.84
[val] time: 0.24 min, loss: -999.000, map_clean: 42.01, map_observed: 42.01
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 42.18, map_observed: 42.18
Epoch 1/24
[train] time: 1.02 min, loss: -0.132, map_clean: 46.79, map_observed: 28.69
[val] time: 0.23 min, loss: -999.000, map_clean: 50.78, map_observed: 50.78
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 50.56, map_observed: 50.56
Epoch 2/24
[train] time: 1.02 min, loss: -0.132, map_clean: 52.30, map_observed: 32.38
[val] time: 0.23 min, loss: -999.000, map_clean: 54.02, map_observed: 54.02
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 53.62, map_observed: 53.62
Epoch 3/24
[train] time: 1.03 min, loss: -0.132, map_clean: 54.68, map_observed: 33.94
[val] time: 0.23 min, loss: -999.000, map_clean: 55.79, map_observed: 55.79
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 55.30, map_observed: 55.30
Epoch 4/24
[train] time: 1.01 min, loss: -0.132, map_clean: 56.11, map_observed: 34.88
[val] time: 0.23 min, loss: -999.000, map_clean: 56.86, map_observed: 56.86
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 56.32, map_observed: 56.32
Epoch 5/24
[train] time: 1.03 min, loss: -0.132, map_clean: 57.07, map_observed: 35.53
[val] time: 0.23 min, loss: -999.000, map_clean: 57.57, map_observed: 57.57
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 57.00, map_observed: 57.00
Epoch 6/24
[train] time: 1.01 min, loss: -0.132, map_clean: 57.73, map_observed: 36.01
[val] time: 0.23 min, loss: -999.000, map_clean: 58.16, map_observed: 58.16
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 57.61, map_observed: 57.61
Epoch 7/24
[train] time: 1.02 min, loss: -0.132, map_clean: 58.27, map_observed: 36.38
[val] time: 0.23 min, loss: -999.000, map_clean: 58.69, map_observed: 58.69
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 58.10, map_observed: 58.10
Epoch 8/24
[train] time: 1.01 min, loss: -0.132, map_clean: 58.77, map_observed: 36.73
[val] time: 0.23 min, loss: -999.000, map_clean: 59.02, map_observed: 59.02
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 58.44, map_observed: 58.44
Epoch 9/24
[train] time: 1.02 min, loss: -0.132, map_clean: 59.12, map_observed: 37.00
[val] time: 0.24 min, loss: -999.000, map_clean: 59.31, map_observed: 59.31
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 58.73, map_observed: 58.73
Epoch 10/24
[train] time: 1.01 min, loss: -0.132, map_clean: 59.41, map_observed: 37.19
[val] time: 0.23 min, loss: -999.000, map_clean: 59.64, map_observed: 59.64
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 59.05, map_observed: 59.05
Epoch 11/24
[train] time: 1.02 min, loss: -0.132, map_clean: 59.70, map_observed: 37.43
[val] time: 0.24 min, loss: -999.000, map_clean: 59.87, map_observed: 59.87
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 59.27, map_observed: 59.27
Epoch 12/24
[train] time: 1.01 min, loss: -0.132, map_clean: 59.97, map_observed: 37.70
[val] time: 0.24 min, loss: -999.000, map_clean: 60.05, map_observed: 60.05
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 59.44, map_observed: 59.44
Epoch 13/24
[train] time: 1.03 min, loss: -0.132, map_clean: 60.14, map_observed: 37.76
[val] time: 0.23 min, loss: -999.000, map_clean: 60.23, map_observed: 60.23
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 59.63, map_observed: 59.63
Epoch 14/24
[train] time: 1.03 min, loss: -0.133, map_clean: 60.39, map_observed: 37.97
[val] time: 0.23 min, loss: -999.000, map_clean: 60.38, map_observed: 60.38
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 59.78, map_observed: 59.78
Epoch 15/24
[train] time: 1.02 min, loss: -0.133, map_clean: 60.52, map_observed: 38.16
[val] time: 0.23 min, loss: -999.000, map_clean: 60.52, map_observed: 60.52
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 59.95, map_observed: 59.95
Epoch 16/24
[train] time: 1.01 min, loss: -0.133, map_clean: 60.70, map_observed: 38.33
[val] time: 0.24 min, loss: -999.000, map_clean: 60.67, map_observed: 60.67
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 60.11, map_observed: 60.11
Epoch 17/24
[train] time: 1.02 min, loss: -0.133, map_clean: 60.86, map_observed: 38.50
[val] time: 0.24 min, loss: -999.000, map_clean: 60.80, map_observed: 60.80
*** new best weights ***
[test] time: 0.55 min, loss: -999.000, map_clean: 60.24, map_observed: 60.24
Epoch 18/24
[train] time: 1.02 min, loss: -0.133, map_clean: 61.03, map_observed: 38.55
[val] time: 0.23 min, loss: -999.000, map_clean: 60.93, map_observed: 60.93
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 60.35, map_observed: 60.35
Epoch 19/24
[train] time: 1.03 min, loss: -0.133, map_clean: 61.10, map_observed: 38.55
[val] time: 0.23 min, loss: -999.000, map_clean: 60.99, map_observed: 60.99
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 60.43, map_observed: 60.43
Epoch 20/24
[train] time: 1.02 min, loss: -0.133, map_clean: 61.25, map_observed: 38.77
[val] time: 0.23 min, loss: -999.000, map_clean: 61.10, map_observed: 61.10
*** new best weights ***
[test] time: 0.56 min, loss: -999.000, map_clean: 60.56, map_observed: 60.56
Epoch 21/24
[train] time: 1.02 min, loss: -0.133, map_clean: 61.40, map_observed: 38.96
[val] time: 0.23 min, loss: -999.000, map_clean: 61.21, map_observed: 61.21
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 60.65, map_observed: 60.65
Epoch 22/24
[train] time: 1.03 min, loss: -0.133, map_clean: 61.48, map_observed: 39.00
[val] time: 0.24 min, loss: -999.000, map_clean: 61.27, map_observed: 61.27
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 60.75, map_observed: 60.75
Epoch 23/24
[train] time: 1.02 min, loss: -0.133, map_clean: 61.56, map_observed: 39.05
[val] time: 0.23 min, loss: -999.000, map_clean: 61.34, map_observed: 61.34
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 60.82, map_observed: 60.82
Epoch 24/24
[train] time: 1.02 min, loss: -0.133, map_clean: 61.68, map_observed: 39.20
[val] time: 0.23 min, loss: -999.000, map_clean: 61.46, map_observed: 61.46
*** new best weights ***
[test] time: 0.57 min, loss: -999.000, map_clean: 60.94, map_observed: 60.94

*** TRAINING COMPLETE ***
Best epoch: 24
Best epoch validation score: 61.46
Best epoch test score:       60.94

Saving best weights for f to ./results/multi_label_experiment_2022_04_19_22-38-07_coco/best_model_state_f.pt

Saving best weights for g to ./results/multi_label_experiment_2022_04_19_22-38-07_coco/best_model_state_g.pt

Saving session data to ./results/multi_label_experiment_2022_04_19_22-38-07_coco/logs.json

Saving session data to ./results/multi_label_experiment_2022_04_19_22-38-07_coco/params.json

Reverting model to best weights.
best run: ./results/multi_label_experiment_2022_04_19_18-34-24_coco
- learning rate: 0.0001
- batch size:    8
- val score:     64.25183501855383
- test score:    63.55851762988382
